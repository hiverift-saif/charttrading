{"version":3,"file":"gantt.js","mappings":"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","sources":["webpack://@amcharts/amcharts5/./src/.internal/charts/gantt/GanttDateAxis.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/gantt/GanttDefaultTheme.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/gantt/GanttSeries.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/gantt/GanttCategoryAxis.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/gantt/GanttCategoryAxisRenderer.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/gantt/GanttDateAxisRenderer.ts","webpack://@amcharts/amcharts5/./src/.internal/charts/gantt/Gantt.ts","webpack://@amcharts/amcharts5/./tmp/webpack/gantt.js"],"sourcesContent":["import type { AxisRenderer } from \"../xy/axes/AxisRenderer\";\r\nimport type { GanttDateAxisRenderer } from \"./GanttDateAxisRenderer\";\r\nimport type { Gantt } from \"./Gantt\";\r\n\r\nimport { DateAxis, IDateAxisSettings, IDateAxisPrivate, IDateAxisDataItem, IDateAxisEvents } from \"../xy/axes/DateAxis\";\r\n\r\nexport interface IGanttDateAxisSettings<R extends AxisRenderer> extends IDateAxisSettings<R> {\r\n}\r\n\r\nexport interface IGanttDateAxisDataItem extends IDateAxisDataItem {\r\n\t/**\r\n\t * Flag is set to active if an axis range is added to this data item.\r\n\t */\r\n\tactive?: boolean;\r\n}\r\n\r\nexport interface IGanttDateAxisPrivate extends IDateAxisPrivate {\r\n}\r\n\r\nexport interface IGanttDateAxisEvents extends IDateAxisEvents {\r\n}\r\n\r\n\r\n/**\r\n * A date axis that is used as an X (horizontal) axis for [[Gantt]] charts.\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/gantt/#Timeline_horizontal_axis} for more info\r\n * @since 5.14.0\r\n * @important\r\n */\r\nexport class GanttDateAxis<R extends GanttDateAxisRenderer> extends DateAxis<R> {\r\n\tpublic static className: string = \"GanttDateAxis\";\r\n\tpublic static classNames: Array<string> = DateAxis.classNames.concat([GanttDateAxis.className]);\r\n\r\n\tdeclare public _settings: IGanttDateAxisSettings<R>;\r\n\tdeclare public _privateSettings: IGanttDateAxisPrivate;\r\n\tdeclare public _dataItemSettings: IGanttDateAxisDataItem;\r\n\tdeclare public _events: IGanttDateAxisEvents;\r\n\r\n\t/**\r\n\t * A reference to the parent [[Gantt]] chart.\r\n\t */\r\n\tpublic gantt?: Gantt;\r\n}\r\n","import type { GanttDateAxis, IGanttDateAxisDataItem } from \"./GanttDateAxis\";\r\nimport type { GanttDateAxisRenderer } from \"./GanttDateAxisRenderer\";\r\n\r\nimport { Theme } from \"../../core/Theme\";\r\nimport { p50, p100, percent } from \"../../core/util/Percent\";\r\nimport { LinePattern } from \"../../core/render/patterns/LinePattern\";\r\nimport { setColor } from \"../../themes/DefaultTheme\";\r\nimport { color, ColorSet, DataItem } from \"../../..\";\r\n\r\nimport * as $time from \"../../core/util/Time\";\r\n\r\n/**\r\n * @ignore\r\n */\r\nexport class GanttDefaultTheme extends Theme {\r\n\tprotected setupDefaultRules() {\r\n\t\tsuper.setupDefaultRules();\r\n\r\n\t\tconst l = this._root.language;\r\n\t\tconst ic = this._root.interfaceColors;\r\n\t\tconst r = this.rule.bind(this);\r\n\r\n\t\tconst defaultDateFormat = l.translate(\"_date_day_full\");\r\n\r\n\t\tr(\"Gantt\").setAll({\r\n\t\t\teditable: true,\r\n\t\t\tlayout: this._root.verticalLayout,\r\n\t\t\tcolors: ColorSet.new(this._root, {}),\r\n\t\t\tsnapThreshold: 0.5,\r\n\t\t\tlinkNewTasks: true,\r\n\t\t\tdurationUnit: \"day\",\r\n\t\t\tsidebarWidth: percent(30),\r\n\t\t\tweekends: [0, 6],\r\n\t\t\twidth: p100,\r\n\t\t\theight: p100,\r\n\t\t\tgridIntervals: {\r\n\t\t\t\tyear: [\r\n\t\t\t\t\t{ timeUnit: \"week\", count: 1 },\r\n\t\t\t\t\t{ timeUnit: \"month\", count: 1 },\r\n\t\t\t\t\t{ timeUnit: \"month\", count: 2 },\r\n\t\t\t\t\t{ timeUnit: \"month\", count: 6 }\r\n\t\t\t\t],\r\n\t\t\t\tmonth: [\r\n\t\t\t\t\t{ timeUnit: \"week\", count: 1 },\r\n\t\t\t\t\t{ timeUnit: \"week\", count: 2 }\r\n\t\t\t\t],\r\n\t\t\t\tweek: [\r\n\t\t\t\t\t{ timeUnit: \"day\", count: 1 }\r\n\t\t\t\t],\r\n\t\t\t\tday: [\r\n\t\t\t\t\t{ timeUnit: \"hour\", count: 1 },\r\n\t\t\t\t\t{ timeUnit: \"hour\", count: 3 },\r\n\t\t\t\t\t{ timeUnit: \"hour\", count: 6 },\r\n\t\t\t\t\t{ timeUnit: \"hour\", count: 12 }\r\n\t\t\t\t],\r\n\t\t\t\thour: [\r\n\t\t\t\t\t{ timeUnit: \"minute\", count: 1 },\r\n\t\t\t\t\t{ timeUnit: \"minute\", count: 5 },\r\n\t\t\t\t\t{ timeUnit: \"minute\", count: 15 },\r\n\t\t\t\t\t{ timeUnit: \"minute\", count: 30 }\r\n\t\t\t\t],\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t// Zoom Controls\r\n\t\tr(\"Container\", [\"zoomcontrols\"]).setAll({\r\n\t\t\tx: percent(100),\r\n\t\t\tcenterX: percent(100),\r\n\t\t\ty: 10,\r\n\t\t\tlayout: this._root.verticalLayout,\r\n\t\t});\r\n\r\n\t\tr(\"XYChart\", [\"gantt\"]).setAll({\r\n\t\t\tpanX: true,\r\n\t\t\tpanY: true,\r\n\t\t\tpaddingRight: 0,\r\n\t\t\twheelY: \"panY\"\r\n\t\t})\r\n\r\n\t\t// vertical line between axis and plot area, resizable\r\n\t\t{\r\n\t\t\tconst rule = r(\"Rectangle\", [\"axisresizer\"]);\r\n\t\t\trule.setAll({\r\n\t\t\t\twidth: 12,\r\n\t\t\t\theight: p100,\r\n\t\t\t\tfillOpacity: 0.05,\r\n\t\t\t\tfill: ic.get(\"alternativeBackground\"),\r\n\t\t\t\tcursorOverStyle: \"col-resize\",\r\n\t\t\t\tinteractive: true\r\n\t\t\t})\r\n\r\n\t\t\trule.states.create(\"hover\", { fillOpacity: 0.1 });\r\n\t\t}\r\n\r\n\t\t// Editable label\r\n\t\tr(\"EditableLabel\", [\"axis\"]).setAll({\r\n\t\t\tpaddingBottom: 3,\r\n\t\t\tpaddingTop: 3,\r\n\t\t\tpaddingLeft: 5,\r\n\t\t\tpaddingRight: 5,\r\n\t\t\tcursorOverStyle: \"text\"\r\n\t\t});\r\n\r\n\t\t// Axes\r\n\t\t// category axis\r\n\t\tr(\"GanttCategoryAxis\").setAll({\r\n\t\t\tmaxDeviation: 0,\r\n\t\t\tzoomOut: false,\r\n\t\t\tchildShift: 25,\r\n\t\t\tchildCellSize: 0.8,\r\n\t\t\tminCellHeight: 70\r\n\t\t});\r\n\r\n\t\tr(\"GanttCategoryAxisRenderer\").setAll({\r\n\t\t\tinversed: true,\r\n\t\t\tminGridDistance: 10\r\n\t\t})\r\n\r\n\t\t// date axis\r\n\t\t// upper\r\n\t\tr(\"GanttDateAxis\").setAll({\r\n\t\t\tmaxZoomFactor: 10000000,\r\n\t\t\textraMax: 0.03,\r\n\t\t\textraMin: 0.02,\r\n\t\t\tautoZoom: false,\r\n\t\t\t//strictMinMaxSelection: false,\r\n\t\t\t//strictMinMax: false,\r\n\t\t\tmarkUnitChange: false,\r\n\t\t\tweekLabelLocation: 0.5,\r\n\t\t\tcursorOverStyle: \"pointer\",\r\n\r\n\t\t\tgridIntervals: [\r\n\t\t\t\t{ timeUnit: \"hour\", count: 1 },\r\n\t\t\t\t{ timeUnit: \"day\", count: 1 },\r\n\t\t\t\t{ timeUnit: \"week\", count: 1 },\r\n\t\t\t\t{ timeUnit: \"month\", count: 1 },\r\n\t\t\t\t{ timeUnit: \"year\", count: 1 },\r\n\t\t\t\t{ timeUnit: \"year\", count: 2 },\r\n\t\t\t\t{ timeUnit: \"year\", count: 5 },\r\n\t\t\t\t{ timeUnit: \"year\", count: 10 }\r\n\t\t\t],\r\n\r\n\t\t\tdateFormats: {\r\n\t\t\t\thour: l.translate(\"_date_hour_full\"),\r\n\t\t\t\tday: l.translate(\"_date_day\"),\r\n\t\t\t\tweek: defaultDateFormat,\r\n\t\t\t\tmonth: l.translate(\"_date_month_full\"),\r\n\t\t\t\tyear: l.translate(\"_date_year\")\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t// minor\r\n\t\tr(\"GanttDateAxis\", [\"minor\"]).setAll({\r\n\t\t\tdateFormats: {\r\n\t\t\t\tmillisecond: \"SSS\",\r\n\t\t\t\tsecond: \"ss\",\r\n\t\t\t\tminute: \"mm\",\r\n\t\t\t\thour: l.translate(\"_date_hour_short\"),\r\n\t\t\t\tday: \"EEEEE\",\r\n\t\t\t\tweek: l.translate(\"_date_day\"),\r\n\t\t\t\tmonth: l.translate(\"_date_month\"),\r\n\t\t\t\tyear: l.translate(\"_date_year\")\r\n\t\t\t},\r\n\t\t\tfillRule: (dataItem: DataItem<IGanttDateAxisDataItem>) => {\r\n\t\t\t\tconst axisFill = dataItem.get(\"axisFill\");\r\n\r\n\t\t\t\tif (axisFill) {\r\n\t\t\t\t\tconst axis = <GanttDateAxis<GanttDateAxisRenderer>>dataItem.component;\r\n\t\t\t\t\tconst value = dataItem.get(\"value\", 0);\r\n\t\t\t\t\tconst endValue = dataItem.get(\"endValue\", 0);\r\n\t\t\t\t\tconst baseInterval = axis.getPrivate(\"baseInterval\");\r\n\t\t\t\t\tconst gridInterval = axis.getPrivate(\"gridInterval\", baseInterval);\r\n\t\t\t\t\tconst weekends = axis.gantt?.get(\"weekends\", [0, 6]);\r\n\t\t\t\t\taxisFill.set(\"visible\", false);\r\n\t\t\t\t\tif (gridInterval.timeUnit == \"day\") {\r\n\t\t\t\t\t\tlet weekDay = new Date(value).getDay();\r\n\t\t\t\t\t\tconst duration = endValue - value;\r\n\t\t\t\t\t\tconst dayDuration = $time.getDuration(\"day\", 1);\r\n\r\n\t\t\t\t\t\tif (weekends && weekends.indexOf(weekDay) != -1 && (duration >= dayDuration * 0.9 && duration <= dayDuration * 1.1)) {\r\n\t\t\t\t\t\t\taxisFill.set(\"visible\", true);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\taxisFill.set(\"visible\", false);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tr(\"GanttDateAxisRenderer\").setAll({\r\n\t\t\tminGridDistance: 150,\r\n\t\t\topposite: true\r\n\t\t});\r\n\r\n\t\tr(\"GanttDateAxisRenderer\", [\"minor\"]).setAll({\r\n\t\t\tminGridDistance: 50,\r\n\t\t\topposite: true\r\n\t\t});\r\n\r\n\t\t// Grid\r\n\t\tr(\"Grid\", [\"cursor\", \"x\"]).setAll({\r\n\t\t\tforceHidden: true\r\n\t\t});\r\n\r\n\t\tr(\"Grid\", [\"cursor\", \"y\"]).setAll({\r\n\t\t\tforceHidden: true\r\n\t\t});\r\n\r\n\t\tr(\"Grid\", [\"range\"]).setAll({\r\n\t\t\tstroke: ic.get(\"negative\"),\r\n\t\t\tstrokeOpacity: 1,\r\n\t\t\tstrokeWidth: 2,\r\n\t\t\tstrokeDasharray: [4, 2]\r\n\t\t});\r\n\r\n\t\t// Axis labels\r\n\t\t// X axis labels\r\n\t\tr(\"AxisLabel\", [\"x\"]).setAll({\r\n\t\t\tpaddingBottom: 15,\r\n\t\t\tmultiLocation: 0.5\r\n\t\t});\r\n\r\n\r\n\t\t// Y axis labels (Tasks, editable)\r\n\t\tr(\"EditableAxisLabel\").setAll({\r\n\t\t\ty: p50,\r\n\t\t\tpopulateText: true,\r\n\t\t\ttext: \"{name}\",\r\n\t\t\tcenterY: p50,\r\n\t\t\toversizedBehavior: \"truncate\",\r\n\t\t\tmarginRight: 10\r\n\t\t});\r\n\r\n\t\t// Ticks\r\n\t\t// X axis\r\n\t\tr(\"AxisTick\", [\"gantt\", \"renderer\", \"x\"]).setAll({\r\n\t\t\tstrokeOpacity: .1,\r\n\t\t\tvisible: true,\r\n\t\t\tlocation: 1,\r\n\t\t\tlength: 29\r\n\t\t})\r\n\t\t// hover state\r\n\t\tr(\"AxisTick\", [\"gantt\", \"axis\", \"y\"]).states.create(\"hover\", {\r\n\t\t\tstroke: ic.get(\"primaryButton\"),\r\n\t\t\tstrokeOpacity: 1,\r\n\t\t\tstrokeWidth: 3\r\n\t\t});\r\n\r\n\r\n\t\t// Y axis\r\n\t\tr(\"AxisTick\", [\"gantt\", \"renderer\", \"y\"]).setAll({\r\n\t\t\tstrokeOpacity: .1,\r\n\t\t\tvisible: true,\r\n\t\t\tlocation: 1\r\n\t\t})\r\n\r\n\t\t// Grid\r\n\t\t// X axis\r\n\t\tr(\"Grid\", [\"gantt\", \"renderer\", \"x\"]).setAll({\r\n\t\t\tforceHidden: true\r\n\t\t})\r\n\t\t// minor X axis\r\n\t\t{\r\n\t\t\tconst rule = r(\"Grid\", [\"gantt\", \"renderer\", \"x\", \"minor\"]);\r\n\t\t\trule.setAll({\r\n\t\t\t\tforceHidden: false,\r\n\t\t\t\tlocation: 1\r\n\t\t\t})\r\n\r\n\t\t\trule.states.create(\"hover\", {\r\n\t\t\t\tstroke: ic.get(\"primaryButton\"),\r\n\t\t\t\tstrokeOpacity: 1,\r\n\t\t\t\tstrokeWidth: 2\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\t// Y axis\r\n\t\tr(\"Grid\", [\"gantt\", \"renderer\", \"y\"]).setAll({\r\n\t\t\tlocation: 1\r\n\t\t})\r\n\r\n\r\n\t\t// Y axis labels\r\n\t\t// container which holds all elements\r\n\t\tr(\"Container\", [\"axislabelcontainer\"]).setAll({\r\n\t\t\tminWidth: 150,\r\n\t\t\tdraggable: true\r\n\t\t});\r\n\r\n\t\t// main background of the label container\r\n\t\tr(\"Rectangle\", [\"axislabelcontainer\", \"background\"]).setAll({\r\n\t\t\tfill: ic.get(\"alternativeBackground\"),\r\n\t\t\tfillOpacity: 0,\r\n\t\t\tinteractive: true\r\n\t\t});\r\n\r\n\t\t// hover state\r\n\t\tr(\"Rectangle\", [\"axislabelcontainer\", \"background\"]).states.create(\"hover\", {\r\n\t\t\tfillOpacity: 0.05\r\n\t\t});\r\n\r\n\t\t// active state\r\n\t\tr(\"Rectangle\", [\"axislabelcontainer\", \"background\"]).states.create(\"active\", {\r\n\t\t\tfillOpacity: 0.07\r\n\t\t});\r\n\r\n\t\t// label itself\r\n\t\tr(\"EditableLabel\", [\"categorylabel\"]).setAll({\r\n\t\t\tminWidth: 100,\r\n\t\t\tmultiLine: false\r\n\t\t});\r\n\r\n\t\t// container which holds numeric stepper, progress pie\r\n\t\tr(\"Container\", [\"axislabelcontrols\"]).setAll({\r\n\t\t\theight: p100,\r\n\t\t\tlayout: this._root.horizontalLayout\r\n\t\t})\r\n\r\n\t\t// grip for dragging (left to the label)\r\n\t\tr(\"Rectangle\", [\"gantt\", \"grip\", \"axislabel\"]).setAll({\r\n\t\t\twidth: 18,\r\n\t\t\theight: 25,\r\n\t\t\tcursorOverStyle: \"ns-resize\",\r\n\t\t\tinteractive: true,\r\n\t\t\tcenterY: p50,\r\n\t\t\ty: p50,\r\n\r\n\t\t\tfillPattern: LinePattern.new(this._root, {\r\n\t\t\t\tcolor: ic.get(\"alternativeBackground\"),\r\n\t\t\t\tcolorOpacity: 0.2,\r\n\t\t\t\trotation: 0,\r\n\t\t\t\tgap: 3\r\n\t\t\t})\r\n\t\t});\r\n\r\n\t\t// Progress pie \r\n\t\tr(\"ProgressPie\").setAll({\r\n\t\t\ty: p50,\r\n\t\t\tcenterY: 0,\r\n\t\t\twidth: 32,\r\n\t\t\theight: 32,\r\n\t\t\tmarginLeft: 15,\r\n\t\t\tcursorOverStyle: \"pointer\"\r\n\t\t})\r\n\r\n\t\t// Numeric stepper for changing duration\r\n\t\tr(\"NumericStepper\").setAll({\r\n\t\t\ty: p50,\r\n\t\t\tcenterY: p50\r\n\t\t})\r\n\r\n\t\t// Series\r\n\t\tr(\"GanttSeries\").setAll({\r\n\t\t\tlinkHorizontalOffset: 25,\r\n\t\t\tsnapCount: 1,\r\n\t\t\texactLocationX: true\r\n\t\t})\r\n\r\n\t\t// Columns (tasks)\r\n\t\tr(\"RoundedRectangle\", [\"series\", \"column\", \"gantt\"]).setAll({\r\n\t\t\tmaxHeight: 60,\r\n\t\t\tdraggable: true,\r\n\t\t\tcornerRadiusBL: 5,\r\n\t\t\tcornerRadiusTL: 5,\r\n\t\t\tcornerRadiusBR: 5,\r\n\t\t\tcornerRadiusTR: 5,\r\n\t\t\tfillOpacity: .8,\r\n\t\t\tstrokeWidth: 2,\r\n\t\t\ttooltipY: 0,\r\n\t\t\ttooltipText: \"{name}: {openValueX.formatDate('\" + defaultDateFormat + \"')} - {valueX.formatDate('\" + defaultDateFormat + \"')}\"\r\n\t\t});\r\n\r\n\t\t// hover state of the column\r\n\t\tr(\"RoundedRectangle\", [\"column\", \"series\", \"gantt\"]).states.create(\"hover\", {\r\n\t\t\tstrokeWidth: 3,\r\n\t\t\tcornerRadiusBL: 0,\r\n\t\t\tcornerRadiusTL: 0,\r\n\t\t\tcornerRadiusBR: 0,\r\n\t\t\tcornerRadiusTR: 0,\r\n\t\t\tfillOpacity: 1\r\n\t\t});\r\n\r\n\t\t// disabled state of the column (used to show inactive tasks while drawing new link)\r\n\t\tr(\"RoundedRectangle\", [\"column\", \"series\", \"gantt\"]).states.create(\"disabled\", {\r\n\t\t\topacity: 0.2,\r\n\t\t\tforceInactive: true\r\n\t\t});\r\n\r\n\t\t// hidden state of the column\r\n\t\tr(\"RoundedRectangle\", [\"series\", \"column\", \"gantt\"]).states.create(\"hidden\", {\r\n\t\t\topacity: 0,\r\n\t\t\tvisible: false,\r\n\t\t\tstrokeOpacity: 0\r\n\t\t})\r\n\r\n\t\t// container which holds column and all related elements (grips, bullets)\r\n\t\tr(\"Container\", [\"columncontainer\"]).states.create(\"disabled\", {\r\n\t\t\topacity: 0.2,\r\n\t\t\tforceInactive: true\r\n\t\t});\r\n\r\n\t\t// container which holds grips and progress fill\r\n\t\tr(\"Container\", [\"maskedcontainer\"]).setAll({\r\n\t\t\tposition: \"absolute\"\r\n\t\t})\r\n\r\n\t\t// zero duration rectangle\r\n\t\tr(\"RoundedRectangle\", [\"zerorectangle\"]).setAll({\r\n\t\t\tdraggable: true,\r\n\t\t\tcornerRadiusBL: 2,\r\n\t\t\tcornerRadiusTL: 2,\r\n\t\t\tcornerRadiusBR: 2,\r\n\t\t\tcornerRadiusTR: 2,\r\n\t\t\tstrokeWidth: 2,\r\n\t\t\trotation: 45,\r\n\t\t\tfillOpacity: .8,\r\n\t\t\tcenterX: p50,\r\n\t\t\tcenterY: p50,\r\n\t\t\ty: p50,\r\n\t\t\ttooltipText: \"{name}: {openValueX.formatDate('\" + defaultDateFormat + \"')}\"\r\n\t\t})\r\n\r\n\t\t// hover state of zero duration rectangle\r\n\t\tr(\"RoundedRectangle\", [\"zerorectangle\"]).states.create(\"disabled\", {\r\n\t\t\topacity: 0.5,\r\n\t\t\tforceInactive: true\r\n\t\t});\r\n\r\n\t\t// round bullet at the start of the column\r\n\t\tr(\"Circle\", [\"connectorbullet\", \"start\", \"gantt\"]).setAll({\r\n\t\t\tstrokeWidth: 2,\r\n\t\t\tstrokeOpacity: 1,\r\n\t\t\tradius: 8,\r\n\t\t\ty: p50,\r\n\t\t\tfill: ic.get(\"background\"),\r\n\t\t\tstroke: ic.get(\"alternativeBackground\"),\r\n\t\t\tfillOpacity: 1,\r\n\t\t\tcursorOverStyle: \"pointer\",\r\n\t\t\trole: \"figure\",\r\n\t\t\tinteractive: true,\r\n\t\t\tvisible: false\r\n\t\t});\r\n\r\n\t\t// round bullet at the end of the column\r\n\t\tr(\"Circle\", [\"connectorbullet\", \"end\", \"gantt\"]).setAll({\r\n\t\t\tstrokeWidth: 2,\r\n\t\t\tstrokeOpacity: 1,\r\n\t\t\tradius: 8,\r\n\t\t\ty: p50,\r\n\t\t\tfill: ic.get(\"background\"),\r\n\t\t\tstroke: ic.get(\"alternativeBackground\"),\r\n\t\t\tfillOpacity: 1,\r\n\t\t\tcursorOverStyle: \"pointer\",\r\n\t\t\trole: \"figure\",\r\n\t\t\tinteractive: true\r\n\t\t});\r\n\r\n\t\t// hover state for end bullet\r\n\t\tr(\"Circle\", [\"connectorbullet\", \"gantt\", \"end\"]).states.create(\"hover\", {\r\n\t\t\tscale: 1.2\r\n\t\t});\r\n\r\n\t\t// active hover state for end bullet\r\n\t\tr(\"Circle\", [\"connectorbullet\", \"gantt\", \"end\"]).states.create(\"activehover\", {\r\n\t\t\tscale: 1.2,\r\n\t\t\tstrokeWidth: 4\r\n\t\t});\r\n\r\n\t\t// progress rectangle (filled with pattern)\r\n\t\tr(\"Rectangle\", [\"progressrectangle\", \"gantt\"]).setAll({\r\n\t\t\tforceInactive: true,\r\n\t\t\twidth: 1,\r\n\t\t\tfill: ic.get(\"background\"),\r\n\t\t\tfillOpacity: 0.2,\r\n\t\t\tstrokeOpacity: 0,\r\n\r\n\t\t\tfillPattern: LinePattern.new(this._root, {\r\n\t\t\t\twidth: 3000,\r\n\t\t\t\theight: 100,\r\n\t\t\t\tangle: -45,\r\n\t\t\t\tgap: 4,\r\n\t\t\t\tcolor: ic.get(\"background\")\r\n\t\t\t})\r\n\t\t});\r\n\r\n\t\t// grip for adjusting progress\r\n\t\tr(\"Triangle\", [\"progressgrip\", \"gantt\"]).setAll({\r\n\t\t\tdraggable: true,\r\n\t\t\tcursorOverStyle: \"ew-resize\",\r\n\t\t\twidth: 22,\r\n\t\t\theight: 11,\r\n\t\t\tfill: ic.get(\"background\"),\r\n\t\t\tstroke: ic.get(\"background\"),\r\n\t\t\tstrokeOpacity: 0,\r\n\t\t\tfillOpacity: 1,\r\n\t\t\ty: p100,\r\n\t\t\tcenterY: p100\r\n\t\t});\r\n\r\n\t\t// grip for resizing column - start (the dashed vertical one)\r\n\t\tr(\"Rectangle\", [\"resizegrip\", \"start\", \"gantt\"]).setAll({\r\n\t\t\twidth: 9,\r\n\t\t\tcenterX: 19,\r\n\t\t\tfill: ic.get(\"background\"),\r\n\t\t\tstroke: ic.get(\"alternativeBackground\"),\r\n\r\n\t\t\tfillPattern: LinePattern.new(this._root, {\r\n\t\t\t\tcolor: ic.get(\"alternativeBackground\"),\r\n\t\t\t\tcolorOpacity: 0.2,\r\n\t\t\t\trotation: 90,\r\n\t\t\t\tgap: 2\r\n\t\t\t}),\r\n\t\t\tdraggable: true,\r\n\t\t\tfillOpacity: 0,\r\n\t\t\tstrokeOpacity: 0,\r\n\t\t\tcursorOverStyle: \"ew-resize\"\r\n\t\t});\r\n\r\n\t\t// grip for resizing column - end (the dashed vertical one)\r\n\t\tr(\"Rectangle\", [\"resizegrip\", \"end\", \"gantt\"]).setAll({\r\n\t\t\twidth: 9,\r\n\t\t\tcenterX: -10,\r\n\t\t\tfill: ic.get(\"background\"),\r\n\t\t\tstroke: ic.get(\"alternativeBackground\"),\r\n\r\n\t\t\tfillPattern: LinePattern.new(this._root, {\r\n\t\t\t\tcolor: ic.get(\"alternativeBackground\"),\r\n\t\t\t\tcolorOpacity: 0.2,\r\n\t\t\t\trotation: 90,\r\n\t\t\t\tgap: 2\r\n\t\t\t}),\r\n\r\n\t\t\tdraggable: true,\r\n\t\t\tfillOpacity: 0,\r\n\t\t\tstrokeOpacity: 0,\r\n\t\t\tcursorOverStyle: \"ew-resize\"\r\n\t\t});\r\n\r\n\r\n\t\t// Line shown while drawing a new link\r\n\t\tr(\"Line\", [\"connectorline\", \"gantt\"]).setAll({\r\n\t\t\tstrokeWidth: 1,\r\n\t\t\tstrokeDasharray: [2, 2],\r\n\t\t\tstrokeOpacity: 1,\r\n\t\t\tstroke: ic.get(\"alternativeBackground\"),\r\n\t\t});\r\n\r\n\t\t// Arrow shown at the end of the link being drawn\r\n\t\tr(\"Triangle\", [\"connectorarrow\", \"gantt\"]).setAll({\r\n\t\t\twidth: 10,\r\n\t\t\theight: 10,\r\n\t\t\tfill: ic.get(\"alternativeBackground\"),\r\n\t\t\tstroke: ic.get(\"alternativeBackground\"),\r\n\t\t\trotation: 90,\r\n\t\t\tcenterX: p50,\r\n\t\t\tcenterY: p50,\r\n\t\t\tfillOpacity: 1,\r\n\t\t\tstrokeOpacity: 1\r\n\t\t});\r\n\r\n\t\t// hide the arrow at the start of the link\r\n\t\tr(\"Triangle\", [\"link\", \"start\"]).setAll({\r\n\t\t\tforceHidden: true\r\n\t\t});\r\n\r\n\r\n\t\t// Links\t\t\r\n\t\tr(\"Link\", [\"gantt\"]).setAll({\r\n\t\t\ttoggleKey: \"active\",\r\n\t\t\tcursorOverStyle: \"pointer\"\r\n\t\t})\r\n\r\n\t\t// this is needed for the states to be propagated to the link children\r\n\t\tr(\"Link\", [\"gantt\"]).states.create(\"active\", {});\r\n\r\n\r\n\r\n\t\t// Buttons\r\n\t\t{\r\n\t\t\tconst rule = r(\"Button\", [\"secondary\"]);\r\n\r\n\t\t\trule.setAll({\r\n\t\t\t\theight: 35,\r\n\t\t\t\tmarginLeft: 6,\r\n\t\t\t\ttooltipX: percent(90)\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\t{\r\n\t\t\tconst rule = r(\"Graphics\", [\"icon\", \"button\", \"fixedwidth\"]);\r\n\r\n\t\t\trule.setAll({\r\n\t\t\t\tx: p50,\r\n\t\t\t\tcenterX: p50\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\t{\r\n\t\t\tconst rule = r(\"Button\", [\"fixedwidth\"]);\r\n\r\n\t\t\trule.setAll({\r\n\t\t\t\twidth: 35\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\t{\r\n\t\t\tconst rule = r(\"Button\", [\"zoombutton\", \"secondary\"]);\r\n\r\n\t\t\trule.setAll({\r\n\t\t\t\theight: 35,\r\n\t\t\t\twidth: 35,\r\n\t\t\t\ty: undefined,\r\n\t\t\t\tmarginLeft: 0,\r\n\t\t\t\tmarginBottom: 6,\r\n\t\t\t\ttooltipX: percent(10)\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\t{\r\n\t\t\tconst rule = r(\"Graphics\", [\"icon\", \"button\", \"secondary\"]);\r\n\t\t\trule.setAll({\r\n\t\t\t\tcenterY: p50,\r\n\t\t\t\ty: p50\r\n\t\t\t});\r\n\t\t\tsetColor(rule, \"stroke\", ic, \"secondaryButtonText\");\r\n\t\t}\r\n\r\n\t\t{\r\n\t\t\tconst rule = r(\"Graphics\", [\"icon\", \"button\", \"secondary\"]);\r\n\t\t\trule.states.create(\"hover\", {\r\n\t\t\t\tstroke: ic.get(\"alternativeBackground\")\r\n\t\t\t});\r\n\r\n\t\t\trule.states.create(\"active\", {\r\n\t\t\t\tstroke: ic.get(\"alternativeBackground\")\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\t{\r\n\t\t\tconst rule = r(\"RoundedRectangle\", [\"background\", \"secondary\", \"button\"]);\r\n\t\t\tsetColor(rule, \"fill\", ic, \"background\");\r\n\t\t\tsetColor(rule, \"stroke\", ic, \"secondaryButton\");\r\n\t\t}\r\n\r\n\t\t{\r\n\t\t\tr(\"RoundedRectangle\", [\"background\", \"secondary\", \"button\"]).states.create(\"hover\", {\r\n\t\t\t\tstrokeOpacity: 1,\r\n\t\t\t\tfillOpacity: 0.2,\r\n\t\t\t\tfill: ic.get(\"secondaryButtonHover\")\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\t{\r\n\t\t\tr(\"RoundedRectangle\", [\"background\", \"secondary\", \"button\"]).states.create(\"active\", {\r\n\t\t\t\tstrokeOpacity: 1,\r\n\t\t\t\tfillOpacity: 0.2,\r\n\t\t\t\tfill: ic.get(\"secondaryButtonActive\")\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\t{\r\n\t\t\tconst rule = r(\"RoundedRectangle\", [\"background\", \"secondary\", \"button\"]).states.create(\"down\", { stateAnimationDuration: 0 });\r\n\t\t\tsetColor(rule, \"fill\", ic, \"secondaryButtonDown\");\r\n\t\t}\r\n\r\n\t\t{\r\n\t\t\tconst rule = r(\"Graphics\", [\"icon\", \"secondary\", \"button\"]);\r\n\t\t\tsetColor(rule, \"stroke\", ic, \"secondaryButton\");\r\n\t\t}\r\n\r\n\r\n\t\t// Task bullet button - shown at the left side of the task label, either triangle (if has children) or circle (if no children)\r\n\t\tr(\"Button\", [\"taskbullet\"]).setAll({\r\n\t\t\tcenterX: p50,\r\n\t\t\tcenterY: p50,\r\n\t\t\ty: p50,\r\n\t\t\twidth: 30,\r\n\t\t\theight: 30,\r\n\t\t\tcursorOverStyle: \"pointer\"\r\n\t\t})\r\n\r\n\t\tr(\"Graphics\", [\"taskbullet\", \"icon\"]).states.create(\"default\", {\r\n\t\t\tstateAnimationDuration: 0\r\n\t\t});\r\n\r\n\t\t// hover state for task bullet icon\r\n\t\tr(\"Graphics\", [\"taskbullet\", \"icon\"]).states.create(\"hover\", {\r\n\t\t\tfill: ic.get(\"secondaryButtonHover\")\r\n\t\t});\r\n\r\n\t\tr(\"Graphics\", [\"taskbullet\", \"icon\"]).states.create(\"active\", {\r\n\t\t\tfill: ic.get(\"secondaryButton\"),\r\n\t\t\tstateAnimationDuration: 0,\r\n\t\t\trotation: 90\r\n\t\t});\r\n\r\n\t\tr(\"Graphics\", [\"taskbullet\", \"icon\"]).states.create(\"disabled\", {\r\n\t\t\t// draw circle\r\n\t\t\tmarginLeft: 3,\r\n\t\t\tstateAnimationDuration: 0,\r\n\t\t\tfill: ic.get(\"secondaryButton\"),\r\n\t\t\tdraw: (display) => {\r\n\t\t\t\tdisplay.moveTo(0, 0);\r\n\t\t\t\tdisplay.arc(0, 0, 4, 0, 360, false);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tr(\"RoundedRectangle\", [\"button\", \"taskbullet\", \"background\"]).setAll({\r\n\t\t\topacity: 0\r\n\t\t});\r\n\r\n\t\tr(\"RoundedRectangle\", [\"button\", \"taskbullet\", \"background\"]).states.create(\"default\", {\r\n\t\t\topacity: 0\r\n\t\t});\r\n\r\n\t\tr(\"Button\", [\"taskbullet\"]).states.create(\"disabled\", {\r\n\t\t\tstateAnimationDuration: 0\r\n\t\t})\r\n\r\n\t\tr(\"Graphics\", [\"taskbullet\", \"icon\"]).setAll({\r\n\t\t\tfill: ic.get(\"secondaryButton\"),\r\n\t\t\tstateAnimationDuration: 0,\r\n\t\t\tstrokeOpacity: 0,\r\n\t\t\ty: p50,\r\n\r\n\t\t\t// draw triangle that points left\r\n\t\t\tdraw: (display) => {\r\n\t\t\t\tdisplay.moveTo(-5, -8);\r\n\t\t\t\tdisplay.lineTo(4, 0);\r\n\t\t\t\tdisplay.lineTo(-5, 8);\r\n\t\t\t\tdisplay.lineTo(-5, -8);\r\n\t\t\t\tdisplay.closePath();\r\n\t\t\t}\r\n\t\t})\r\n\t\t// end of task bullet\r\n\r\n\t\t// add button\r\n\t\tr(\"Button\", [\"add\"]).setAll({\r\n\t\t\twidth: 35,\r\n\t\t\theight: 35,\r\n\t\t\ttooltipText: l.translateAny(\"Add task\"),\r\n\t\t\ttooltipX: percent(90)\r\n\t\t})\r\n\r\n\t\tr(\"RoundedRectangle\", [\"button\", \"add\", \"background\"]).setAll({\r\n\t\t\tstroke: ic.get(\"primaryButton\"),\r\n\t\t\tstrokeWidth: 0,\r\n\t\t});\r\n\r\n\r\n\t\t// edit button\r\n\t\tr(\"Button\", [\"edit\"]).setAll({\r\n\t\t\tvisible: false,\r\n\t\t\ttooltipText: l.translateAny(\"Edit mode\"),\r\n\t\t\ttoggleKey: \"active\"\r\n\t\t})\r\n\r\n\t\t{\r\n\t\t\tconst rule = r(\"Graphics\", [\"icon\", \"edit\", \"button\"]);\r\n\t\t\trule.setAll({\r\n\t\t\t\tsvgPath: \"M 11 -1 L 17 5 L 8 14 L 2 14 L 2 8 L 11 -1 M 7 11 L 15 3 M 5 9 L 13 1 M 2 8 L 5 9 L 5 11 L 7 11 L 8 14 M 2 12 L 4 14\"\r\n\t\t\t});\r\n\t\t\tsetColor(rule, \"stroke\", ic, \"secondaryButton\");\r\n\t\t}\r\n\r\n\t\t// expand button\r\n\t\tr(\"Button\", [\"expand\"]).setAll({\r\n\t\t\ttooltipText: l.translateAny(\"Expand all\")\r\n\t\t})\r\n\r\n\t\t{\r\n\t\t\tconst rule = r(\"Graphics\", [\"icon\", \"expand\", \"button\"]);\r\n\t\t\trule.setAll({\r\n\t\t\t\tsvgPath: \"M -6 -4 L 0 2 L 6 -4 M -6 2 L 0 8 L 6 2\"\r\n\t\t\t});\r\n\t\t\tsetColor(rule, \"stroke\", ic, \"secondaryButton\");\r\n\t\t}\r\n\r\n\t\t// collapse button\r\n\t\tr(\"Button\", [\"collapse\"]).setAll({\r\n\t\t\ttooltipText: l.translateAny(\"Collapse all\")\r\n\t\t})\r\n\r\n\t\t{\r\n\t\t\tconst rule = r(\"Graphics\", [\"icon\", \"collapse\", \"button\"]);\r\n\t\t\trule.setAll({\r\n\t\t\t\tsvgPath: \"M -6 6 L 0 0 L 6 6 M -6 0 L 0 -6 L 6 0\"\r\n\t\t\t});\r\n\t\t\tsetColor(rule, \"stroke\", ic, \"secondaryButton\");\r\n\t\t}\r\n\r\n\t\t// auto-link button\r\n\t\tr(\"Button\", [\"link\"]).setAll({\r\n\t\t\ttooltipText: l.translateAny(\"Link new tasks\"),\r\n\t\t\ttoggleKey: \"active\"\r\n\t\t})\r\n\r\n\t\t{\r\n\t\t\tconst rule = r(\"Graphics\", [\"icon\", \"link\", \"button\"]);\r\n\t\t\trule.setAll({\r\n\t\t\t\tdy: 1,\r\n\t\t\t\tsvgPath: \"M 5 4 L 13 4 C 17 4 17 11 13 11 L 8 11 C 4 11 4 18 8 18 L 16 18 L 14 16 L 14 20 L 16 18\"\r\n\t\t\t});\r\n\t\t\tsetColor(rule, \"stroke\", ic, \"secondaryButton\");\r\n\t\t}\r\n\r\n\t\t// clear button\r\n\t\tr(\"Button\", [\"clear\"]).setAll({\r\n\t\t\ttooltipText: l.translateAny(\"Clear all\")\r\n\t\t});\r\n\r\n\t\t// garbage bin icon\r\n\t\t{\r\n\t\t\tconst rule = r(\"Graphics\", [\"icon\", \"clear\", \"button\"]);\r\n\t\t\trule.setAll({\r\n\t\t\t\tmarginLeft: 1,\r\n\t\t\t\tmarginRight: 1,\r\n\t\t\t\tsvgPath: \"M 2.4 4 L 4.8 19.2 L 15.2 19.2 L 17.6 4 L 2.4 4 M 5.6 5.6 L 7.2 17.2 M 10 5.6 L 10 17.2 M 14.4 5.6 L 12.8 17.2 M 2.4 3.2 L 17.6 3.2 M 8.4 3.2 L 8.4 1.2 L 12 1.2 L 12 3.2\"\r\n\t\t\t});\r\n\t\t\tsetColor(rule, \"stroke\", ic, \"secondaryButton\");\r\n\t\t}\r\n\r\n\t\t// fit button\r\n\t\tr(\"Button\", [\"fit\"]).setAll({\r\n\t\t\ttooltipText: l.translateAny(\"Fit to view\")\r\n\t\t})\r\n\r\n\t\t{\r\n\t\t\tconst rule = r(\"Graphics\", [\"icon\", \"fit\", \"button\"]);\r\n\t\t\trule.setAll({\r\n\t\t\t\tsvgPath: \"M 8 0 L 2 0 M 6 -4 L 2 0 L 6 4 M -2 0 L -8 0 M -6 -4 L -2 0 L -6 4\"\r\n\t\t\t});\r\n\t\t\tsetColor(rule, \"stroke\", ic, \"secondaryButton\");\r\n\t\t}\r\n\r\n\t\tr(\"Button\", [\"zoomout\"]).setAll({\r\n\t\t\ttooltipText: l.translateAny(\"Zoom out\")\r\n\t\t})\r\n\r\n\t\t{\r\n\t\t\tconst rule = r(\"Graphics\", [\"icon\", \"zoomout\", \"button\"]);\r\n\t\t\trule.setAll({\r\n\t\t\t\tsvgPath: \"M 8 0 L 2 0 M 4 -4 L 8 0 L 4 4 M -2 0 L -8 0 M -4 -4 L -8 0 L -4 4\"\r\n\t\t\t});\r\n\t\t\tsetColor(rule, \"stroke\", ic, \"secondaryButton\");\r\n\t\t}\r\n\r\n\r\n\t\t// x button (shown when clicked on a task)\t\t\r\n\t\tr(\"Button\", [\"xbutton\"]).setAll({\r\n\r\n\t\t\twidth: 35,\r\n\t\t\theight: 35,\r\n\t\t\tcenterX: p50,\r\n\t\t\tcenterY: p50\r\n\t\t})\r\n\r\n\t\tr(\"RoundedRectangle\", [\"xbutton\", \"background\"]).setAll({\r\n\t\t\tfillOpacity: 0,\r\n\t\t\tstrokeOpacity: 0\r\n\t\t});\r\n\r\n\t\tr(\"Graphics\", [\"xbutton\", \"icon\"]).setAll({\r\n\t\t\tfill: ic.get(\"negative\"),\r\n\t\t\tisMeasured: false,\r\n\t\t\tforceInactive: true,\r\n\t\t\tstroke: color(0xffffff),\r\n\t\t\tstrokeWidth: 2,\r\n\t\t\tcursorOverStyle: \"pointer\",\r\n\t\t\tcenterX: p50,\r\n\t\t\tcenterY: p50,\r\n\t\t\tx: p50,\r\n\t\t\ty: p50,\r\n\t\t\tdraw: (display) => {\r\n\t\t\t\tdisplay.arc(0, 0, 16, 0, Math.PI * 2);\r\n\r\n\t\t\t\tdisplay.moveTo(-6, -6);\r\n\t\t\t\tdisplay.lineTo(6, 6);\r\n\t\t\t\tdisplay.moveTo(6, -6);\r\n\t\t\t\tdisplay.lineTo(-6, 6);\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\t// color picker button\r\n\t\tr(\"ColorPickerButton\").setAll({\r\n\t\t\twidth: 35,\r\n\t\t\theight: 35,\r\n\t\t\tmarginLeft: 6,\r\n\t\t\ttooltipX: percent(90),\r\n\t\t\ttooltipText: l.translateAny(\"Set color\")\r\n\t\t});\r\n\t}\r\n}\r\n","import type { ValueAxis } from \"../xy/axes/ValueAxis\";\r\nimport type { AxisRendererX } from \"../xy/axes/AxisRendererX\";\r\nimport type { CategoryAxis } from \"../xy/axes/CategoryAxis\";\r\nimport type { AxisRendererY } from \"../xy/axes/AxisRendererY\";\r\nimport type { Gantt } from \"./Gantt\";\r\nimport type { DateAxis } from \"../xy/axes/DateAxis\";\r\nimport type { GanttCategoryAxis, IGanttCategoryAxisDataItem } from \"./GanttCategoryAxis\";\r\nimport type { GanttCategoryAxisRenderer } from \"./GanttCategoryAxisRenderer\";\r\nimport type { GanttDateAxis } from \"./GanttDateAxis\";\r\nimport type { GanttDateAxisRenderer } from \"./GanttDateAxisRenderer\";\r\n\r\nimport { ColumnSeries, IColumnSeriesPrivate, IColumnSeriesSettings, IColumnSeriesDataItem, IColumnSeriesAxisRange } from \"../xy/series/ColumnSeries\";\r\nimport { Container } from \"../../core/render/Container\";\r\nimport { Circle, color, DataItem, Graphics, IPoint, ISpritePointerEvent, Line, Link, ListTemplate, percent, Percent, Rectangle, RoundedRectangle, Template, Triangle } from \"../../..\";\r\n\r\nimport * as $array from \"../../core/util/Array\";\r\nimport * as $utils from \"../../core/util/Utils\";\r\nimport * as $math from \"../../core/util/Math\";\r\nimport * as $time from \"../../core/util/Time\";\r\nimport * as $object from \"../../core/util/Object\";\r\nimport * as $type from \"../../core/util/Type\";\r\n\r\nexport interface IGanttSeriesDataItem extends IColumnSeriesDataItem {\r\n\r\n\t/**\r\n\t * [[Container]] that holds all the elements of the series item, except the column graphics itslef.\r\n\t */\r\n\tcontainer?: Container\r\n\r\n\t/**\r\n\t * A [[Container]] that is masked and holds progress rectangle and progress grip.\t\r\n\t */\r\n\tmaskedContainer?: Container;\r\n\r\n\t/**\r\n\t * A [[RoundedRectangle]] that is used to mask the progress rectangle.\r\n\t */\r\n\tmask?: RoundedRectangle;\r\n\r\n\t/**\r\n\t * A [[Circle]] used as a bullet shown at the start of the task bar.\r\n\t */\r\n\tstartBullet?: Circle;\r\n\r\n\t/**\r\n\t * A [[Circle]] used as a bullet shown at the end of the task bar.\r\n\t */\r\n\tendBullet?: Circle;\r\n\r\n\t/**\r\n\t * A [[Rectangle]] filled with line pattern which is used to resize task bar.\r\n\t */\r\n\tstartGrip?: Rectangle;\r\n\r\n\t/**\r\n\t * A [[Rectangle]] filled with line pattern which is used to resize task bar.\r\n\t */\r\n\tendGrip?: Rectangle;\r\n\r\n\t/**\r\n\t * A [[Rectangle]] that is used to show progress of the task. It actually\r\n\t * shows the remaining part of the task and is filled with diagonal line\r\n\t * pattern.\r\n\t */\r\n\tprogressRectangle?: Rectangle;\r\n\r\n\t/**\r\n\t * A [[RoundedRectangle]] rotated by 45 degrees and is shown instead of a\r\n\t * column when the task has zero duration.\r\n\t */\r\n\tzeroRectangle?: RoundedRectangle;\r\n\r\n\t/**\r\n\t * A [[Triangle]] that is used to resize progress rectangle.\r\n\t */\r\n\tprogressGrip?: Triangle;\r\n\r\n\t/**\r\n\t * A value that holds the progress value of the task.\r\n\t */\r\n\tprogress?: number;\r\n\r\n\t/**\r\n\t * A value that holds previous progress value of the task, used when\r\n\t * toggling progress using progress pie next to the y axis label.\r\n\t */\r\n\tprevProgress?: number;\r\n\r\n\t/**\r\n\t * Duration of the task, in units of the x axis.\r\n\t */\r\n\tduration?: number;\r\n\r\n\t/**\r\n\t * Array of IDs of tasks this task is linked to.\r\n\t */\r\n\tlinkTo?: Array<string>;\r\n\r\n\t/**\r\n\t * Refferences to `Link` objects that are used to visually connect tasks.\r\n\t */\r\n\tlinks?: { [index: string]: Link };\r\n\r\n\t/**\r\n\t * A reference to a corresponding category axis data item.\r\n\t */\r\n\tcategoryAxisDataItem?: DataItem<IGanttCategoryAxisDataItem>;\r\n\r\n\t/**\r\n\t * Array of children data items.\r\n\t */\r\n\tchildren?: Array<DataItem<IGanttSeriesDataItem>>;\r\n\r\n\t/**\r\n\t * A reference to a parent data item, if any.\r\n\t */\r\n\tparent?: DataItem<IGanttSeriesDataItem>;\r\n\r\n\t/**\r\n\t * Category name.\r\n\t */\r\n\tname?: string;\r\n\r\n}\r\n\r\nexport interface IGanttSeriesSettings extends IColumnSeriesSettings {\r\n\r\n\t/**\r\n\t * A field in data that holds progress of the task.\r\n\t *\r\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/gantt/#Series_data} for more info\r\n\t * @default \"progress\"\r\n\t */\r\n\tprogressField?: string;\r\n\r\n\t/**\r\n\t * A field in data that holds duration of the task.\r\n\t *\r\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/gantt/#Series_data} for more info\r\n\t * @default \"duration\"\r\n\t */\r\n\tdurationField?: string;\r\n\r\n\t/**\r\n\t * A field in data that holds and ID of the task it is linked to.\r\n\t *\r\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/gantt/#Series_data} for more info\r\n\t * @default \"linkTo\"\r\n\t */\r\n\tlinkToField?: string;\r\n\r\n\t/**\r\n\t * A distance in pixels that link should be protracted from the edge of the\r\n\t * task bars.\r\n\t *\r\n\t * @default 25\r\n\t */\r\n\tlinkHorizontalOffset?: number;\r\n\r\n\t/**\r\n\t * When dragging/resizing a column, how many units should it snap to.\r\n\t * @default 1\r\n\t */\r\n\tsnapCount?: number;\r\n\r\n\t/**\r\n\t * A reference to the y-axis of the Gantt chart.\r\n\t */\r\n\tyAxis: GanttCategoryAxis<GanttCategoryAxisRenderer>;\r\n\r\n\t/**\r\n\t * A reference to the x-axis of the Gantt chart.\r\n\t */\r\n\txAxis: GanttDateAxis<GanttDateAxisRenderer>;\r\n\r\n}\r\n\r\nexport interface IGanttSeriesPrivate extends IColumnSeriesPrivate {\r\n}\r\n\r\nexport interface IGanttSeriesAxisRange extends IColumnSeriesAxisRange {\r\n}\r\n\r\n/**\r\n * A series used in [[Gantt]] chart to display tasks and their progress.\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/gantt/#Gantt_series} for more info\r\n * @important\r\n * @since 5.14.0\r\n */\r\nexport class GanttSeries extends ColumnSeries {\r\n\r\n\tdeclare public _settings: IGanttSeriesSettings;\r\n\tdeclare public _privateSettings: IGanttSeriesPrivate;\r\n\tdeclare public _dataItemSettings: IGanttSeriesDataItem;\r\n\tdeclare public _axisRangeType: IGanttSeriesAxisRange;\r\n\r\n\tpublic static className: string = \"GanttSeries\";\r\n\tpublic static classNames: Array<string> = ColumnSeries.classNames.concat([GanttSeries.className]);\r\n\r\n\tprotected _startBullet?: Circle;\r\n\tprotected _endBullet?: Circle;\r\n\r\n\t/**\r\n\t * A reference to the parent [[Gantt]] chart.\r\n\t */\r\n\tpublic gantt!: Gantt;\r\n\r\n\tprotected _columnDragStartX?: number;\r\n\tprotected _columnDragStartY?: number;\r\n\r\n\tprotected _hoveredDataItem?: DataItem<IGanttSeriesDataItem>;\r\n\r\n\tprotected _xPan?: boolean = false;\r\n\tprotected _yPan?: boolean = false;\r\n\r\n\r\n\t/**\r\n\t * A container that holds all the links between tasks.\r\n\t */\r\n\tpublic linksContainer: Container = this.children.push(Container.new(this._root, {}));\r\n\r\n\t/**\r\n\t * A line which is shown while creating a connector between two tasks.\r\n\t */\r\n\tpublic connectorLine: Line = this.children.push(Line.new(this._root, {\r\n\t\tthemeTags: [\"connectorline\"],\r\n\t\tvisible: false,\r\n\t\tforceInactive: true\r\n\t}));\r\n\r\n\t/**\r\n\t * A triangle that is shown at the end of the connector line, while creating\r\n\t * a connector.\r\n\t */\r\n\tpublic connectorArrow: Triangle = this.children.push(Triangle.new(this._root, {\r\n\t\tthemeTags: [\"connectorarrow\"],\r\n\t\tvisible: false,\r\n\t\tforceInactive: true\r\n\t}));\r\n\r\n\t/**\r\n\t * [[ListTemplate]] of [[Link]] that connect tasks.\r\n\t */\r\n\tpublic readonly links: ListTemplate<Link> = this.addDisposer(new ListTemplate(\r\n\t\tTemplate.new({}),\r\n\t\t() => Link._new(this._root, {\r\n\t\t\tthemeTags: $utils.mergeTags(this.containers.template.get(\"themeTags\", []), [\"link\"])\r\n\t\t}, [this.links.template])\r\n\t));\r\n\r\n\t/**\r\n\t * [[ListTemplate]] of [[Container]]s that hold all the elements of series\r\n\t * items, such as grips, bullets, etc.\r\n\t */\r\n\tpublic readonly containers: ListTemplate<Container> = this.addDisposer(new ListTemplate(\r\n\t\tTemplate.new({}),\r\n\t\t() => Container._new(this._root, {\r\n\t\t\tposition: \"absolute\",\r\n\t\t\tthemeTagsSelf: [\"columncontainer\"]\r\n\t\t}, [this.containers.template])\r\n\t));\r\n\r\n\t/**\r\n\t * [[ListTemplate]] of [[Container]]s that are used to mask elements, such\r\n\t * as progress rectangles.\r\n\t */\r\n\tpublic readonly maskedContainers: ListTemplate<Container> = this.addDisposer(new ListTemplate(\r\n\t\tTemplate.new({}),\r\n\t\t() => Container._new(this._root, {\r\n\t\t\tposition: \"absolute\",\r\n\t\t\tthemeTagsSelf: [\"maskedcontainer\"]\r\n\t\t}, [this.maskedContainers.template])\r\n\t));\r\n\r\n\t/**\r\n\t * [[ListTemplate]] of [[Circle]]s that are used as start bullets.\r\n\t */\r\n\tpublic readonly startBullets: ListTemplate<Circle> = this.addDisposer(new ListTemplate(\r\n\t\tTemplate.new({}),\r\n\t\t() => Circle._new(this._root, {\r\n\t\t\tx: - 1000,\r\n\t\t\tthemeTagsSelf: [\"connectorbullet\", \"start\"],\r\n\t\t}, [this.startBullets.template])\r\n\t));\r\n\r\n\t/**\r\n\t * [[ListTemplate]] of [[Circle]]s that are used as end bullets.\r\n\t */\r\n\tpublic readonly endBullets: ListTemplate<Circle> = this.addDisposer(new ListTemplate(\r\n\t\tTemplate.new({}),\r\n\t\t() => Circle._new(this._root, {\r\n\t\t\tx: - 1000,\r\n\t\t\tthemeTagsSelf: [\"connectorbullet\", \"end\"]\r\n\t\t}, [this.endBullets.template])\r\n\t));\r\n\r\n\t/**\r\n\t * [[ListTemplate]] of [[Rectangle]]s that are used to resize task bars.\r\n\t */\r\n\tpublic readonly startGrips: ListTemplate<Rectangle> = this.addDisposer(new ListTemplate(\r\n\t\tTemplate.new({}),\r\n\t\t() => Rectangle._new(this._root, {\r\n\t\t\tthemeTagsSelf: [\"resizegrip\", \"start\"]\r\n\t\t}, [this.startGrips.template])\r\n\t));\r\n\r\n\t/**\r\n\t * [[ListTemplate]] of [[Rectangle]]s that are used to resize task bars.\r\n\t */\r\n\tpublic readonly endGrips: ListTemplate<Rectangle> = this.addDisposer(new ListTemplate(\r\n\t\tTemplate.new({}),\r\n\t\t() => Rectangle._new(this._root, {\r\n\t\t\tthemeTagsSelf: [\"resizegrip\", \"end\"]\r\n\t\t}, [this.endGrips.template])\r\n\t));\r\n\r\n\t/**\r\n\t * [[ListTemplate]] of [[RoundedRectangle]]s that are used to show\r\n\t * zero-duration tasks.\r\n\t */\r\n\tpublic readonly zeroRectangles: ListTemplate<RoundedRectangle> = this.addDisposer(new ListTemplate(\r\n\t\tTemplate.new({}),\r\n\t\t() => RoundedRectangle._new(this._root, {\r\n\t\t\tthemeTagsSelf: [\"zerorectangle\"],\r\n\t\t}, [this.zeroRectangles.template])\r\n\t));\r\n\r\n\t/**\r\n\t * [[ListTemplate]] of [[Rectangle]]s that are used to show progress of the\r\n\t * task. It is actually a remaining part of the task and is filled with\r\n\t * diagonal line pattern.\r\n\t */\r\n\tpublic readonly progressRectangles: ListTemplate<Rectangle> = this.addDisposer(new ListTemplate(\r\n\t\tTemplate.new({}),\r\n\t\t() => Rectangle._new(this._root, {\r\n\t\t\tthemeTagsSelf: [\"progressrectangle\"]\r\n\t\t}, [this.progressRectangles.template])\r\n\t));\r\n\r\n\t/**\r\n\t * [[ListTemplate]] of [[Triangle]]s that are used to resize progress\r\n\t * rectangles.\r\n\t */\r\n\tpublic readonly progressGrips: ListTemplate<Triangle> = this.addDisposer(new ListTemplate(\r\n\t\tTemplate.new({}),\r\n\t\t() => Triangle._new(this._root, {\r\n\t\t\tthemeTagsSelf: [\"progressgrip\"]\r\n\t\t}, [this.progressGrips.template])\r\n\t));\r\n\r\n\tprotected _afterNew(): void {\r\n\t\tthis.fields.push(\"linkTo\", \"categoryId\");\r\n\t\tthis.valueFields.push(\"progress\", \"duration\");\r\n\t\tthis.set(\"exactLocationX\", true);\r\n\r\n\t\tsuper._afterNew();\r\n\r\n\t\tthis._disposers.push(this.events.on(\"globalpointermove\", (event) => {\r\n\t\t\tif (this.connectorLine.isVisible()) {\r\n\t\t\t\tconst point = this.toLocal(event.point);\r\n\t\t\t\tthis._updateConnector(point);\r\n\t\t\t}\r\n\t\t}));\r\n\r\n\t\tthis.events.on(\"globalpointerup\", (_event) => {\r\n\t\t\tif (this.connectorLine.isVisible()) {\r\n\t\t\t\tthis._endConnector();\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\tthis.columns.template.events.on(\"dragstart\", (e) => {\r\n\t\t\tthis._columnDragStartX = e.target.x();\r\n\t\t\tthis._columnDragStartY = e.target.y();\r\n\t\t})\r\n\r\n\t\tthis.columns.template.events.on(\"dragged\", (e) => {\r\n\t\t\tthis._handleColumnDragged(e);\r\n\t\t})\r\n\r\n\t\tthis.columns.template.events.on(\"dragstop\", (e) => {\r\n\t\t\tconst xAxis = this.get(\"xAxis\") as ValueAxis<AxisRendererX>;\r\n\t\t\tconst dataItem = e.target.dataItem as DataItem<IGanttSeriesDataItem>;\r\n\r\n\t\t\tconst openValueX = dataItem.get(\"openValueX\", 0);\r\n\t\t\tlet newOpenValueX = xAxis.positionToValue(xAxis.coordinateToPosition(e.target.x()));\r\n\r\n\t\t\tconst valueX = dataItem.get(\"valueX\", 0);\r\n\r\n\t\t\tlet diff = newOpenValueX - openValueX;\r\n\t\t\tdataItem.set(\"openValueX\", newOpenValueX);\r\n\t\t\tdataItem.set(\"valueX\", valueX + diff);\r\n\r\n\t\t\tdataItem.set(\"openValueXWorking\", newOpenValueX);\r\n\t\t\tdataItem.set(\"valueXWorking\", valueX + diff);\r\n\r\n\t\t\tthis._fixValues(dataItem, \"duration\");\r\n\r\n\t\t\tthis._moveChildValues(dataItem, diff);\r\n\t\t})\r\n\t}\r\n\r\n\r\n\t/**\r\n\t * @ignore\r\n\t */\r\n\tprotected roundValue(value: number, invertThreshold?: boolean): number {\r\n\t\tlet threshold = this.gantt.get(\"snapThreshold\", 0.8);\r\n\t\tif (invertThreshold) {\r\n\t\t\tthreshold = 1 - threshold;\r\n\t\t}\r\n\t\tconst snapCount = this.get(\"snapCount\", 1);\r\n\t\tconst xAxis = this.get(\"xAxis\") as DateAxis<AxisRendererX>;\r\n\t\tconst baseInterval = xAxis.get(\"baseInterval\");\r\n\t\treturn $time.roun(value + this.getUnitDuration() * threshold, baseInterval.timeUnit, baseInterval.count * snapCount, this._root);\r\n\t}\r\n\r\n\t/**\r\n\t * @ignore\r\n\t */\r\n\tpublic makeColumn(\r\n\t\tdataItem: DataItem<this[\"_dataItemSettings\"]>,\r\n\t\tlistTemplate: ListTemplate<RoundedRectangle>\r\n\t): RoundedRectangle {\r\n\t\t// Create the main column\r\n\t\tconst column = super.makeColumn(dataItem, listTemplate);\r\n\t\tconst yAxis = this.get(\"yAxis\") as GanttCategoryAxis<GanttCategoryAxisRenderer>;\r\n\t\tcolumn.events.on(\"click\", () => {\r\n\t\t\tyAxis.selectDataItem(dataItem.get(\"categoryAxisDataItem\") as DataItem<IGanttCategoryAxisDataItem>);\r\n\t\t})\r\n\r\n\t\t// --- Container setup ---\r\n\t\tconst container = this.mainContainer.children.push(this.containers.make());\r\n\t\tcontainer._setDataItem(dataItem);\r\n\t\tthis.containers.push(container);\r\n\r\n\t\tconst zeroRectangle = this.zeroRectangles.make();\r\n\t\tdataItem.set(\"zeroRectangle\", zeroRectangle);\r\n\t\tthis.zeroRectangles.push(zeroRectangle);\r\n\t\tcontainer.children.unshift(zeroRectangle);\r\n\t\tif (dataItem.get(\"duration\", 0) > 0) {\r\n\t\t\tzeroRectangle.hide(0);\r\n\t\t}\r\n\r\n\t\tlet zy = 0;\r\n\t\tzeroRectangle.events.on(\"pointerdown\", (e) => {\r\n\t\t\tzy = e.target.y();\r\n\t\t\tcolumn.dragStart(e);\r\n\t\t})\r\n\r\n\t\tzeroRectangle.events.on(\"dragstart\", (e) => {\r\n\t\t\tthis._handleColumnDragged(e);\r\n\t\t\te.target.setAll({\r\n\t\t\t\tx: 0,\r\n\t\t\t\ty: zy\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\tzeroRectangle.events.on(\"dragged\", (e) => {\r\n\t\t\tthis._handleColumnDragged(e);\r\n\r\n\t\t\te.target.setAll({\r\n\t\t\t\tx: 0,\r\n\t\t\t\ty: zy\r\n\t\t\t});\r\n\t\t})\r\n\r\n\t\tzeroRectangle.events.on(\"dragstop\", (e) => {\r\n\t\t\tcolumn.dragStop(e);\r\n\t\t})\r\n\r\n\t\tzeroRectangle.events.on(\"pointerover\", (e) => {\r\n\t\t\tthis._handleColumnHover(e);\r\n\t\t})\r\n\r\n\t\tzeroRectangle.adapters.add(\"fillPattern\", (fillPattern, target) => {\r\n\t\t\tconst dataItem = target.dataItem as DataItem<IGanttSeriesDataItem>;\r\n\t\t\tif (dataItem.get(\"progress\", 0) < 1) {\r\n\t\t\t\treturn progressRectangle.get(\"fillPattern\");\r\n\t\t\t}\r\n\r\n\t\t\treturn fillPattern;\r\n\t\t});\r\n\r\n\t\tconst maskedContainer = container.children.push(this.maskedContainers.make());\r\n\t\tdataItem.setRaw(\"maskedContainer\", maskedContainer);\r\n\r\n\t\tconst mask = container.children.push(RoundedRectangle.new(this._root, {\r\n\t\t\tfill: color(0xffffff),\r\n\t\t\tforceInactive: true,\r\n\t\t\tfillOpacity: 0\r\n\t\t}));\r\n\t\tdataItem.setRaw(\"mask\", mask);\r\n\t\tmaskedContainer.set(\"mask\", mask);\r\n\r\n\t\t// --- Progress elements ---\r\n\t\tconst progressRectangle = maskedContainer.children.push(this.progressRectangles.make());\r\n\t\tthis.progressRectangles.push(progressRectangle);\r\n\r\n\t\tconst progressGrip = this.progressGrips.make();\r\n\t\tthis.progressGrips.push(progressGrip);\r\n\t\tmaskedContainer.children.push(progressGrip);\r\n\r\n\t\tprogressGrip.events.on(\"dragged\", () => {\r\n\t\t\tlet x = progressGrip.x();\r\n\t\t\tx = $math.fitToRange(x, 0, column.getPrivate(\"width\", 0));\r\n\t\t\tprogressGrip.setAll({ x: x, y: column.getPrivate(\"height\", 0) });\r\n\t\t\tdataItem.set(\"progress\", progressGrip.x() / column.getPrivate(\"width\", 0));\r\n\t\t});\r\n\r\n\t\t// --- Grips (start/end) ---\r\n\r\n\t\tconst startGrip = this.startGrips.make();\r\n\t\tthis.startGrips.push(startGrip);\r\n\t\tcontainer.children.push(startGrip);\r\n\r\n\t\tconst endGrip = this.endGrips.make();\r\n\t\tthis.endGrips.push(endGrip);\r\n\t\tcontainer.children.push(endGrip);\r\n\r\n\t\tdataItem.setRaw(\"startGrip\", startGrip);\r\n\t\tdataItem.setRaw(\"endGrip\", endGrip);\r\n\r\n\t\t// --- Axis reference ---\r\n\t\tconst xAxis = this.get(\"xAxis\") as ValueAxis<AxisRendererX>;\r\n\r\n\t\t// --- Grip events ---\r\n\t\tlet startX = 0;\r\n\t\tstartGrip.events.on(\"dragstart\", () => {\r\n\t\t\tstartX = column.x();\r\n\t\t\tcolumn.show();\r\n\t\t\tzeroRectangle.hide();\r\n\t\t\tmaskedContainer.show();\r\n\t\t});\r\n\t\tstartGrip.events.on(\"pointerover\", () => {\r\n\t\t\tcolumn.states.applyAnimate(\"hover\");\r\n\t\t});\r\n\t\tstartGrip.events.on(\"pointerout\", () => {\r\n\t\t\tif (column.isVisible()) {\r\n\t\t\t\tcolumn.states.applyAnimate(\"default\");\r\n\t\t\t}\r\n\t\t});\r\n\t\tstartGrip.events.on(\"dragged\", () => {\r\n\t\t\tstartGrip.set(\"y\", 0);\r\n\t\t\tconst x = startGrip.x() + startX;\r\n\t\t\tlet openValueX = xAxis.positionToValue(xAxis.coordinateToPosition(x));\r\n\t\t\tlet minStart = this._findMinStart(dataItem);\r\n\r\n\t\t\topenValueX = Math.max(openValueX, minStart);\r\n\t\t\topenValueX = Math.min(openValueX, dataItem.get(\"valueX\", openValueX));\r\n\r\n\t\t\tdataItem.set(\"openValueX\", openValueX);\r\n\r\n\t\t\tstartGrip.set(\"x\", 0);\r\n\t\t});\r\n\r\n\t\tstartGrip.events.on(\"dragstop\", () => {\r\n\t\t\tthis._fixValues(dataItem, \"end\");\r\n\t\t\tthis.markDirtyValues();\r\n\t\t});\r\n\r\n\t\tlet endX = 0;\r\n\t\tendGrip.events.on(\"dragstart\", () => {\r\n\t\t\tendX = column.x();\r\n\t\t\tcolumn.show();\r\n\t\t\tzeroRectangle.hide();\r\n\t\t\tmaskedContainer.show();\r\n\t\t});\r\n\t\tendGrip.events.on(\"pointerover\", () => {\r\n\t\t\tcolumn.states.applyAnimate(\"hover\");\r\n\t\t});\r\n\t\tendGrip.events.on(\"pointerout\", () => {\r\n\t\t\tif (column.isVisible()) {\r\n\t\t\t\tcolumn.states.applyAnimate(\"default\");\r\n\t\t\t}\r\n\t\t});\r\n\t\tendGrip.events.on(\"dragged\", () => {\r\n\t\t\tendGrip.set(\"y\", 0);\r\n\t\t\tconst x = endGrip.x() + endX;\r\n\t\t\tlet valueX = xAxis.positionToValue(xAxis.coordinateToPosition(x));\r\n\t\t\tvalueX = Math.max(valueX, dataItem.get(\"openValueX\", 0));\r\n\t\t\tdataItem.set(\"valueX\", valueX);\r\n\t\t\tdataItem.set(\"valueXWorking\", valueX);\r\n\t\t\tconst column = dataItem.get(\"graphics\") as RoundedRectangle;\r\n\t\t\tif (column) {\r\n\t\t\t\tendGrip.set(\"x\", column.width());\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tendGrip.events.on(\"dragstop\", () => {\r\n\t\t\tthis._fixValues(dataItem, \"start\");\r\n\t\t\tthis.markDirtyValues();\r\n\t\t});\r\n\r\n\t\t// --- Bullets (start/end) ---\r\n\t\tconst startBullet = this.startBullets.make();\r\n\r\n\t\tstartBullet.events.on(\"pointerout\", () => {\r\n\t\t\tif (column.isVisible()) {\r\n\t\t\t\tcolumn.states.applyAnimate(\"default\");\r\n\t\t\t}\r\n\t\t});\r\n\t\tthis.startBullets.push(startBullet);\r\n\t\tcontainer.children.push(startBullet);\r\n\r\n\t\tconst endBullet = this.endBullets.make();\r\n\t\tthis.endBullets.push(endBullet);\r\n\t\tcontainer.children.push(endBullet);\r\n\r\n\t\t// --- Bullet events (connector logic) ---\r\n\t\tconst bulletPointerDown = (bullet: Circle) => {\r\n\t\t\tthis._startConnector(bullet);\r\n\t\t};\r\n\r\n\t\tstartBullet.events.on(\"pointerdown\", () => bulletPointerDown(startBullet));\r\n\t\tendBullet.events.on(\"pointerdown\", () => bulletPointerDown(endBullet));\r\n\r\n\t\tcolumn.events.on(\"pointerover\", (e) => {\r\n\t\t\tthis._handleColumnHover(e);\r\n\t\t})\r\n\r\n\t\tcolumn.events.on(\"pointerout\", () => {\r\n\t\t\tthis._hoveredDataItem = undefined;\r\n\t\t\tif (this.connectorLine.isVisible()) {\r\n\t\t\t\tstartBullet.hide();\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\t// --- Data item references ---\r\n\t\tdataItem.setRaw(\"container\", container);\r\n\t\tdataItem.setRaw(\"startBullet\", startBullet);\r\n\t\tdataItem.setRaw(\"endBullet\", endBullet);\r\n\t\tdataItem.setRaw(\"progressRectangle\", progressRectangle);\r\n\t\tdataItem.setRaw(\"progressGrip\", progressGrip);\r\n\r\n\t\t// --- Sync container with column position ---\r\n\t\tconst syncProp = (prop: any, target: any) => {\r\n\t\t\tcolumn.on(prop, (val) => {\r\n\t\t\t\ttarget.set(prop, val);\r\n\t\t\t});\r\n\t\t};\r\n\t\tsyncProp(\"x\", container);\r\n\t\tsyncProp(\"y\", container);\r\n\t\tsyncProp(\"dx\", container);\r\n\t\tsyncProp(\"dy\", container);\r\n\t\tsyncProp(\"cornerRadiusBL\", mask);\r\n\t\tsyncProp(\"cornerRadiusBR\", mask);\r\n\t\tsyncProp(\"cornerRadiusTL\", mask);\r\n\t\tsyncProp(\"cornerRadiusTR\", mask);\r\n\r\n\t\tif (this.isCollapsed(dataItem)) {\r\n\t\t\tdataItem.hide(0);\r\n\t\t\tcolumn.hide(0);\r\n\t\t\tmaskedContainer.hide(0);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tif (dataItem.get(\"duration\", 0) > 0) {\r\n\t\t\t\tcolumn.appear();\r\n\t\t\t\tmaskedContainer.appear();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\r\n\t\treturn column;\r\n\t}\r\n\r\n\tprotected _handleColumnDragged(e: ISpritePointerEvent) {\r\n\t\tconst column = e.target as RoundedRectangle;\r\n\t\tconst dataItem = column.dataItem as DataItem<IGanttSeriesDataItem>;\r\n\r\n\t\t// Maintain vertical position to prevent vertical dragging\r\n\t\tif (this._columnDragStartY !== undefined) {\r\n\t\t\tcolumn.set(\"y\", this._columnDragStartY);\r\n\t\t}\r\n\r\n\t\t// Calculate horizontal drag offset and apply to child elements\r\n\t\tif (dataItem && this._columnDragStartX !== undefined) {\r\n\t\t\tconst dragOffset = column.x() - this._columnDragStartX;\r\n\t\t\tthis._dragChildValues(dataItem, dragOffset);\r\n\r\n\t\t\tthis._updateLinks();\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _handleColumnHover(e: ISpritePointerEvent) {\r\n\t\t// Only process hover if we're currently creating a connector\r\n\t\tif (!this.connectorLine.isVisible()) return;\r\n\r\n\t\tconst column = e.target as RoundedRectangle;\r\n\t\tconst dataItem = column.dataItem as DataItem<IGanttSeriesDataItem>;\r\n\r\n\t\t// Skip if no valid data item\r\n\t\tif (!dataItem) return;\r\n\r\n\t\tconst startBullet = dataItem.get(\"startBullet\");\r\n\t\tconst sourceDataItem = this._startBullet?.dataItem as DataItem<IGanttSeriesDataItem>;\r\n\r\n\t\t// Show the start bullet only if:\r\n\t\t// 1. We have a valid start bullet\r\n\t\t// 2. We have a source data item for the connection\r\n\t\t// 3. Both items are at the same depth level\r\n\t\t// 4. We're not trying to connect to the same item\r\n\t\tif (startBullet &&\r\n\t\t\tsourceDataItem &&\r\n\t\t\tthis.getDepth(sourceDataItem) === this.getDepth(dataItem) &&\r\n\t\t\tsourceDataItem !== dataItem) {\r\n\r\n\t\t\tstartBullet.show();\r\n\t\t\tthis._hoveredDataItem = dataItem;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Checks if the task is collapsed.\r\n\t *\r\n\t * @param  dataItem  Data item\r\n\t * @return           Collapsed?\r\n\t */\r\n\tpublic isCollapsed(dataItem: DataItem<IGanttSeriesDataItem>): boolean {\r\n\t\tconst categoryAxisDataItem = dataItem.get(\"categoryAxisDataItem\") as DataItem<IGanttCategoryAxisDataItem>;\r\n\t\tif (categoryAxisDataItem) {\r\n\t\t\tconst parent = categoryAxisDataItem.get(\"parent\");\r\n\t\t\tif (parent) {\r\n\t\t\t\tif (parent.get(\"collapsed\")) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t\treturn this.isCollapsed(parent);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n\t/**\r\n\t * Updates the series, recalculating values and updating children.\r\n\t *\r\n\t * @ignore Exclude from docs\r\n\t */\r\n\tpublic _updateChildren() {\r\n\r\n\t\tif (this._valuesDirty) {\r\n\r\n\t\t\tthis.setPrivateRaw(\"minX\", undefined);\r\n\t\t\tthis.setPrivateRaw(\"maxX\", undefined);\r\n\r\n\t\t\tconst yAxis = this.get(\"yAxis\") as GanttCategoryAxis<GanttCategoryAxisRenderer>;\r\n\t\t\tconst yRenderer = yAxis.get(\"renderer\") as GanttCategoryAxisRenderer;\r\n\r\n\t\t\t$array.each(this.dataItems, (dataItem) => {\r\n\t\t\t\tconst dataContext = dataItem.dataContext as any;\r\n\r\n\t\t\t\tconst categoryAxisDataItem = dataItem.get(\"categoryAxisDataItem\") as DataItem<IGanttCategoryAxisDataItem>;\r\n\t\t\t\tif (categoryAxisDataItem) {\r\n\r\n\t\t\t\t\tconst children = dataItem.get(\"children\");\r\n\t\t\t\t\tif (children && children.length > 0) {\r\n\t\t\t\t\t\tdataItem.set(\"openValueX\", undefined);\r\n\t\t\t\t\t\tdataItem.set(\"valueX\", undefined);\r\n\r\n\t\t\t\t\t\tdataItem.set(\"openValueXWorking\", undefined);\r\n\t\t\t\t\t\tdataItem.set(\"valueXWorking\", undefined);\r\n\r\n\r\n\t\t\t\t\t\tdelete (dataContext[this.get(\"openValueXField\")]);\r\n\t\t\t\t\t\tdelete (dataContext[this.get(\"durationField\")]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tdataContext[this.get(\"openValueXField\")] = dataItem.get(\"openValueX\");\r\n\t\t\t\t\t\tdataContext[this.get(\"durationField\")] = dataItem.get(\"duration\");\r\n\t\t\t\t\t\tdataContext[this.get(\"progressField\")] = dataItem.get(\"progress\");\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tdataContext[this.get(\"linkToField\")] = dataItem.get(\"linkTo\");\r\n\r\n\t\t\t\t\tconst category = dataItem.get(\"categoryY\");\r\n\t\t\t\t\tconst categoryYField = this.get(\"categoryYField\", \"category\");\r\n\r\n\t\t\t\t\tdataContext[categoryYField] = category;\r\n\r\n\t\t\t\t\tconst categoryDataContext = categoryAxisDataItem.dataContext as any;\r\n\t\t\t\t\tconst categoryField = yAxis.get(\"categoryField\", \"category\");\r\n\t\t\t\t\tconst parent = categoryAxisDataItem.get(\"parent\");\r\n\r\n\t\t\t\t\tcategoryDataContext[categoryField] = category;\r\n\t\t\t\t\tif (parent) {\r\n\t\t\t\t\t\tcategoryDataContext[yAxis.get(\"parentIdField\", \"parentId\")] = parent.get(\"id\");\r\n\t\t\t\t\t\tcategoryDataContext[yAxis.get(\"collapsedField\", \"collapsed\")] = categoryAxisDataItem.get(\"collapsed\", false);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\t$array.each(this.dataItems, (dataItem) => {\r\n\t\t\t\tthis._adjustParentValues(dataItem);\r\n\r\n\t\t\t\tconst children = dataItem.get(\"children\");\r\n\t\t\t\tconst startGrip = dataItem.get(\"startGrip\");\r\n\t\t\t\tconst endGrip = dataItem.get(\"endGrip\");\r\n\t\t\t\tconst progressGrip = dataItem.get(\"progressGrip\");\r\n\r\n\t\t\t\tlet visible = true;\r\n\t\t\t\tif (children && children.length > 0) {\r\n\t\t\t\t\tvisible = false;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (startGrip) {\r\n\t\t\t\t\tstartGrip.setPrivate(\"visible\", visible);\r\n\t\t\t\t}\r\n\t\t\t\tif (endGrip) {\r\n\t\t\t\t\tendGrip.set(\"visible\", visible);\r\n\t\t\t\t}\r\n\t\t\t\tif (progressGrip) {\r\n\t\t\t\t\tprogressGrip.set(\"visible\", visible);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst categoryAxisDataItem = dataItem.get(\"categoryAxisDataItem\") as DataItem<IGanttCategoryAxisDataItem>;\r\n\r\n\t\t\t\tlet index = 0;\r\n\t\t\t\tif (categoryAxisDataItem) {\r\n\t\t\t\t\tconst durationStepper = categoryAxisDataItem.get(\"durationStepper\");\r\n\t\t\t\t\tif (durationStepper) {\r\n\t\t\t\t\t\tdurationStepper.set(\"disabled\", !visible);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tindex = categoryAxisDataItem.get(\"index\", 0);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst duration = dataItem.get(\"duration\", 0);\r\n\r\n\t\t\t\tlet zeroRectangle = dataItem.get(\"zeroRectangle\");\r\n\t\t\t\tconst column = dataItem.get(\"graphics\") as RoundedRectangle;\r\n\t\t\t\tconst maskedContainer = dataItem.get(\"maskedContainer\");\r\n\t\t\t\tconst fill = categoryAxisDataItem.get(\"customColor\", categoryAxisDataItem.get(\"color\"));\r\n\r\n\t\t\t\tif (zeroRectangle) {\r\n\t\t\t\t\tlet height = 20;\r\n\r\n\t\t\t\t\tlet y0 = yAxis.indexToPosition(index, 0);\r\n\t\t\t\t\tlet y1 = yAxis.indexToPosition(index, 1);\r\n\r\n\t\t\t\t\ty0 = yRenderer.positionToCoordinate(y0);\r\n\t\t\t\t\ty1 = yRenderer.positionToCoordinate(y1);\r\n\r\n\t\t\t\t\tconst columnHeight = column.get(\"height\", 0);\r\n\t\t\t\t\tlet r = 1;\r\n\t\t\t\t\tif (columnHeight instanceof Percent) {\r\n\t\t\t\t\t\tr *= columnHeight.value * $math.cos(45);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\theight = (y1 - y0) * r;\r\n\r\n\r\n\r\n\t\t\t\t\tconst maxHeight = column.get(\"maxHeight\", Infinity) * $math.cos(45);\r\n\t\t\t\t\tconst minHeight = column.get(\"minHeight\", 0) * $math.cos(45);\r\n\t\t\t\t\theight = $math.fitToRange(height, minHeight, maxHeight);\r\n\r\n\t\t\t\t\tzeroRectangle.setPrivate(\"height\", height);\r\n\t\t\t\t\tzeroRectangle.setPrivate(\"width\", height);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (column && maskedContainer && !this.isCollapsed(dataItem)) {\r\n\t\t\t\t\tif (duration === 0 && zeroRectangle) {\r\n\t\t\t\t\t\tif (!column.isHidden() && !column.isHiding()) {\r\n\t\t\t\t\t\t\tzeroRectangle.setAll({\r\n\t\t\t\t\t\t\t\tfill: fill,\r\n\t\t\t\t\t\t\t\tstroke: fill\r\n\t\t\t\t\t\t\t})\r\n\r\n\t\t\t\t\t\t\tif (!startGrip?.isDragging() && !endGrip?.isDragging()) {\r\n\t\t\t\t\t\t\t\tcolumn.hide();\r\n\t\t\t\t\t\t\t\tmaskedContainer.hide();\r\n\t\t\t\t\t\t\t\tzeroRectangle.show();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tif (zeroRectangle) {\r\n\t\t\t\t\t\t\tzeroRectangle.hide();\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tcolumn.show();\r\n\t\t\t\t\t\tmaskedContainer.show();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\t$array.each(this.dataItems, (dataItem) => {\r\n\t\t\t\tthis._adjustLinkValues(dataItem);\r\n\t\t\t});\r\n\r\n\t\t\t$array.each(this.dataItems, (dataItem) => {\r\n\t\t\t\tthis._adjustParentValues(dataItem);\r\n\r\n\t\t\t\tconst categoryAxisDataItem = dataItem.get(\"categoryAxisDataItem\") as DataItem<IGanttCategoryAxisDataItem>;\r\n\t\t\t\tif (categoryAxisDataItem) {\r\n\t\t\t\t\tcategoryAxisDataItem.set(\"duration\", dataItem.get(\"duration\"));\r\n\t\t\t\t\tcategoryAxisDataItem.set(\"progress\", dataItem.get(\"progress\"));\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\t// dispatch event\r\n\t\t\tconst eventType = \"valueschanged\";\r\n\t\t\tif (this.events.isEnabled(eventType)) {\r\n\t\t\t\tthis.events.dispatch(eventType, {\r\n\t\t\t\t\ttype: eventType, target: this\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tsuper._updateChildren();\r\n\r\n\t\tif (this._columnsUpdated) {\r\n\t\t\tthis._updateLinks();\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _getParentOpen(dataItem: DataItem<IGanttSeriesDataItem>): number {\r\n\t\tconst parent = dataItem.get(\"parent\");\r\n\t\tif (parent) {\r\n\t\t\treturn this._getParentOpen(parent);\r\n\t\t}\r\n\t\telse {\r\n\t\t\treturn dataItem.get(\"openValueX\", -Infinity);\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _adjustLinkValues(dataItem: DataItem<IGanttSeriesDataItem>) {\r\n\t\tconst linkTo = dataItem.get(\"linkTo\");\r\n\t\tif (linkTo) {\r\n\t\t\tconst valueX = dataItem.get(\"valueX\", 0);\r\n\t\t\t$array.each(linkTo, (id) => {\r\n\t\t\t\tconst linkDataItem = this.getDataItemById(id);\r\n\r\n\t\t\t\tif (linkDataItem && linkDataItem !== dataItem) {\r\n\t\t\t\t\tconst linkOpenValueX = linkDataItem.get(\"openValueX\", 0);\r\n\t\t\t\t\tif (linkOpenValueX !== undefined && linkOpenValueX < valueX) {\r\n\t\t\t\t\t\tlinkDataItem.set(\"openValueX\", valueX);\r\n\t\t\t\t\t\tthis._fixValues(linkDataItem, \"duration\");\r\n\t\t\t\t\t\tthis._adjustChildValues(linkDataItem);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _adjustChildValues(dataItem: DataItem<IGanttSeriesDataItem>) {\r\n\t\tconst children = dataItem.get(\"children\", []);\r\n\t\tif (children && children.length > 0) {\r\n\t\t\tlet openValueX = dataItem.get(\"openValueX\", 0);\r\n\r\n\t\t\t$array.each(children, (child) => {\r\n\t\t\t\tconst childOpenValueX = child.get(\"openValueX\", 0);\r\n\t\t\t\tif (childOpenValueX === undefined || childOpenValueX < openValueX) {\r\n\t\t\t\t\tchild.set(\"openValueX\", openValueX);\r\n\t\t\t\t\tthis._fixValues(child, \"duration\");\r\n\t\t\t\t}\r\n\t\t\t\tthis._adjustChildValues(child);\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _dragChildValues(dataItem: DataItem<IGanttSeriesDataItem>, dx: number) {\r\n\t\tconst children = dataItem.get(\"children\");\r\n\t\tif (children && children.length > 0) {\r\n\t\t\t$array.each(children, (child) => {\r\n\t\t\t\tconst column = child.get(\"graphics\") as RoundedRectangle;\r\n\t\t\t\tif (column) {\r\n\t\t\t\t\tcolumn.set(\"dx\", dx);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis._dragChildValues(child, dx);\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _moveChildValues(dataItem: DataItem<IGanttSeriesDataItem>, diff: number) {\r\n\t\tconst children = dataItem.get(\"children\");\r\n\t\tif (children && children.length > 0) {\r\n\t\t\t$array.each(children, (child) => {\r\n\t\t\t\tchild.set(\"openValueX\", child.get(\"openValueX\", 0) + diff);\r\n\t\t\t\tchild.set(\"valueX\", child.get(\"valueX\", 0) + diff);\r\n\r\n\t\t\t\tchild.set(\"openValueXWorking\", child.get(\"openValueX\"));\r\n\t\t\t\tchild.set(\"valueXWorking\", child.get(\"openValueX\"));\r\n\r\n\r\n\t\t\t\tconst column = child.get(\"graphics\") as RoundedRectangle;\r\n\t\t\t\tif (column) {\r\n\t\t\t\t\tcolumn.set(\"dx\", 0);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis._fixValues(child, \"duration\");\r\n\t\t\t\tthis._moveChildValues(child, diff);\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _findMinStart(dataItem: DataItem<IGanttSeriesDataItem>): number {\r\n\t\t// check if item has links from other items\r\n\t\tlet maxValue: number = -Infinity;\r\n\t\t$array.each(this.dataItems, (item) => {\r\n\t\t\tconst linkTo = item.get(\"linkTo\");\r\n\t\t\tif (linkTo) {\r\n\t\t\t\t$array.each(linkTo, (id) => {\r\n\t\t\t\t\tif (id === dataItem.get(\"id\")) {\r\n\t\t\t\t\t\tconst itemValueX = item.get(\"valueX\", 0);\r\n\t\t\t\t\t\tif (itemValueX > maxValue) {\r\n\t\t\t\t\t\t\tmaxValue = itemValueX;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t})\r\n\t\t// if this is a child, check parent start\r\n\t\tconst parent = dataItem.get(\"parent\");\r\n\t\tif (parent) {\r\n\t\t\tmaxValue = Math.max(maxValue, this._findMinStart(parent));\r\n\t\t}\r\n\r\n\t\treturn maxValue;\r\n\t}\r\n\r\n\tprotected _adjustParentValues(dataItem: DataItem<IGanttSeriesDataItem>) {\r\n\t\tconst categoryAxisDataItem = dataItem.get(\"categoryAxisDataItem\");\r\n\t\tif (categoryAxisDataItem) {\r\n\t\t\tconst column = dataItem.get(\"graphics\") as RoundedRectangle;\r\n\t\t\tlet color = categoryAxisDataItem.get(\"customColor\", categoryAxisDataItem.get(\"color\"));\r\n\t\t\tif (column) {\r\n\t\t\t\tcolumn.setAll({\r\n\t\t\t\t\tfill: color,\r\n\t\t\t\t\tstroke: color\r\n\t\t\t\t})\r\n\t\t\t}\r\n\r\n\t\t\tconst zeroRectangle = dataItem.get(\"zeroRectangle\");\r\n\t\t\tif (zeroRectangle) {\r\n\t\t\t\tzeroRectangle.setAll({\r\n\t\t\t\t\tfill: color,\r\n\t\t\t\t\tstroke: color,\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tconst children = dataItem.get(\"children\");\r\n\t\t\tif (children && children.length > 0) {\r\n\t\t\t\tlet progress = 0;\r\n\t\t\t\t$array.each(children, (child) => {\r\n\t\t\t\t\tconst childProgress = child.get(\"progress\", 0);\r\n\t\t\t\t\tif (childProgress !== undefined) {\r\n\t\t\t\t\t\tprogress += childProgress;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tprogress /= children.length;\r\n\t\t\t\tdataItem.set(\"progress\", progress);\r\n\t\t\t}\r\n\r\n\t\t\tif (categoryAxisDataItem) {\r\n\t\t\t\tlet valueX = dataItem.get(\"valueX\");\r\n\t\t\t\tlet openValueX = dataItem.get(\"openValueX\");\r\n\r\n\t\t\t\tconst duration = dataItem.get(\"duration\", 0);\r\n\t\t\t\tif (valueX === undefined && openValueX !== undefined) {\r\n\t\t\t\t\topenValueX = this.getOpenValue(openValueX);\r\n\t\t\t\t\tvalueX = this.getEndValue(openValueX, duration);\r\n\r\n\t\t\t\t\tdataItem.setRaw(\"openValueX\", openValueX);\r\n\t\t\t\t\tdataItem.setRaw(\"valueX\", valueX);\r\n\r\n\t\t\t\t\t//dataItem.setRaw(\"openValueXWorking\", openValueX);\r\n\t\t\t\t\t//dataItem.setRaw(\"valueXWorking\", valueX);\t\t\t\t\t\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlet parent = dataItem.get(\"parent\");\r\n\t\t\t\tif (openValueX !== undefined && valueX !== undefined && parent) {\r\n\t\t\t\t\tconst parentOpenValueX = parent.get(\"openValueX\");\r\n\t\t\t\t\tconst parentValueX = parent.get(\"valueX\");\r\n\r\n\t\t\t\t\tif (parentOpenValueX === undefined || parentOpenValueX > openValueX) {\r\n\t\t\t\t\t\tparent.set(\"openValueX\", openValueX);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (parentValueX === undefined || parentValueX < valueX) {\r\n\t\t\t\t\t\tparent.set(\"valueX\", valueX);\r\n\t\t\t\t\t\tparent.set(\"valueXWorking\", valueX);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tparent.set(\"duration\", this.getDataItemDuration(parent));\r\n\t\t\t\t\tthis._adjustParentValues(parent);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _startConnector(bullet: Circle) {\r\n\t\tthis._startBullet = bullet;\r\n\r\n\t\tthis.connectorLine.show();\r\n\t\tthis.connectorArrow.show();\r\n\r\n\t\tthis._xPan = this.chart?.get(\"panX\");\r\n\t\tthis._yPan = this.chart?.get(\"panY\");\r\n\r\n\t\tthis.chart?.set(\"panX\", false);\r\n\t\tthis.chart?.set(\"panY\", false);\r\n\r\n\t\tconst dataItem = bullet.dataItem as DataItem<IGanttSeriesDataItem>;\r\n\r\n\t\t// disable all columns of not the same depth\r\n\t\tconst depth = this.getDepth(dataItem);\r\n\t\tconst itemsToDisable: Array<DataItem<IGanttSeriesDataItem>> = [];\r\n\t\t$array.each(this.dataItems, (item) => {\r\n\t\t\tif (this.getDepth(item) != depth) {\r\n\t\t\t\t$array.move(itemsToDisable, item);\r\n\t\t\t}\r\n\t\t\t// also if already connected, disable\r\n\t\t\tconst links = dataItem.get(\"links\");\r\n\t\t\tif (links && links[item.get(\"id\")!]) {\r\n\t\t\t\t$array.move(itemsToDisable, item);\r\n\t\t\t}\r\n\r\n\t\t})\r\n\r\n\t\t// if this item has parent, disable all items ecept items in the same branch\r\n\t\tconst parent = dataItem.get(\"parent\");\r\n\t\tif (parent) {\r\n\t\t\t$array.each(this.dataItems, (item) => {\r\n\t\t\t\tif (item.get(\"parent\") !== parent) {\r\n\t\t\t\t\t$array.move(itemsToDisable, item);\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\t// disable all columns of the same depth which are connected to start bullet data item\r\n\t\tconst id = dataItem.get(\"id\")!;\r\n\t\tconst checkIfConnected = (id: string) => {\r\n\t\t\t$array.each(this.dataItems, (item) => {\r\n\t\t\t\tconst links = item.get(\"links\");\r\n\t\t\t\tif (links && links[id]) {\r\n\t\t\t\t\titemsToDisable.push(item);\r\n\t\t\t\t\tcheckIfConnected(item.get(\"id\")!);\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\t\tcheckIfConnected(id);\r\n\r\n\t\t$array.each(itemsToDisable, (item) => {\r\n\t\t\tconst column = item.get(\"graphics\") as RoundedRectangle;\r\n\t\t\tif (column) {\r\n\t\t\t\tcolumn.states.applyAnimate(\"disabled\");\r\n\t\t\t}\r\n\t\t\tconst container = item.get(\"container\") as Container;\r\n\t\t\tif (container) {\r\n\t\t\t\tcontainer.states.applyAnimate(\"disabled\");\r\n\t\t\t}\r\n\r\n\t\t\tconst zeroRectangle = item.get(\"zeroRectangle\") as RoundedRectangle;\r\n\t\t\tif (zeroRectangle) {\r\n\t\t\t\tzeroRectangle.states.applyAnimate(\"disabled\");\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\tprotected _updateConnector(point: IPoint) {\r\n\r\n\t\tlet startPoint = this._startBullet?.toGlobal({ x: 0, y: 0 });\r\n\t\tif (startPoint) {\r\n\r\n\t\t\tstartPoint = this.toLocal(startPoint);\r\n\r\n\t\t\tthis.connectorLine.setAll({\r\n\t\t\t\tsegments: [[[{ x: startPoint.x, y: startPoint.y }, { x: point.x, y: point.y }]]]\r\n\t\t\t});\r\n\r\n\t\t\tthis.connectorArrow.setAll({\r\n\t\t\t\tx: point.x,\r\n\t\t\t\ty: point.y,\r\n\t\t\t\trotation: $math.getAngle(startPoint, point) + 90,\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _endConnector() {\r\n\r\n\t\tlet startPoint = this._startBullet?.toGlobal({ x: 0, y: 0 });\r\n\t\tif (startPoint) {\r\n\t\t\tstartPoint = this.toLocal(startPoint);\r\n\r\n\t\t\tthis.connectorLine.hide();\r\n\t\t\tthis.connectorArrow.hide();\r\n\r\n\t\t\t$array.each(this.dataItems, (item) => {\r\n\t\t\t\tconst column = item.get(\"graphics\") as RoundedRectangle;\r\n\t\t\t\tif (column && column.isVisible()) {\r\n\t\t\t\t\tcolumn.states.applyAnimate(\"default\");\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst container = item.get(\"container\") as Container;\r\n\t\t\t\tif (container && container.isVisible()) {\r\n\t\t\t\t\tcontainer.states.applyAnimate(\"default\");\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst zeroRectangle = item.get(\"zeroRectangle\") as RoundedRectangle;\r\n\t\t\t\tif (zeroRectangle && zeroRectangle.isVisible()) {\r\n\t\t\t\t\tzeroRectangle.states.applyAnimate(\"default\");\r\n\t\t\t\t}\r\n\t\t\t})\r\n\r\n\t\t\tlet dataItem = this._hoveredDataItem as DataItem<IGanttSeriesDataItem>;\r\n\r\n\t\t\tif (dataItem && dataItem !== this._startBullet?.dataItem) {\r\n\t\t\t\tconst id = dataItem.get(\"id\");\r\n\r\n\t\t\t\tif (id) {\r\n\t\t\t\t\tconst startDataItem = this._startBullet?.dataItem as DataItem<IGanttSeriesDataItem>;\r\n\r\n\t\t\t\t\tif (startDataItem) {\r\n\t\t\t\t\t\tconst linkTo: Array<string> = startDataItem.get(\"linkTo\", []);\r\n\t\t\t\t\t\tif ($array.indexOf(linkTo, id) === -1) {\r\n\t\t\t\t\t\t\tlinkTo.push(id);\r\n\t\t\t\t\t\t\tstartDataItem.set(\"linkTo\", linkTo);\r\n\t\t\t\t\t\t\tthis.markDirtyValues();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis._updateLinks();\r\n\t\t}\r\n\r\n\t\tthis.endBullets.each((bullet) => {\r\n\t\t\tbullet.show();\r\n\t\t})\r\n\r\n\t\tthis.startBullets.each((bullet) => {\r\n\t\t\tbullet.hide();\r\n\t\t})\r\n\r\n\t\tthis.chart?.set(\"panX\", this._xPan);\r\n\t\tthis.chart?.set(\"panY\", this._yPan);\r\n\t}\r\n\r\n\t/**\r\n\t * Fixes values of a data item, adjusting start, end, or duration as needed.\r\n\t */\r\n\tprotected _fixValues(dataItem: DataItem<IGanttSeriesDataItem>, keep: \"start\" | \"end\" | \"duration\") {\r\n\t\tlet valueX = dataItem.get(\"valueX\");\r\n\t\tlet openValueX = dataItem.get(\"openValueX\");\r\n\t\tlet duration = dataItem.get(\"duration\", 0);\r\n\r\n\t\tif ($type.isNumber(valueX) && $type.isNumber(openValueX)) {\r\n\t\t\tif (keep === \"start\") {\r\n\t\t\t\tvalueX = this.roundValue(valueX);\r\n\t\t\t\tduration = this.getDataItemDuration(dataItem);\r\n\t\t\t\tdataItem.set(\"duration\", duration);\r\n\t\t\t}\r\n\t\t\telse if (keep === \"end\") {\r\n\t\t\t\topenValueX = this.roundValue(openValueX, true);\r\n\t\t\t\tduration = this.getDataItemDuration(dataItem);\r\n\t\t\t\tdataItem.set(\"duration\", duration);\r\n\t\t\t}\r\n\t\t\telse if (keep === \"duration\") {\r\n\t\t\t\topenValueX = this.roundValue(openValueX, true);\r\n\t\t\t\tvalueX = openValueX + duration * this.getUnitDuration();\r\n\t\t\t}\r\n\r\n\t\t\topenValueX = this.getOpenValue(openValueX);\r\n\t\t\tvalueX = this.getEndValue(openValueX, duration);\r\n\r\n\t\t\tconst animationDuration = this.get(\"interpolationDuration\", 0);\r\n\t\t\tconst animationEasing = this.get(\"interpolationEasing\");\r\n\t\t\tconst index = this.dataItems.indexOf(dataItem);\r\n\r\n\t\t\tif (index >= this.startIndex() && index <= this.endIndex()) {\r\n\t\t\t\tdataItem.animate({ key: \"openValueXWorking\", to: openValueX, duration: animationDuration, easing: animationEasing });\r\n\t\t\t\tdataItem.animate({ key: \"valueXWorking\", to: valueX, duration: animationDuration, easing: animationEasing });\r\n\t\t\t\t// animate not working also\r\n\t\t\t\tdataItem.animate({ key: \"openValueX\", to: openValueX, duration: animationDuration, easing: animationEasing });\r\n\t\t\t\tdataItem.animate({ key: \"valueX\", to: valueX, duration: animationDuration, easing: animationEasing });\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tdataItem.set(\"openValueXWorking\", openValueX);\r\n\t\t\t\tdataItem.set(\"valueXWorking\", valueX);\r\n\t\t\t\tdataItem.set(\"openValueX\", openValueX);\r\n\t\t\t\tdataItem.set(\"valueX\", valueX);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _toggleColumn(dataItem: DataItem<this[\"_dataItemSettings\"]>, visible: boolean) {\r\n\t\tsuper._toggleColumn(dataItem, visible);\r\n\t\tconst container = dataItem.get(\"container\");\r\n\t\tif (container) {\r\n\t\t\tcontainer.setPrivate(\"visible\", visible);\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _afterDataChange(): void {\r\n\t\tconst yAxis = this.get(\"yAxis\") as GanttCategoryAxis<GanttCategoryAxisRenderer>;\r\n\t\t$array.each(this.dataItems, (dataItem) => {\r\n\t\t\tthis._fixValues(dataItem, \"duration\");\r\n\t\t\tconst category = dataItem.get(\"categoryY\");\r\n\r\n\t\t\tif (category) {\r\n\t\t\t\tconst categoryAxisDataItem = yAxis.dataItems.find((item) => item.get(\"category\") === category);\r\n\r\n\t\t\t\tdataItem.set(\"categoryAxisDataItem\", categoryAxisDataItem);\r\n\t\t\t\tif (categoryAxisDataItem) {\r\n\t\t\t\t\tcategoryAxisDataItem.on(\"duration\", () => {\r\n\t\t\t\t\t\tconst duration = categoryAxisDataItem.get(\"duration\");\r\n\t\t\t\t\t\tconst children = dataItem.get(\"children\");\r\n\t\t\t\t\t\tif (!children || children.length === 0) {\r\n\t\t\t\t\t\t\tif (duration !== undefined) {\r\n\t\t\t\t\t\t\t\tdataItem.set(\"duration\", duration);\r\n\t\t\t\t\t\t\t\tthis._fixValues(dataItem, \"duration\");\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\tthis.get(\"yAxis\").markDirtyTree();\r\n\t\tsuper._afterDataChange();\r\n\t}\r\n\r\n\tprotected _updateLinks() {\r\n\r\n\t\tconst xAxis = this.get(\"xAxis\") as ValueAxis<AxisRendererX>;\r\n\t\tconst yAxis = this.get(\"yAxis\") as GanttCategoryAxis<GanttCategoryAxisRenderer>;\r\n\t\tconst yRenderer = yAxis.get(\"renderer\") as GanttCategoryAxisRenderer;\r\n\t\tlet endRadius = 0;\r\n\t\tconst endBullet = this.endBullets.getIndex(0);\r\n\t\tif (endBullet && endBullet.isVisible()) {\r\n\t\t\tendRadius = endBullet.get(\"radius\", 0);\r\n\t\t}\r\n\r\n\t\tlet columnHeight: number | Percent = percent(60);\r\n\t\tlet minHeight = 0;\r\n\t\tlet maxHeight = Infinity;\r\n\t\tlet column = this.columns.getIndex(0);\r\n\t\tlet r = 1;\r\n\t\tif (column) {\r\n\t\t\tcolumnHeight = column.get(\"height\", 0);\r\n\t\t\tconst cos = $math.cos(45);\r\n\t\t\tif (columnHeight instanceof Percent) {\r\n\t\t\t\tr = columnHeight.value * cos * cos;\r\n\t\t\t}\r\n\t\t\tminHeight = column.get(\"minHeight\", 0) * cos * cos;\r\n\t\t\tmaxHeight = column.get(\"maxHeight\", Infinity) * cos * cos;\r\n\t\t}\r\n\r\n\t\t$array.each(this.dataItems, (dataItem) => {\r\n\t\t\tconst linkTo = dataItem.get(\"linkTo\");\r\n\r\n\t\t\tconst categoryDataItem = dataItem.get(\"categoryAxisDataItem\") as DataItem<IGanttCategoryAxisDataItem>;\r\n\r\n\r\n\t\t\tif (linkTo) {\r\n\t\t\t\tlet links = dataItem.get(\"links\");\r\n\t\t\t\tconst linkHorizontalOffset = this.get(\"linkHorizontalOffset\", 25);\r\n\r\n\t\t\t\t$array.each(linkTo, (dataItemId) => {\r\n\t\t\t\t\tif (!links) {\r\n\t\t\t\t\t\tlinks = dataItem.set(\"links\", {});\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tlet link = links[dataItemId];\r\n\r\n\t\t\t\t\tif (!link) {\r\n\t\t\t\t\t\tlink = this.links.make();\r\n\t\t\t\t\t\tlinks[dataItemId] = link;\r\n\t\t\t\t\t\tthis.links.push(link);\r\n\t\t\t\t\t\tthis.linksContainer.children.push(link);\r\n\t\t\t\t\t\tlink.appear();\r\n\r\n\t\t\t\t\t\tlink.events.on(\"click\", () => {\r\n\t\t\t\t\t\t\tif (link.get(\"active\")) {\r\n\t\t\t\t\t\t\t\tthis.links.removeValue(link);\r\n\t\t\t\t\t\t\t\tconst links = dataItem.get(\"links\");\r\n\t\t\t\t\t\t\t\tif (links) {\r\n\t\t\t\t\t\t\t\t\tdelete links[dataItemId];\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t$array.remove(linkTo, dataItemId);\r\n\t\t\t\t\t\t\t\tthis.markDirtyValues();\r\n\t\t\t\t\t\t\t\tlink.dispose();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\r\n\t\t\t\t\t\tlink.events.on(\"globalpointerup\", () => {\r\n\t\t\t\t\t\t\tif (link.get(\"active\") && !link.isHover()) {\r\n\t\t\t\t\t\t\t\tlink.set(\"active\", false);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tconst points: Array<IPoint> = [];\r\n\r\n\t\t\t\t\tconst positionX = xAxis.valueToPosition(dataItem.get(\"valueX\", 0));\r\n\t\t\t\t\tconst positionY = yAxis.categoryToPosition(dataItem.get(\"categoryY\")!);\r\n\r\n\t\t\t\t\tconst point = this.getPoint(positionX, positionY);\r\n\r\n\t\t\t\t\tlet firstPoint = { x: point.x + endRadius, y: point.y };\r\n\r\n\t\t\t\t\tif (dataItem.get(\"duration\", 0) === 0) {\r\n\t\t\t\t\t\tlet y0 = yAxis.indexToPosition(categoryDataItem.get(\"index\", 0), 0);\r\n\t\t\t\t\t\tlet y1 = yAxis.indexToPosition(categoryDataItem.get(\"index\", 0), 1);\r\n\t\t\t\t\t\ty0 = yRenderer.positionToCoordinate(y0);\r\n\t\t\t\t\t\ty1 = yRenderer.positionToCoordinate(y1);\r\n\r\n\t\t\t\t\t\tlet h = (y1 - y0) * r;\r\n\t\t\t\t\t\th = $math.fitToRange(h, minHeight, maxHeight);\r\n\r\n\t\t\t\t\t\tfirstPoint.x += h - endRadius;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tpoints.push(firstPoint);\r\n\t\t\t\t\tpoints.push({ x: firstPoint.x + linkHorizontalOffset, y: firstPoint.y });\r\n\r\n\t\t\t\t\tconst targetDataItem = this.getDataItemById(dataItemId) as DataItem<IGanttSeriesDataItem>;\r\n\r\n\t\t\t\t\tif (targetDataItem) {\r\n\r\n\t\t\t\t\t\tconst positionX = xAxis.valueToPosition(targetDataItem.get(\"openValueX\", 0));\r\n\t\t\t\t\t\tconst positionY = yAxis.categoryToPosition(targetDataItem.get(\"categoryY\")!);\r\n\r\n\t\t\t\t\t\tconst point = this.getPoint(positionX, positionY);\r\n\r\n\t\t\t\t\t\tlet x = point.x;\r\n\t\t\t\t\t\tlet y = point.y;\r\n\r\n\t\t\t\t\t\tlet lastPoint = { x: x, y: y };\r\n\r\n\t\t\t\t\t\tif (targetDataItem.get(\"duration\", 0) === 0) {\r\n\t\t\t\t\t\t\tlet targetCategoryDataItem = targetDataItem.get(\"categoryAxisDataItem\") as DataItem<IGanttCategoryAxisDataItem>;\r\n\t\t\t\t\t\t\tif (targetCategoryDataItem) {\r\n\t\t\t\t\t\t\t\tlet y0 = yAxis.indexToPosition(targetCategoryDataItem.get(\"index\", 0), 0);\r\n\t\t\t\t\t\t\t\tlet y1 = yAxis.indexToPosition(targetCategoryDataItem.get(\"index\", 0), 1);\r\n\t\t\t\t\t\t\t\ty0 = yRenderer.positionToCoordinate(y0);\r\n\t\t\t\t\t\t\t\ty1 = yRenderer.positionToCoordinate(y1);\r\n\r\n\t\t\t\t\t\t\t\tlet h = (y1 - y0) * r;\r\n\r\n\r\n\r\n\t\t\t\t\t\t\t\th = $math.fitToRange(h, minHeight, maxHeight);\r\n\t\t\t\t\t\t\t\tlastPoint.x -= h;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (lastPoint.x - linkHorizontalOffset < firstPoint.x + linkHorizontalOffset) {\r\n\t\t\t\t\t\t\tconst category = dataItem.get(\"categoryY\");\r\n\t\t\t\t\t\t\tconst yAxis = this.get(\"yAxis\") as CategoryAxis<AxisRendererY>;\r\n\r\n\t\t\t\t\t\t\tif (category) {\r\n\t\t\t\t\t\t\t\tlet index = yAxis.categoryToIndex(category);\r\n\r\n\t\t\t\t\t\t\t\tconst position0 = yAxis.indexToPosition(index);\r\n\t\t\t\t\t\t\t\tconst position1 = yAxis.indexToPosition(index, 1);\r\n\r\n\t\t\t\t\t\t\t\tif (yAxis && category) {\r\n\r\n\t\t\t\t\t\t\t\t\tlet sign = -1;\r\n\t\t\t\t\t\t\t\t\tif (lastPoint.y > firstPoint.y) {\r\n\t\t\t\t\t\t\t\t\t\tsign = 1;\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\tlet y = yAxis.get(\"renderer\").positionToCoordinate(yAxis.categoryToPosition(category) + (position1 - position0) * sign);\r\n\r\n\t\t\t\t\t\t\t\t\tpoints.push({ x: firstPoint.x + linkHorizontalOffset, y: y });\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tpoints.push({ x: lastPoint.x - linkHorizontalOffset, y: lastPoint.y });\r\n\t\t\t\t\t\tpoints.push(lastPoint);\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlink.set(\"points\", points);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\t/**\r\n\t * Updates series graphics.\r\n\t */\r\n\tprotected _updateSeriesGraphics(dataItem: DataItem<this[\"_dataItemSettings\"]>, graphics: Graphics, l: number, r: number, t: number, b: number, _fitW: boolean, fitH: boolean) {\r\n\t\tsuper._updateSeriesGraphics(dataItem, graphics, l, r, t, b, false, fitH);\r\n\t\tlet x = dataItem.get(\"left\", 0);\r\n\t\tlet y = dataItem.get(\"top\", 0);\r\n\t\tlet width = dataItem.get(\"right\", 0) - x;\r\n\t\tlet height = dataItem.get(\"bottom\", 0) - y;\r\n\r\n\t\t// Update the container position and size\r\n\t\tconst container = dataItem.get(\"container\");\r\n\t\tconst mask = dataItem.get(\"mask\");\r\n\t\tconst categoryAxisDataItem = dataItem.get(\"categoryAxisDataItem\") as DataItem<IGanttCategoryAxisDataItem>;\r\n\t\tconst fill = categoryAxisDataItem ? categoryAxisDataItem.get(\"customColor\", categoryAxisDataItem.get(\"color\")) : undefined;\r\n\r\n\t\tdataItem.setRaw(\"name\", (categoryAxisDataItem.dataContext as any).name);\r\n\r\n\t\tconst startBullet = dataItem.get(\"startBullet\");\r\n\t\tstartBullet?.setAll({\r\n\t\t\tx: 0,\r\n\t\t\tstroke: fill\r\n\t\t});\r\n\r\n\t\tconst endBullet = dataItem.get(\"endBullet\");\r\n\t\tendBullet?.setAll({\r\n\t\t\tstroke: fill,\r\n\t\t\tx: width\r\n\t\t});\r\n\r\n\t\tif (container) {\r\n\t\t\tcontainer.setAll({\r\n\t\t\t\tx: x,\r\n\t\t\t\ty: y,\r\n\t\t\t\twidth: width,\r\n\t\t\t\theight: height\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tconst maskedContainer = dataItem.get(\"maskedContainer\");\r\n\t\tif (maskedContainer) {\r\n\t\t\tmaskedContainer.setAll({\r\n\t\t\t\tx: 0,\r\n\t\t\t\ty: 0,\r\n\t\t\t\twidth: width,\r\n\t\t\t\theight: height\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tif (mask) {\r\n\t\t\tmask.setAll({\r\n\t\t\t\tx: 0,\r\n\t\t\t\ty: 0,\r\n\t\t\t\twidth: width,\r\n\t\t\t\theight: height\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tconst startGrip = dataItem.get(\"startGrip\");\r\n\t\tif (startGrip) {\r\n\t\t\tstartGrip.setAll({\r\n\t\t\t\theight: height\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\tconst endGrip = dataItem.get(\"endGrip\");\r\n\t\tif (endGrip) {\r\n\t\t\tendGrip.setAll({\r\n\t\t\t\tx: width,\r\n\t\t\t\theight: height\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\t// update progress rectangle\r\n\t\tconst progressRectangle = dataItem.get(\"progressRectangle\");\r\n\t\tif (progressRectangle) {\r\n\t\t\tconst progress = dataItem.get(\"progress\", 0);\r\n\t\t\tconst progressWidth = width - width * progress;\r\n\r\n\t\t\tprogressRectangle.setAll({\r\n\t\t\t\tx: width - progressWidth,\r\n\t\t\t\twidth: progressWidth,\r\n\t\t\t\theight: height\r\n\t\t\t});\r\n\r\n\t\t\tconst progressGrip = dataItem.get(\"progressGrip\");\r\n\t\t\tif (progressGrip) {\r\n\t\t\t\tprogressGrip.setAll({\r\n\t\t\t\t\tx: width - progressWidth\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tconst zeroRectangle = dataItem.get(\"zeroRectangle\");\r\n\t\t\tif (zeroRectangle) {\r\n\t\t\t\tzeroRectangle.markDirtyKey(\"fillPattern\")\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\r\n\t/**\r\n\t * Hides series's data item.\r\n\t * \r\n\t * @param   dataItem  Data item\r\n\t * @param   duration  Animation duration in milliseconds\r\n\t * @return            Promise\r\n\t */\r\n\tpublic async hideDataItem(dataItem: DataItem<this[\"_dataItemSettings\"]>, duration?: number): Promise<void> {\r\n\t\tconst promises = [super.hideDataItem(dataItem, duration)];\r\n\t\tconst container = dataItem.get(\"container\");\r\n\t\tif (container) {\r\n\t\t\tpromises.push(container.hide(duration));\r\n\t\t}\r\n\r\n\t\t// hide all links\r\n\t\tconst links = dataItem.get(\"links\", {});\r\n\t\tif (links) {\r\n\t\t\t$object.each(links, (_key, link: Link) => {\r\n\t\t\t\tlink.hide(duration);\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\t// hide all links to this data item\r\n\t\tconst id = dataItem.get(\"id\")!;\r\n\t\tif (id) {\r\n\t\t\t$array.each(this.dataItems, (item) => {\r\n\t\t\t\tconst linkTo = item.get(\"linkTo\");\r\n\t\t\t\tif (linkTo && linkTo.includes(id)) {\r\n\t\t\t\t\tconst links: { [index: string]: Link } | undefined = item.get(\"links\");\r\n\t\t\t\t\tif (links && links[id]) {\r\n\t\t\t\t\t\tconst link = links[id];\r\n\t\t\t\t\t\tlink.hide(duration);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\tawait Promise.all(promises);\r\n\t}\r\n\r\n\t/**\r\n\t * Shows series's data item.\r\n\t * \r\n\t * @param   dataItem  Data item\r\n\t * @param   duration  Animation duration in milliseconds\r\n\t * @return            Promise\r\n\t */\r\n\tpublic async showDataItem(dataItem: DataItem<this[\"_dataItemSettings\"]>, duration?: number): Promise<void> {\r\n\t\tconst promises = [super.showDataItem(dataItem, duration)];\r\n\t\tconst container = dataItem.get(\"container\");\r\n\t\tif (container) {\r\n\t\t\tpromises.push(container.show(duration));\r\n\t\t}\r\n\r\n\t\t// show all links\r\n\t\tconst links = dataItem.get(\"links\", {});\r\n\t\tif (links) {\r\n\t\t\t$object.each(links, (_key, link: Link) => {\r\n\t\t\t\tlink.show(duration);\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\t// show all links to this data item\r\n\t\tconst id = dataItem.get(\"id\")!;\r\n\t\tif (id) {\r\n\t\t\t$array.each(this.dataItems, (item) => {\r\n\t\t\t\tconst linkTo = item.get(\"linkTo\");\r\n\t\t\t\tif (linkTo && linkTo.includes(id)) {\r\n\t\t\t\t\tconst links: { [index: string]: Link } | undefined = item.get(\"links\");\r\n\t\t\t\t\tif (links && links[id]) {\r\n\t\t\t\t\t\tconst link = links[id];\r\n\t\t\t\t\t\tlink.show(duration);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\tawait Promise.all(promises);\r\n\t}\r\n\r\n\t/**\r\n\t * Disposes a data item and removes it from the series.\r\n\t *\r\n\t * @param dataItem  Data item\r\n\t */\r\n\tpublic disposeDataItem(dataItem: DataItem<this[\"_dataItemSettings\"]>) {\r\n\t\tsuper.disposeDataItem(dataItem);\r\n\r\n\t\tconst container = dataItem.get(\"container\");\r\n\t\tif (container) {\r\n\t\t\tthis.containers.removeValue(container);\r\n\t\t\tcontainer.dispose();\r\n\t\t}\r\n\r\n\t\tconst startBullet = dataItem.get(\"startBullet\");\r\n\t\tif (startBullet) {\r\n\t\t\tthis.startBullets.removeValue(startBullet);\r\n\t\t\tstartBullet.dispose();\r\n\t\t}\r\n\r\n\t\tconst endBullet = dataItem.get(\"endBullet\");\r\n\t\tif (endBullet) {\r\n\t\t\tthis.endBullets.removeValue(endBullet);\r\n\t\t\tendBullet.dispose();\r\n\t\t}\r\n\t\tconst startGrip = dataItem.get(\"startGrip\");\r\n\t\tif (startGrip) {\r\n\t\t\tthis.startGrips.removeValue(startGrip);\r\n\t\t\tstartGrip.dispose();\r\n\t\t}\r\n\t\tconst endGrip = dataItem.get(\"endGrip\");\r\n\t\tif (endGrip) {\r\n\t\t\tthis.endGrips.removeValue(endGrip);\r\n\t\t\tendGrip.dispose();\r\n\t\t}\r\n\t\tconst progressRectangle = dataItem.get(\"progressRectangle\");\r\n\t\tif (progressRectangle) {\r\n\t\t\tthis.progressRectangles.removeValue(progressRectangle);\r\n\t\t\tprogressRectangle.dispose();\r\n\t\t}\r\n\t\tconst zeroRectangle = dataItem.get(\"zeroRectangle\");\r\n\t\tif (zeroRectangle) {\r\n\t\t\tthis.zeroRectangles.removeValue(zeroRectangle);\r\n\t\t\tzeroRectangle.dispose();\r\n\t\t}\r\n\t\tconst progressGrip = dataItem.get(\"progressGrip\");\r\n\t\tif (progressGrip) {\r\n\t\t\tthis.progressGrips.removeValue(progressGrip);\r\n\t\t\tprogressGrip.dispose();\r\n\t\t}\r\n\r\n\t\tthis.disposeLinks(dataItem);\r\n\t}\r\n\r\n\t/**\r\n\t * Disposes all links of a data item and removes them from the series.\r\n\t *\r\n\t * @param dataItem  Data item\r\n\t */\r\n\tpublic disposeLinks(dataItem: DataItem<IGanttSeriesDataItem>) {\r\n\t\tconst links = dataItem.get(\"links\", {});\r\n\t\tif (links) {\r\n\t\t\t$object.each(links, (key, link: Link) => {\r\n\t\t\t\tlink.dispose();\r\n\t\t\t\tdelete links[key];\r\n\t\t\t});\r\n\t\t\tdataItem.set(\"linkTo\", []);\r\n\t\t}\r\n\r\n\t\tconst id = dataItem.get(\"id\", \"\");\r\n\r\n\t\tif (id) {\r\n\t\t\t$array.each(this.dataItems, (item) => {\r\n\t\t\t\tconst linkTo = item.get(\"linkTo\");\r\n\t\t\t\tif (linkTo && linkTo.includes(id)) {\r\n\t\t\t\t\t$array.remove(linkTo, id);\r\n\r\n\t\t\t\t\tconst links: { [index: string]: Link } | undefined = item.get(\"links\");\r\n\t\t\t\t\tif (links && links[id]) {\r\n\t\t\t\t\t\tconst link = links[id];\r\n\t\t\t\t\t\tthis.links.removeValue(link);\r\n\t\t\t\t\t\tdelete links[id];\r\n\t\t\t\t\t\tlink.dispose();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Returns the duration of a data item in units.\r\n\t *\r\n\t * @param dataItem  Data item\r\n\t * @return Duration in units\r\n\t */\r\n\tpublic getDataItemDuration(dataItem: DataItem<IGanttSeriesDataItem>): number {\r\n\t\tconst openValueX = dataItem.get(\"openValueX\", 0);\r\n\t\tlet valueX = dataItem.get(\"valueX\", 0);\r\n\r\n\t\t// if valueX is within weekend or holiday, round it to the end of a previous work day\r\n\t\treturn Math.round((valueX - openValueX) / this.getUnitDuration()) - this.getHolidayCount(openValueX, valueX);\r\n\t}\r\n\r\n\t/**\r\n\t * Returns the depth of a data item in the hierarchy.\r\n\t *\r\n\t * @param dataItem  Data item\r\n\t * @return Depth level\r\n\t */\r\n\tpublic getDepth(dataItem: DataItem<IGanttSeriesDataItem>): number {\r\n\t\tlet depth = 0;\r\n\t\tlet parent = dataItem.get(\"parent\");\r\n\t\twhile (parent) {\r\n\t\t\tdepth++;\r\n\t\t\tparent = parent.get(\"parent\");\r\n\t\t}\r\n\t\treturn depth;\r\n\t}\r\n\r\n\t/**\r\n\t * Returns the end value of a data item, adjusting for holidays and weekends.\r\n\t *\r\n\t * @param openValue  Open value in milliseconds\r\n\t * @param duration   Duration in units\r\n\t * @return           Adjusted end value in milliseconds\r\n\t */\r\n\tpublic getEndValue(openValue: number, duration: number): number {\r\n\t\tlet adjustedDuration = duration;\r\n\r\n\t\tconst unitDuration = this.getUnitDuration();\r\n\r\n\t\tif (this.gantt.get(\"excludeWeekends\", true)) {\r\n\t\t\tfor (let i = 0; i < adjustedDuration; i++) {\r\n\t\t\t\tif (this.isHoliday(openValue + i * unitDuration)) {\r\n\t\t\t\t\tadjustedDuration++;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn openValue + adjustedDuration * unitDuration;\r\n\t}\r\n\r\n\t/**\r\n\t * Returns the open value of a data item, adjusting for holidays and weekends.\r\n\t *\r\n\t * @param openValue  Open value in milliseconds\r\n\t * @return           Adjusted open value\r\n\t */\r\n\tpublic getOpenValue(openValue: number): number {\r\n\t\tif (this.gantt.get(\"excludeWeekends\", true)) {\r\n\t\t\twhile (this.isHoliday(openValue)) {\r\n\t\t\t\topenValue += this.getUnitDuration();\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn openValue;\r\n\t}\r\n\r\n\t/**\r\n\t * Returns the duration of a unit in milliseconds.\r\n\t *\r\n\t * @return Duration in milliseconds\r\n\t */\r\n\tpublic getUnitDuration(): number {\r\n\t\treturn $time.getDuration(this.gantt.get(\"durationUnit\", \"day\"));\r\n\t}\r\n\r\n\t/**\r\n\t * Returns the count of holidays between two dates.\r\n\t *\r\n\t * @param start  Start date in milliseconds\r\n\t * @param end    End date in milliseconds\r\n\t * @return       Count of holidays\r\n\t */\r\n\tpublic getHolidayCount(start: number, end: number): number {\r\n\t\tlet count = 0;\r\n\t\tlet holiday = true;\r\n\t\tfor (let i = end; i >= start; i -= this.getUnitDuration()) {\r\n\t\t\tif (!this.isHoliday(i)) {\r\n\t\t\t\tholiday = false;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tif (!holiday && this.isHoliday(i)) {\r\n\t\t\t\t\tcount++;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn count;\r\n\t}\r\n\r\n\t/**\r\n\t\t * Checks if a given date is a holiday or weekend.\r\n\t\t *\r\n\t\t * @param value  Date value in milliseconds\r\n\t\t * @return       `true` if the date is a holiday or weekend, otherwise `false`\r\n\t\t */\r\n\tpublic isHoliday(value: number): boolean {\r\n\t\tif (this.gantt.get(\"excludeWeekends\", true)) {\r\n\t\t\tconst holidays = this.gantt.get(\"holidays\", []);\r\n\t\t\tconst weekends = this.gantt.get(\"weekends\", [0, 6]);\r\n\r\n\t\t\tconst date = new Date(value);\r\n\r\n\t\t\tif (weekends.includes(date.getDay())) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\r\n\t\t\tif (holidays && holidays.length > 0) {\r\n\t\t\t\tlet isHoliday = false;\r\n\t\t\t\t$array.eachContinue(holidays, (holiday) => {\r\n\t\t\t\t\tif (holiday instanceof Date) {\r\n\t\t\t\t\t\tconst start = holiday.getTime()\r\n\t\t\t\t\t\tconst end = holiday.getTime() + $time.getDuration(\"day\");\r\n\t\t\t\t\t\tif (value >= start && value < end) {\r\n\t\t\t\t\t\t\tisHoliday = true;\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t})\r\n\t\t\t\treturn isHoliday;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n}\r\n","import type { AxisRenderer } from \"../xy/axes/AxisRenderer\";\r\nimport type { GanttCategoryAxisRenderer } from \"./GanttCategoryAxisRenderer\";\r\nimport type { Container } from \"../../core/render/Container\";\r\nimport type { ProgressPie } from \"../../core/render/ProgressPie\";\r\nimport type { Gantt } from \"./Gantt\";\r\nimport type { AxisTick } from \"../xy/axes/AxisTick\";\r\nimport type { NumericStepper } from \"../../core/render/NumericStepper\";\r\nimport type { IGanttSeriesDataItem } from \"./GanttSeries\";\r\nimport type { Animation } from \"../../core/util/Entity\";\r\n\r\nimport { Rectangle } from \"../../core/render/Rectangle\";\r\nimport { CategoryAxis, ICategoryAxisSettings, ICategoryAxisPrivate, ICategoryAxisDataItem, ICategoryAxisEvents } from \"../xy/axes/CategoryAxis\";\r\nimport { Button, color, Color, DataItem, Graphics, IDisposer } from \"../../..\";\r\n\r\nimport * as $array from \"../../core/util/Array\";\r\nimport * as $type from \"../../core/util/Type\";\r\n\r\nexport interface IGanttCategoryAxisSettings<R extends AxisRenderer> extends ICategoryAxisSettings<R> {\r\n\r\n\t/**\r\n\t * Currently selected category data item, if any.\r\n\t */\r\n\tselectedDataItem?: DataItem<IGanttCategoryAxisDataItem>;\r\n\r\n\t/**\r\n\t * A field in data that holds parent id.\r\n\t * \r\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/gantt/#Category_data} for more info\r\n\t * @default \"parentId\"\r\n\t */\r\n\tparentIdField?: string;\r\n\r\n\t/**\r\n\t * A field in data that holds status whether the category is collapsed.\r\n\t * \r\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/gantt/#Category_data} for more info\r\n\t * @default \"collapsed\"\r\n\t */\r\n\tcollapsedField?: string;\r\n\r\n\t/**\r\n\t * Size of child categories relative to the top-level cell height. (`0` - `1`)\r\n\t *\r\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/gantt/#Cell_height_for_child_categories} for more info\r\n\t * @default 0.8\r\n\t */\r\n\tchildCellSize?: number;\r\n\r\n\t/**\r\n\t * A shift in pixels to apply to child categories.\r\n\t *\r\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/gantt/#Cell_height_for_child_categories} for more info\r\n\t * @default 25\r\n\t */\r\n\tchildShift?: number;\r\n\r\n\t/**\r\n\t * A minimal height of the cell in pixels.\r\n\t *\r\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/gantt/#Cell_height} for more info\r\n\t * @default 70\r\n\t */\r\n\tminCellHeight?: number;\r\n\r\n\t/**\r\n\t * Field of a category name\r\n\t * @default \"name\"\r\n\t */\r\n\tnameField?: string;\r\n\r\n\t/**\r\n\t * Field of a category color\r\n\t * @default \"color\"\r\n\t */\r\n\tcolorField?: string;\r\n\r\n}\r\n\r\nexport interface IGanttCategoryAxisDataItem extends ICategoryAxisDataItem {\r\n\r\n\t/**\r\n\t * A container that holds all other elements of a axis label - label, controls, grip, etc.\r\n\t */\r\n\tcontainer?: Container;\r\n\r\n\t/**\r\n\t * A container that holds progress pie and duration stepper.\r\n\t */\r\n\tcontrolsContainer?: Container;\r\n\r\n\t/**\r\n\t * A grip for dragging the category.\r\n\t */\r\n\tgrip?: Rectangle;\r\n\r\n\t/**\r\n\t * A bullet to the left of a label (circle or triangle, if it has children)\r\n\t */\r\n\ttaskBullet?: Button;\r\n\r\n\t/**\r\n\t * A progress pie that shows progress of the task.\r\n\t */\r\n\tprogressPie?: ProgressPie;\r\n\r\n\t/**\r\n\t * Children of this category, if any.\r\n\t */\r\n\tchildren?: Array<DataItem<IGanttCategoryAxisDataItem>>;\r\n\r\n\t/**\r\n\t * Parent id of data item.\r\n\t */\r\n\tparentId?: string;\r\n\r\n\t/**\r\n\t * A reference to the parent category data item.\r\n\t */\r\n\tparent?: DataItem<IGanttCategoryAxisDataItem>;\r\n\r\n\t/**\r\n\t * Progress of the task, from `0` to `1`. If this item has children, this will be the average of all children's progress.\r\n\t */\r\n\tprogress?: number;\r\n\r\n\t/**\r\n\t * A stepper that allows to change task duration.\r\n\t */\r\n\tdurationStepper?: NumericStepper;\r\n\r\n\t/**\r\n\t * A flag indicating whether the category is collapsed.\r\n\t */\r\n\tcollapsed?: boolean;\r\n\r\n\t/**\r\n\t * Duration of the task (in days or other units, depending on `durationUnit` setting of a `Gantt`).\r\n\t */\r\n\tduration?: number;\r\n\r\n\t/**\r\n\t * Color of a task.\r\n\t */\r\n\tcolor?: Color\r\n\r\n\t/**\r\n\t * Custom color for the task, if any.\r\n\t */\r\n\tcustomColor?: Color;\r\n\r\n\t/**\r\n\t * Displayed name of a category.\r\n\t */\r\n\tname?: string;\r\n\r\n\t/**\r\n\t * @ignore\r\n\t */\r\n\tdeleting?: boolean;\r\n\r\n\t/**\r\n\t * A reference to the series data item.\r\n\t */\r\n\tseriesDataItem?: DataItem<IGanttSeriesDataItem>;\r\n}\r\n\r\n\r\nexport interface IGanttCategoryAxisPrivate extends ICategoryAxisPrivate { }\r\n\r\nexport interface IGanttCategoryAxisEvents extends ICategoryAxisEvents { }\r\n\r\n\r\n/**\r\n * A category axis that is used as a Y (vertical) axis for [[Gantt]] charts.\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/gantt/#Category_vertical_axis} for more info\r\n * @since 5.14.0\r\n * @important\r\n */\r\nexport class GanttCategoryAxis<R extends GanttCategoryAxisRenderer> extends CategoryAxis<R> {\r\n\tpublic static className: string = \"GanttCategoryAxis\";\r\n\tpublic static classNames: Array<string> = CategoryAxis.classNames.concat([GanttCategoryAxis.className]);\r\n\r\n\tdeclare public _settings: IGanttCategoryAxisSettings<R>;\r\n\tdeclare public _privateSettings: IGanttCategoryAxisPrivate;\r\n\tdeclare public _dataItemSettings: IGanttCategoryAxisDataItem;\r\n\tdeclare public _events: IGanttCategoryAxisEvents;\r\n\r\n\tprotected _downX: number | undefined;\r\n\tprotected _downW: number | undefined;\r\n\tprotected _xHideDP: IDisposer | undefined;\r\n\tprotected _insertAfter: DataItem<IGanttCategoryAxisDataItem> | undefined;\r\n\tprotected _makeChildOf: DataItem<IGanttCategoryAxisDataItem> | undefined;\r\n\tprotected _draggedItem: DataItem<IGanttCategoryAxisDataItem> | undefined;\r\n\tprotected _previousTick: AxisTick | undefined;\r\n\r\n\tprotected _delDp: IDisposer | undefined;\r\n\tprotected _firstDataItem!: DataItem<IGanttCategoryAxisDataItem>;\r\n\r\n\tprotected _updDP: IDisposer | undefined;\r\n\tprotected _dataChangeDp: IDisposer | undefined;\r\n\tprotected _treeDirty: boolean = false;\r\n\r\n\t/**\r\n\t * A reference to the parent [[Gantt]] chart.\r\n\t */\r\n\tpublic gantt?: Gantt;\r\n\r\n\t/**\r\n\t * A [[Button]] used for deleting categories.\r\n\t */\r\n\tpublic xButton: Button = this.children.push(Button.new(this._root, {\r\n\t\tthemeTags: [\"xbutton\"],\r\n\t\ticon: Graphics.new(this._root, {\r\n\t\t\tthemeTags: [\"icon\"]\r\n\t\t})\r\n\t}));\r\n\r\n\tprotected _afterNew() {\r\n\t\tthis.fields.push(\"parentId\", \"collapsed\", \"name\");\r\n\t\tsuper._afterNew();\r\n\r\n\t\tthis.events.on(\"wheel\", (event) => {\r\n\t\t\tthis.chart!.handleWheel(event);\r\n\t\t});\r\n\r\n\t\tthis.xButton.hide(0);\r\n\r\n\t\tconst renderer = this.get(\"renderer\");\r\n\t\tthis._firstDataItem = this.makeDataItem({ cellSize: 0.0001 });\r\n\t\tconst tick = renderer.makeTick(this._firstDataItem, []);\r\n\t\ttick.set(\"dy\", 0.5);\r\n\t\tconst grid = renderer.makeGrid(this._firstDataItem, []);\r\n\t\tgrid.set(\"dy\", 0.5);\r\n\r\n\t\tthis.labelsContainer.setAll({\r\n\t\t\tmaskContent: true\r\n\t\t});\r\n\r\n\t\tconst resizer = this.children.push(Rectangle.new(this._root, {\r\n\t\t\tthemeTags: [\"axisresizer\"]\r\n\t\t}))\r\n\r\n\t\tresizer.events.on(\"pointerdown\", (e) => {\r\n\t\t\tthis._downX = this.toLocal(e.point).x;\r\n\t\t\tthis._downW = this.width();\r\n\t\t})\r\n\r\n\t\tresizer.events.on(\"globalpointermove\", (e) => {\r\n\t\t\tif (this._downX !== undefined) {\r\n\t\t\t\tconst point = this.toLocal(e.point);\r\n\t\t\t\tconst dy = point.x - this._downX;\r\n\t\t\t\tif (this._downW !== undefined) {\r\n\t\t\t\t\tlet newWidth = this._downW + dy;\r\n\t\t\t\t\tnewWidth = Math.max(newWidth, this.get(\"minWidth\", 100));\r\n\t\t\t\t\tthis.labelsContainer.set(\"width\", newWidth);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\tresizer.events.on(\"globalpointerup\", () => {\r\n\t\t\tthis._downX = undefined;\r\n\t\t})\r\n\r\n\t\tconst containersTemplate = renderer.containers.template;\r\n\r\n\t\tcontainersTemplate.events.on(\"dragged\", (e) => {\r\n\t\t\tthis.xButton.hide(0);\r\n\t\t\t// get all columns from series of this category and move them together\r\n\t\t\tconst dataItem = e.target.dataItem as DataItem<IGanttCategoryAxisDataItem>;\r\n\t\t\tconst container = e.target as Container;\r\n\t\t\tif (dataItem) {\r\n\t\t\t\tconst deltaPosition = (e.target.y() - startY) / this.chart!.plotContainer.height() * (this.get(\"end\", 1) - this.get(\"start\", 0));\r\n\t\t\t\tdataItem.set(\"deltaPosition\", deltaPosition);\r\n\r\n\t\t\t\t// dragg all children together\r\n\t\t\t\tconst updateDeltaPositionRecursively = (dataItem: DataItem<IGanttCategoryAxisDataItem>, deltaPosition: number) => {\r\n\t\t\t\t\tconst children = dataItem.get(\"children\");\r\n\r\n\t\t\t\t\tif (children) {\r\n\t\t\t\t\t\t$array.each(children, (child) => {\r\n\t\t\t\t\t\t\tchild.set(\"deltaPosition\", deltaPosition);\r\n\t\t\t\t\t\t\tupdateDeltaPositionRecursively(child, deltaPosition);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\r\n\t\t\t\tupdateDeltaPositionRecursively(dataItem, deltaPosition);\r\n\r\n\t\t\t\tconst tick = dataItem.get(\"tick\")\r\n\t\t\t\tconst grid = dataItem.get(\"grid\");\r\n\t\t\t\tconst dy = Math.ceil(startY - container.y());\r\n\r\n\t\t\t\tif (tick) {\r\n\t\t\t\t\tconst children = dataItem.get(\"children\");\r\n\t\t\t\t\tif (!children || children.length == 0) {\r\n\t\t\t\t\t\ttick.set(\"dy\", dy);\r\n\r\n\t\t\t\t\t\tif (grid) {\r\n\t\t\t\t\t\t\tgrid.set(\"dy\", dy);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tconst y = container.y();\r\n\r\n\t\t\t\t\t// Check if y is close to other containers and apply hover state\r\n\t\t\t\t\tconst allContainers = renderer.containers;\r\n\r\n\t\t\t\t\tif (this._makeChildOf) {\r\n\t\t\t\t\t\tthis._makeChildOf.get(\"container\")?.get(\"background\")?.unhover();\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis._makeChildOf = undefined;\r\n\t\t\t\t\tfor (let i = 0; i < allContainers.length; i++) {\r\n\t\t\t\t\t\tconst otherContainer = allContainers.getIndex(i);\r\n\t\t\t\t\t\tif (otherContainer && otherContainer.isVisible() && otherContainer !== container) {\r\n\t\t\t\t\t\t\tconst otherDataItem = otherContainer.dataItem as DataItem<IGanttCategoryAxisDataItem>;\r\n\r\n\t\t\t\t\t\t\tif (otherDataItem.get(\"cellSize\", 0) > 0) {\r\n\t\t\t\t\t\t\t\t// Check if otherDataItem is already a child of the dragged item's container\r\n\t\t\t\t\t\t\t\tconst otherChildren = otherDataItem.get(\"children\");\r\n\t\t\t\t\t\t\t\tif (otherChildren) {\r\n\t\t\t\t\t\t\t\t\tif (otherChildren.indexOf(dataItem) !== -1) {\r\n\t\t\t\t\t\t\t\t\t\tcontinue; // Skip if the dragged item is already a child of the other item\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\tconst background = otherContainer.get(\"background\");\r\n\t\t\t\t\t\t\t\tif (background) {\r\n\t\t\t\t\t\t\t\t\tconst otherY = otherContainer.y();\r\n\t\t\t\t\t\t\t\t\tif (Math.abs((y + container.height() / 2) - (otherY + otherContainer.height() / 2)) < 5) {\r\n\t\t\t\t\t\t\t\t\t\tbackground.hover();\r\n\t\t\t\t\t\t\t\t\t\tthis._makeChildOf = otherDataItem;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\r\n\t\t\t\t\tif (!this._makeChildOf) {\r\n\t\t\t\t\t\tif (this._previousTick) {\r\n\t\t\t\t\t\t\tthis._previousTick.states.applyAnimate(\"default\");\r\n\t\t\t\t\t\t\tthis._previousTick = undefined;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tlet closestDataItem: DataItem<IGanttCategoryAxisDataItem> | undefined;\r\n\t\t\t\t\t\tlet closestDistance = Infinity;\r\n\t\t\t\t\t\t//find closest tick\r\n\t\t\t\t\t\tfor (let i = renderer.ticks.length; i >= 0; i--) {\r\n\t\t\t\t\t\t\tconst t = renderer.ticks.getIndex(i);\r\n\t\t\t\t\t\t\tif (t && tick.isVisible()) {\r\n\t\t\t\t\t\t\t\tconst dataItem = t.dataItem as DataItem<IGanttCategoryAxisDataItem>;\r\n\t\t\t\t\t\t\t\tif (dataItem) {\r\n\t\t\t\t\t\t\t\t\tconst index = dataItem.get(\"index\", 0);\r\n\r\n\t\t\t\t\t\t\t\t\tif (index >= this.startIndex() && index <= this.endIndex()) {\r\n\r\n\t\t\t\t\t\t\t\t\t\tif (dataItem.get(\"cellSize\", 0) == 0) {\r\n\t\t\t\t\t\t\t\t\t\t\tcontinue; // Skip if the other item is collapsed\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t// recursively check if dataItem is not a child of the dragged item\r\n\t\t\t\t\t\t\t\t\t\tlet isChild = false;\r\n\t\t\t\t\t\t\t\t\t\tlet parent = dataItem.get(\"parent\");\r\n\t\t\t\t\t\t\t\t\t\twhile (parent) {\r\n\t\t\t\t\t\t\t\t\t\t\tif (parent === dataItem) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tisChild = true;\r\n\t\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\tparent = parent.get(\"parent\");\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\tif (isChild) {\r\n\t\t\t\t\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\tconst distance = Math.abs(t.y() + t.get(\"dy\", 0) - y - container.height() / 2);\r\n\t\t\t\t\t\t\t\t\t\tif (distance < closestDistance) {\r\n\t\t\t\t\t\t\t\t\t\t\tclosestDistance = distance;\r\n\t\t\t\t\t\t\t\t\t\t\tclosestDataItem = t.dataItem as DataItem<IGanttCategoryAxisDataItem>;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (Math.abs(dy) < 10) {\r\n\t\t\t\t\t\t\tclosestDataItem = undefined;\r\n\t\t\t\t\t\t\tthis._insertAfter = undefined;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (closestDataItem && closestDataItem !== dataItem) {\r\n\t\t\t\t\t\t\t// also check if closestDataItem is not a child of the dragged item\r\n\t\t\t\t\t\t\tlet isChild = false;\r\n\t\t\t\t\t\t\tlet parent = closestDataItem.get(\"parent\");\r\n\t\t\t\t\t\t\twhile (parent) {\r\n\t\t\t\t\t\t\t\tif (parent === dataItem) {\r\n\t\t\t\t\t\t\t\t\tisChild = true;\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tparent = parent.get(\"parent\");\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tif (isChild) {\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t// color tick\r\n\t\t\t\t\t\t\tconst tick = closestDataItem.get(\"tick\")\r\n\t\t\t\t\t\t\tif (tick) {\r\n\t\t\t\t\t\t\t\ttick.hover();\r\n\t\t\t\t\t\t\t\tthis._previousTick = tick;\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tthis._insertAfter = closestDataItem;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tif (this._previousTick) {\r\n\t\t\t\t\t\t\tthis._previousTick.unhover();\r\n\t\t\t\t\t\t\tthis._previousTick = undefined;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\tcontainersTemplate.events.on(\"dragstop\", (e) => {\r\n\t\t\tthis._draggedItem = e.target.dataItem as DataItem<IGanttCategoryAxisDataItem>;\r\n\t\t\tthis._sortCategoryAxis();\r\n\r\n\t\t\tif (this._makeChildOf) {\r\n\t\t\t\tthis._makeChildOf.get(\"container\")?.get(\"background\")?.unhover();\r\n\r\n\t\t\t\tif (this._makeChildOf.get(\"collapsed\")) {\r\n\t\t\t\t\tthis.toggleCollapse(this._makeChildOf, true);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis._updateCellSizes();\r\n\t\t\t}\r\n\r\n\t\t\t// disable interactivity of all containers\r\n\t\t\tconst renderer = this.get(\"renderer\");\r\n\t\t\trenderer.containers.each((container) => {\r\n\t\t\t\tcontainer.set(\"forceInactive\", false);\r\n\t\t\t});\r\n\t\t})\r\n\r\n\t\tlet startY: number = 0;\r\n\t\tcontainersTemplate.events.on(\"dragstart\", (e) => {\r\n\t\t\t// disable interactivity of all containers\r\n\t\t\tconst renderer = this.get(\"renderer\");\r\n\t\t\trenderer.containers.each((container) => {\r\n\t\t\t\tcontainer.set(\"forceInactive\", true);\r\n\t\t\t});\r\n\t\t\tstartY = e.target.y();\r\n\t\t})\r\n\t}\r\n\r\n\tpublic _changed() {\r\n\t\tsuper._changed();\r\n\t\tif (this.isDirty(\"selectedDataItem\")) {\r\n\t\t\tthis.selectDataItem(this.get(\"selectedDataItem\"));\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _processBullet(dataItem: DataItem<IGanttCategoryAxisDataItem>) {\r\n\t\tsuper._processBullet(dataItem);\r\n\r\n\t\tconst parent = dataItem.get(\"parent\");\r\n\t\tif (parent && parent.get(\"collapsed\")) {\r\n\t\t\tdataItem.get(\"container\")?.hide();\r\n\t\t\tdataItem.get(\"tick\")?.hide();\r\n\t\t\tdataItem.get(\"grid\")?.hide();\r\n\t\t\tdataItem.set(\"finalCellSize\", 0);\r\n\t\t}\r\n\t}\r\n\r\n\tpublic _updateChildren(): void {\r\n\t\tsuper._updateChildren();\r\n\r\n\r\n\t\tif (this._dataChanged) {\r\n\t\t\t$array.each(this.dataItems, (dataItem) => {\r\n\t\t\t\tconst parentId = dataItem.get(\"parentId\");\r\n\t\t\t\tif (!parentId) {\r\n\t\t\t\t\tlet fill = dataItem.get(\"customColor\", dataItem.get(\"color\"));\r\n\t\t\t\t\tconst dataContext = dataItem.dataContext as any;\r\n\t\t\t\t\tif (fill === undefined && dataContext && dataContext.color !== undefined) {\r\n\t\t\t\t\t\tfill = color(dataContext.color);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (!fill) {\r\n\t\t\t\t\t\tfill = this.gantt?._nextColor();\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tdataItem.setRaw(\"color\", fill);\r\n\t\t\t\t}\r\n\t\t\t})\r\n\r\n\t\t\t$array.each(this.dataItems, (dataItem) => {\r\n\t\t\t\tconst parentId = dataItem.get(\"parentId\");\r\n\r\n\t\t\t\tif (parentId) {\r\n\t\t\t\t\t// Find the parent data item by category\r\n\t\t\t\t\tconst parent = this.getDataItemById(parentId);\r\n\t\t\t\t\tif (parent) {\r\n\t\t\t\t\t\tdataItem.setRaw(\"parent\", parent);\r\n\t\t\t\t\t\tdataItem.setRaw(\"cellSize\", Math.pow(this.get(\"childCellSize\", 1), this._getItemDepth(dataItem)));\r\n\t\t\t\t\t\tdataItem.setRaw(\"finalCellSize\", dataItem.get(\"cellSize\"));\r\n\r\n\t\t\t\t\t\tlet fill = dataItem.get(\"customColor\", dataItem.get(\"color\"));\r\n\t\t\t\t\t\tconst dataContext = dataItem.dataContext as any;\r\n\t\t\t\t\t\tif (fill === undefined && dataContext && dataContext.color !== undefined) {\r\n\t\t\t\t\t\t\tfill = color(dataContext.color);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (fill == undefined) {\r\n\t\t\t\t\t\t\tdataItem.setRaw(\"color\", parent.get(\"customColor\", parent.get(\"color\")));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\tdataItem.setRaw(\"color\", fill);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tlet children = parent.get(\"children\");\r\n\t\t\t\t\t\tif (!children) {\r\n\t\t\t\t\t\t\tchildren = [];\r\n\t\t\t\t\t\t\tparent.set(\"children\", children);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t$array.move(children, dataItem);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tdataItem.setRaw(\"cellSize\", 1);\r\n\t\t\t\t\tdataItem.setRaw(\"finalCellSize\", 1);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\t$array.each(this.dataItems, (dataItem) => {\r\n\t\t\t\tthis.toggleCollapse(dataItem, dataItem.get(\"collapsed\", false), 0);\r\n\t\t\t});\r\n\t\t}\r\n\t\tif (this._treeDirty) {\r\n\t\t\tthis._updateTree();\r\n\t\t}\r\n\r\n\t\tconst renderer = this.get(\"renderer\");\r\n\r\n\t\tconst firstDataItem = this._firstDataItem;\r\n\t\tif (firstDataItem) {\r\n\t\t\trenderer.updateTick(firstDataItem.get(\"tick\"), 0);\r\n\t\t\trenderer.updateGrid(firstDataItem.get(\"grid\"), 0);\r\n\t\t}\r\n\r\n\t\t$array.each(this.dataItems, (dataItem) => {\r\n\t\t\tconst progressPie = dataItem.get(\"progressPie\");\r\n\t\t\tif (progressPie) {\r\n\t\t\t\tconst progress = dataItem.get(\"progress\", 0);\r\n\t\t\t\tprogressPie.set(\"value\", progress);\r\n\r\n\t\t\t\tconst color = dataItem.get(\"customColor\", dataItem.get(\"color\"));\r\n\r\n\t\t\t\t(dataItem.dataContext as any).color = color?.toString();\r\n\t\t\t\tprogressPie.slice.set(\"fill\", color);\r\n\t\t\t\tprogressPie.backgroundSlice.set(\"fill\", color);\r\n\t\t\t\tprogressPie.label.set(\"fill\", color);\r\n\t\t\t}\r\n\r\n\t\t\tconst cellSize = dataItem.get(\"cellSize\", 1);\r\n\t\t\tconst container = dataItem.get(\"container\");\r\n\t\t\tif (container) {\r\n\t\t\t\tif (cellSize < 0.0001) {\r\n\t\t\t\t\tcontainer.setPrivate(\"visible\", false);\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tcontainer.setPrivate(\"visible\", true);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst index = dataItem.get(\"index\", 0);\r\n\t\t\t\tconst p0 = this.indexToPosition(index, 0);\r\n\t\t\t\tconst p1 = this.indexToPosition(index, 1);\r\n\r\n\t\t\t\tconst y0 = renderer.positionToCoordinate(p0);\r\n\t\t\t\tconst y1 = renderer.positionToCoordinate(p1);\r\n\r\n\t\t\t\tcontainer.set(\"height\", Math.abs(y1 - y0));\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\tpublic _clearDirty(): void {\r\n\t\tsuper._clearDirty();\r\n\t\tthis._treeDirty = false;\r\n\t}\r\n\r\n\tpublic getSeriesDataItem(dataItem: DataItem<IGanttCategoryAxisDataItem>): DataItem<IGanttSeriesDataItem> | undefined {\r\n\t\tif (dataItem.get(\"seriesDataItem\")) {\r\n\t\t\treturn dataItem.get(\"seriesDataItem\");\r\n\t\t}\r\n\t\tconst gantt = this.gantt;\r\n\t\tif (gantt) {\r\n\t\t\tconst di = gantt.series.getDataItemById(dataItem.get(\"id\")!);\r\n\t\t\tif (di) {\r\n\t\t\t\tdataItem.set(\"seriesDataItem\", di);\r\n\t\t\t\treturn di;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Zooms the axis to relative locations.\r\n\t *\r\n\t * Both `start` and `end` are relative: 0 means start of the axis, 1 - end.\r\n\t *\r\n\t * @param   start     Relative start\r\n\t * @param   end       Relative end\r\n\t * @param   duration  Duration of the zoom animation in milliseconds\r\n\t * @return            Zoom animation\r\n\t */\r\n\tpublic zoom(start: number, end: number, duration?: number): Animation<this[\"_settings\"][\"start\"]> | Animation<this[\"_settings\"][\"end\"]> | undefined {\r\n\t\tif (this.get(\"zoomable\", true)) {\r\n\t\t\tthis._updateFinals(start, end);\r\n\r\n\t\t\tif (this.get(\"start\") !== start || this.get(\"end\") != end) {\r\n\t\t\t\tlet sAnimation = this._sAnimation;\r\n\t\t\t\tlet eAnimation = this._eAnimation;\r\n\r\n\t\t\t\tif (start > end) {\r\n\t\t\t\t\t[start, end] = [end, start];\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlet maxDeviation = this.get(\"maxDeviation\", 0.5) * Math.min(1, (end - start));\r\n\r\n\t\t\t\tif (start < - maxDeviation) {\r\n\t\t\t\t\tstart = -maxDeviation;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (end > 1 + maxDeviation) {\r\n\t\t\t\t\tend = 1 + maxDeviation;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (!$type.isNumber(duration)) {\r\n\t\t\t\t\tduration = this.get(\"interpolationDuration\", 0);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (((sAnimation && sAnimation.playing && sAnimation.to == start) || this.get(\"start\") == start) && ((eAnimation && eAnimation.playing && eAnimation.to == end) || this.get(\"end\") == end)) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (duration > 0) {\r\n\t\t\t\t\tlet easing = this.get(\"interpolationEasing\");\r\n\t\t\t\t\tlet sAnimation, eAnimation;\r\n\t\t\t\t\tif (this.get(\"start\") != start) {\r\n\t\t\t\t\t\tsAnimation = this.animate({ key: \"start\", to: start, duration: duration, easing: easing });\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (this.get(\"end\") != end) {\r\n\t\t\t\t\t\teAnimation = this.animate({ key: \"end\", to: end, duration: duration, easing: easing });\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis._sAnimation = sAnimation;\r\n\t\t\t\t\tthis._eAnimation = eAnimation;\r\n\r\n\t\t\t\t\tif (sAnimation) {\r\n\t\t\t\t\t\treturn sAnimation;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (eAnimation) {\r\n\t\t\t\t\t\treturn eAnimation;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tthis.set(\"start\", start);\r\n\t\t\t\t\tthis.set(\"end\", end);\r\n\t\t\t\t\tthis.root.events.once(\"frameended\", () => {\r\n\t\t\t\t\t\tthis.markDirtyKey(\"start\");\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tif (this._sAnimation) {\r\n\t\t\t\t\tthis._sAnimation.stop();\r\n\t\t\t\t}\r\n\t\t\t\tif (this._eAnimation) {\r\n\t\t\t\t\tthis._eAnimation.stop();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tpublic _afterDataChange(): void {\r\n\t\tsuper._afterDataChange();\r\n\t\tconst chart = this.chart;\r\n\r\n\t\tif (chart) {\r\n\t\t\tconst availableHeight = chart.plotContainer.height();\r\n\r\n\t\t\tconst minCellHeight = this.get(\"minCellHeight\", 70);\r\n\t\t\tconst maxZoomCount = Math.floor(availableHeight / minCellHeight);\r\n\t\t\tthis.set(\"maxZoomCount\", maxZoomCount);\r\n\t\t\tthis.set(\"minZoomCount\", maxZoomCount);\r\n\r\n\t\t\t// to avoid many items to be drawn\r\n\t\t\tif (this.get(\"start\") == 0 && this.get(\"end\") == 1) {\r\n\t\t\t\tthis.zoomToIndexes(0, maxZoomCount);\r\n\t\t\t\tif (this._dataChangeDp) {\r\n\t\t\t\t\tthis._dataChangeDp.dispose();\r\n\t\t\t\t}\r\n\t\t\t\tthis._dataChangeDp = this.root.events.once(\"frameended\", () => {\r\n\t\t\t\t\tthis.adjustZoom();\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tpublic markDirtyTree(): void {\r\n\t\tthis._treeDirty = true;\r\n\t\tthis.markDirty();\r\n\t}\r\n\r\n\r\n\tpublic _sortCategoryAxis(): void {\r\n\t\tlet insertAfter = this._insertAfter;\r\n\t\tconst draggedItem = this._draggedItem;\r\n\r\n\t\tif (this._previousTick) {\r\n\t\t\tthis._previousTick.states.applyAnimate(\"default\");\r\n\t\t\tthis._previousTick = undefined;\r\n\t\t}\r\n\r\n\t\tif (!draggedItem) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tconst currentParent = draggedItem.get(\"parent\");\r\n\t\tconst currentDepth = this._getItemDepth(draggedItem);\r\n\r\n\t\tif (this._makeChildOf) {\r\n\t\t\tif (this._makeChildOf && draggedItem !== this._makeChildOf) {\r\n\t\t\t\tdraggedItem.set(\"parent\", this._makeChildOf);\r\n\t\t\t\tlet children = this._makeChildOf.get(\"children\");\r\n\t\t\t\tif (!children) {\r\n\t\t\t\t\tchildren = this._makeChildOf.set(\"children\", []);\r\n\t\t\t\t}\r\n\t\t\t\tif (children && !children.includes(draggedItem)) {\r\n\t\t\t\t\tchildren.unshift(draggedItem);\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// assign parent color to dragged item if it doesn't have custom color\t\t\t\r\n\t\t\t\tif (!draggedItem.get(\"customColor\")) {\r\n\t\t\t\t\tconst parentColor = this._makeChildOf.get(\"customColor\", this._makeChildOf.get(\"color\"));\r\n\t\t\t\t\tdraggedItem.setRaw(\"color\", parentColor);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst parentSeriesDataItem = this.getSeriesDataItem(this._makeChildOf);\r\n\t\t\t\tif (parentSeriesDataItem) {\r\n\t\t\t\t\tparentSeriesDataItem.setAll({\r\n\t\t\t\t\t\topenValueX: undefined,\r\n\t\t\t\t\t\tvalueX: undefined,\r\n\t\t\t\t\t\tduration: draggedItem.get(\"duration\", 0),\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tinsertAfter = this._makeChildOf;\r\n\t\t}\r\n\t\telse if (insertAfter && draggedItem !== insertAfter) {\r\n\t\t\tconst childrenOfInsertAfter = insertAfter.get(\"children\");\r\n\t\t\tconst parentOfInsertAfter = insertAfter.get(\"parent\");\r\n\r\n\t\t\t// if insertAfter has children\r\n\t\t\tif (childrenOfInsertAfter && childrenOfInsertAfter.length > 0 && !insertAfter.get(\"collapsed\", false)) {\r\n\t\t\t\t// make it child of insertAfter\r\n\t\t\t\tdraggedItem.set(\"parent\", insertAfter);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\t// if insertAfter has parent\r\n\t\t\t\tif (parentOfInsertAfter) {\r\n\t\t\t\t\tconst childrenOfParentOfInsertAfter = parentOfInsertAfter.get(\"children\");\r\n\r\n\t\t\t\t\tif (childrenOfParentOfInsertAfter) {\r\n\t\t\t\t\t\tconst lastChild = childrenOfParentOfInsertAfter[childrenOfParentOfInsertAfter.length - 1];\r\n\t\t\t\t\t\t// if insertAfter is last child of its parent, o not change parent of dragged item\r\n\t\t\t\t\t\tif (insertAfter == lastChild) {\r\n\t\t\t\t\t\t\t// if it is already child of parentOfInsertAfter, do not change parent\r\n\t\t\t\t\t\t\tif (draggedItem.get(\"parent\") === parentOfInsertAfter) {\r\n\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\t// get children of one level up\r\n\t\t\t\t\t\t\t\tconst nextParent = parentOfInsertAfter.get(\"parent\");\r\n\t\t\t\t\t\t\t\tif (nextParent) {\r\n\t\t\t\t\t\t\t\t\tconst nextChildren = nextParent.get(\"children\");\r\n\t\t\t\t\t\t\t\t\tif (nextChildren) {\r\n\t\t\t\t\t\t\t\t\t\tdraggedItem.set(\"parent\", nextParent);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\t\tif (draggedItem.get(\"parent\") !== undefined) {\r\n\t\t\t\t\t\t\t\t\t\tdraggedItem.set(\"parent\", undefined);\r\n\t\t\t\t\t\t\t\t\t\tthis._setNewColor(draggedItem);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\tif (childrenOfInsertAfter && !insertAfter.get(\"collapsed\", false)) {\r\n\t\t\t\t\t\t\t\tdraggedItem.set(\"parent\", insertAfter);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\tdraggedItem.set(\"parent\", parentOfInsertAfter);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\t// if insertAfter has no parent, do not change parent of dragged item\r\n\t\t\t\t\tif (draggedItem.get(\"parent\") !== undefined) {\r\n\t\t\t\t\t\tdraggedItem.set(\"parent\", undefined);\r\n\t\t\t\t\t\tthis._setNewColor(draggedItem);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tconst newParent = draggedItem.get(\"parent\");\r\n\t\t\tif (newParent) {\r\n\t\t\t\t// assign parent color to dragged item if it doesn't have custom color\t\t\t\r\n\t\t\t\tif (!draggedItem.get(\"customColor\")) {\r\n\t\t\t\t\tconst parentColor = newParent.get(\"customColor\", newParent.get(\"color\"));\r\n\t\t\t\t\tdraggedItem.setRaw(\"color\", parentColor);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst newParentChildren = newParent.get(\"children\");\r\n\t\t\t\tif (newParentChildren) {\r\n\t\t\t\t\tif (newParentChildren.indexOf(insertAfter) !== -1) {\r\n\t\t\t\t\t\t$array.move(newParentChildren, draggedItem, newParentChildren.indexOf(insertAfter) + 1);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tif (newParent == insertAfter) {\r\n\t\t\t\t\t\t\tnewParentChildren.unshift(draggedItem);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\tnewParentChildren.push(draggedItem);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// remove from current parent children            \r\n\t\tif (currentParent && currentParent != draggedItem.get(\"parent\")) {\r\n\t\t\tconst currentChildren = currentParent.get(\"children\");\r\n\t\t\tif (currentChildren) {\r\n\t\t\t\tconst index = currentChildren.indexOf(draggedItem);\r\n\t\t\t\tif (index !== -1) {\r\n\t\t\t\t\t$array.remove(currentChildren, draggedItem);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (insertAfter) {\r\n\t\t\tconst insertAfterIndex = this.dataItems.indexOf(insertAfter);\r\n\t\t\tconst currentIndex = this.dataItems.indexOf(draggedItem);\r\n\r\n\t\t\tconst updateChildrenIndexes = (dataItem: DataItem<IGanttCategoryAxisDataItem>, index: number) => {\r\n\t\t\t\tif (currentIndex >= insertAfterIndex) {\r\n\t\t\t\t\tindex++;\r\n\t\t\t\t\t$array.move(this.dataItems, dataItem, index);\r\n\t\t\t\t\tconst children = dataItem.get(\"children\");\r\n\t\t\t\t\tif (children) {\r\n\t\t\t\t\t\t$array.eachReverse(children, (child) => {\r\n\t\t\t\t\t\t\tupdateChildrenIndexes(child, index);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\t$array.move(this.dataItems, dataItem, index);\r\n\t\t\t\t\tconst children = dataItem.get(\"children\");\r\n\t\t\t\t\tif (children) {\r\n\t\t\t\t\t\t$array.each(children, (child) => {\r\n\t\t\t\t\t\t\tupdateChildrenIndexes(child, index);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\tif (this._getItemDepth(draggedItem) != currentDepth) {\r\n\t\t\t\tconst seriesDataItem = this.getSeriesDataItem(draggedItem);\r\n\t\t\t\tif (seriesDataItem) {\r\n\t\t\t\t\tthis.gantt?.series.disposeLinks(seriesDataItem);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tupdateChildrenIndexes(draggedItem, insertAfterIndex);\r\n\t\t}\r\n\r\n\t\tthis.markDirtyTree();\r\n\r\n\t\tconst easing = this.get(\"interpolationEasing\");\r\n\t\tconst duration = this.get(\"interpolationDuration\", 0);\r\n\r\n\t\t$array.each(this.dataItems, (axisItem, index) => {\r\n\t\t\tconst container = axisItem.get(\"container\");\r\n\t\t\tif (container) {\r\n\t\t\t\tlet currentPosition = this.coordinateToPosition(container.y() + container.height() / 2);\r\n\t\t\t\tlet newPosition = this.indexToPosition(index) - axisItem.get(\"deltaPosition\", 0);\r\n\t\t\t\tlet deltaPosition = newPosition - currentPosition;\r\n\t\t\t\taxisItem.set(\"deltaPosition\", -deltaPosition);\r\n\t\t\t\taxisItem.animate({ key: \"deltaPosition\", to: 0, duration: duration, easing: easing });\r\n\t\t\t\taxisItem.get(\"tick\")?.animate({ key: \"dy\", to: 0, duration: duration, easing: easing });\r\n\t\t\t\taxisItem.get(\"grid\")?.animate({ key: \"dy\", to: 0, duration: duration, easing: easing });\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tpublic _setNewColor(dataItem: DataItem<IGanttCategoryAxisDataItem>, color?: Color): void {\r\n\t\tif (!color) {\r\n\t\t\tcolor = this.gantt?._nextColor();\r\n\t\t}\r\n\t\tdataItem.set(\"color\", color);\r\n\r\n\t\tconst children = dataItem.get(\"children\");\r\n\r\n\t\tif (children && children.length > 0) {\r\n\t\t\t$array.each(children, (child) => {\r\n\t\t\t\tthis._setNewColor(child, color);\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\r\n\tpublic _updateTree(): void {\r\n\t\tconst gantt = this.gantt;\r\n\r\n\t\tif (gantt) {\r\n\t\t\t$array.each(gantt.series.dataItems, (seriesDataItem) => {\r\n\t\t\t\tseriesDataItem.set(\"children\", []);\r\n\t\t\t\tseriesDataItem.set(\"parent\", undefined);\r\n\t\t\t})\r\n\r\n\t\t\t$array.each(this.dataItems, (dataItem) => {\r\n\t\t\t\tconst parent = dataItem.get(\"parent\");\r\n\r\n\t\t\t\tif (parent) {\r\n\t\t\t\t\tconst id = dataItem.get(\"id\")!;\r\n\t\t\t\t\tconst parentId = parent.get(\"id\")!;\r\n\r\n\t\t\t\t\tconst seriesDataItem = gantt.series.getDataItemById(id);\r\n\r\n\t\t\t\t\tdataItem.set(\"parentId\", parentId);\r\n\r\n\t\t\t\t\tconst parentSeriesDataItem = gantt.series.getDataItemById(parentId);\r\n\r\n\t\t\t\t\tif (seriesDataItem) {\r\n\t\t\t\t\t\tif (parentSeriesDataItem) {\r\n\t\t\t\t\t\t\tseriesDataItem.set(\"parent\", parentSeriesDataItem);\r\n\r\n\t\t\t\t\t\t\tlet children = parentSeriesDataItem.get(\"children\", []);\r\n\t\t\t\t\t\t\t$array.move(children, seriesDataItem);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\t// hide grips for those with children\r\n\t\t\t$array.each(gantt.series.dataItems, (seriesDataItem) => {\r\n\t\t\t\tconst children = seriesDataItem.get(\"children\");\r\n\t\t\t\tconst startGrip = seriesDataItem.get(\"startGrip\");\r\n\t\t\t\tconst endGrip = seriesDataItem.get(\"endGrip\");\r\n\t\t\t\tif (startGrip && endGrip) {\r\n\t\t\t\t\tif (!children || children.length === 0) {\r\n\t\t\t\t\t\tstartGrip.set(\"forceHidden\", false);\r\n\t\t\t\t\t\tendGrip.set(\"forceHidden\", false);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tstartGrip.set(\"forceHidden\", true);\r\n\t\t\t\t\t\tendGrip.set(\"forceHidden\", true);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t})\r\n\r\n\t\t\tthis.data.values.length = 0;\r\n\t\t\tgantt.series.data.values.length = 0;\r\n\r\n\t\t\t$array.each(this.dataItems, (dataItem, index) => {\r\n\t\t\t\tdataItem.setRaw(\"index\", index);\r\n\t\t\t\tthis.data.values.push(dataItem.dataContext);\r\n\r\n\t\t\t\tconst seriesDataItem = this.getSeriesDataItem(dataItem);\r\n\t\t\t\tif (seriesDataItem) {\r\n\t\t\t\t\tgantt.series.data.values.push(seriesDataItem?.dataContext);\r\n\t\t\t\t\t$array.move(gantt.series.dataItems, seriesDataItem);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tthis._updateCellSizes();\t\t\t// all bullets exept the first one\r\n\t\t\t$array.each(this.dataItems, (dataItem) => {\r\n\t\t\t\tthis._updateBullet(dataItem);\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\r\n\tpublic _updateCellSizes(duration?: number): void {\r\n\t\t$array.each(this.dataItems, (dataItem) => {\r\n\t\t\tif (duration === undefined) {\r\n\t\t\t\tduration = this.get(\"interpolationDuration\", 0);\r\n\t\t\t}\r\n\r\n\t\t\tconst depth = this._getItemDepth(dataItem);\r\n\t\t\tlet cellSize = this.get(\"childCellSize\", 1);\r\n\t\t\tconst parent = dataItem.get(\"parent\");\r\n\t\t\tif (parent && parent.get(\"collapsed\", false)) {\r\n\t\t\t\tcellSize = 0;\r\n\t\t\t}\r\n\r\n\t\t\tcellSize = Math.pow(cellSize, depth);\r\n\r\n\t\t\tif (dataItem.get(\"deleting\")) {\r\n\t\t\t\tcellSize = 0;\r\n\t\t\t}\r\n\r\n\t\t\t//dataItem.set(\"cellSize\", cellSize);\r\n\t\t\tif (dataItem.get(\"cellSize\", 1) != cellSize) {\r\n\t\t\t\tdataItem.set(\"finalCellSize\", cellSize);\r\n\t\t\t\tdataItem.animate({ key: \"cellSize\", to: cellSize, duration: duration!, easing: this.get(\"interpolationEasing\") });\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tif (this._dataChangeDp) {\r\n\t\t\tthis._dataChangeDp.dispose();\r\n\t\t}\r\n\t\tthis._dataChangeDp = this.root.events.once(\"frameended\", () => {\r\n\t\t\tthis.adjustZoom();\r\n\t\t})\r\n\t}\r\n\r\n\tpublic _updateBullet(dataItem: DataItem<IGanttCategoryAxisDataItem>): void {\r\n\t\tconst taskBullet = dataItem.get(\"taskBullet\");\r\n\r\n\t\tif (taskBullet) {\r\n\t\t\tconst depth = this._getItemDepth(dataItem);\r\n\t\t\tconst children = dataItem.get(\"children\");\r\n\r\n\t\t\ttaskBullet.setAll({\r\n\t\t\t\tmarginLeft: this.get(\"childShift\", 20) * depth\r\n\t\t\t});\r\n\r\n\t\t\tconst collapsed = dataItem.get(\"collapsed\", false);\r\n\t\t\tconst icon = taskBullet.get(\"icon\");\r\n\r\n\t\t\tlet hasChildren = false;\r\n\t\t\tif (children && children.length > 0) {\r\n\t\t\t\thasChildren = true;\r\n\t\t\t}\r\n\r\n\t\t\tif (icon) {\r\n\t\t\t\tif (hasChildren) {\r\n\t\t\t\t\ttaskBullet.set(\"disabled\", false);\r\n\t\t\t\t\tthis.root.events.once(\"frameended\", () => {\r\n\t\t\t\t\t\ttaskBullet.set(\"active\", !collapsed);\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\ttaskBullet.set(\"disabled\", true);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Toggles collapse state of a data item.\r\n\t * @param dataItem \r\n\t * @param collapse \r\n\t * @param duration \r\n\t */\r\n\tpublic toggleCollapse(dataItem: DataItem<IGanttCategoryAxisDataItem>, collapse?: boolean, duration?: number): void {\r\n\t\tif (dataItem && dataItem.get(\"collapsed\", false) !== collapse) {\r\n\r\n\t\t\tconst children = dataItem.get(\"children\");\r\n\t\t\tdataItem.set(\"collapsed\", collapse);\r\n\r\n\t\t\tif (children && children.length > 0) {\r\n\r\n\t\t\t\t$array.each(children, (child) => {\r\n\t\t\t\t\tconst container = child.get(\"container\")!;\r\n\t\t\t\t\tconst grid = child.get(\"grid\")!;\r\n\t\t\t\t\tconst tick = child.get(\"tick\")!;\r\n\r\n\t\t\t\t\tif (container) {\r\n\t\t\t\t\t\tif (collapse) {\r\n\t\t\t\t\t\t\tcontainer.hide();\r\n\t\t\t\t\t\t\tgrid.hide();\r\n\t\t\t\t\t\t\ttick.hide();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\tcontainer.show();\r\n\t\t\t\t\t\t\tgrid.show();\r\n\t\t\t\t\t\t\ttick.show();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tconst gantt = this.gantt;\r\n\t\t\t\t\tif (gantt && gantt.series) {\r\n\t\t\t\t\t\tconst series = gantt.series;\r\n\t\t\t\t\t\tconst seriesDataItem = series.dataItems.find((item) => item.get(\"categoryY\") === child.get(\"category\"));\r\n\t\t\t\t\t\tif (seriesDataItem) {\r\n\t\t\t\t\t\t\tif (collapse) {\r\n\t\t\t\t\t\t\t\tseriesDataItem.hide();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\tseriesDataItem.show();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.toggleCollapse(child, collapse, duration);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tthis._updateBullet(dataItem);\r\n\r\n\t\t\tif (this._updDP) {\r\n\t\t\t\tthis._updDP.dispose();\r\n\t\t\t}\r\n\t\t\tthis._updDP = this.root.events.once(\"frameended\", () => {\r\n\t\t\t\tthis._updateCellSizes(duration);\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Expands all categories in the axis.\r\n\t */\r\n\tpublic expandAll(): void {\r\n\t\t$array.each(this.dataItems, (dataItem) => {\r\n\t\t\tif (dataItem.get(\"collapsed\", false)) {\r\n\t\t\t\tthis.toggleCollapse(dataItem, false);\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\t/**\r\n\t * Collapses all categories in the axis.\r\n\t */\r\n\tpublic collapseAll(): void {\r\n\t\t$array.each(this.dataItems, (dataItem) => {\r\n\t\t\tif (!dataItem.get(\"collapsed\", false)) {\r\n\t\t\t\tthis.toggleCollapse(dataItem, true);\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\t/**\r\n\t * Deletes all data items from the axis.\r\n\t */\r\n\tpublic deleteAll(): void {\r\n\t\tthis.data.clear();\r\n\t\tthis.gantt?.series.data.clear();\r\n\t\tthis.selectDataItem(undefined);\r\n\t}\r\n\r\n\r\n\t/**\r\n\t * Deletes a data item from the axis.\r\n\t *\r\n\t * @param dataItem  Data item to delete\r\n\t */\r\n\tpublic deleteDataItem(dataItem: DataItem<IGanttCategoryAxisDataItem>, child?: boolean): void {\r\n\t\tconst series = this.gantt?.series;\r\n\r\n\t\tconst children = dataItem.get(\"children\");\r\n\t\tif (children && children.length > 0) {\r\n\t\t\tfor (let i = children.length - 1; i >= 0; i--) {\r\n\t\t\t\tthis.deleteDataItem(children[i], true);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tdataItem.set(\"deleting\", true);\r\n\r\n\t\tif (!child) {\r\n\t\t\tthis._updateCellSizes();\r\n\t\t}\r\n\r\n\t\tconst container = dataItem.get(\"container\");\r\n\r\n\t\tif (container) {\r\n\t\t\tconst promise = container.hide();\r\n\t\t\tpromise.then(() => {\r\n\t\t\t\tif (series && seriesDataItem) {\r\n\t\t\t\t\tseries.setPrivate(\"minX\", undefined);\r\n\t\t\t\t\tseries.setPrivate(\"maxX\", undefined);\r\n\t\t\t\t\tseries.data.removeValue(seriesDataItem.dataContext);\r\n\t\t\t\t}\r\n\t\t\t\tthis.data.removeValue(dataItem.dataContext);\r\n\t\t\t})\r\n\t\t}\r\n\r\n\r\n\t\tlet seriesDataItem: DataItem<IGanttSeriesDataItem> | undefined;\r\n\t\tif (series) {\r\n\t\t\tseriesDataItem = this.getSeriesDataItem(dataItem);\r\n\t\t\tif (seriesDataItem) {\r\n\t\t\t\tseriesDataItem.hide();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Toggles progress pie for a data item. Toggling means that progress pie\r\n\t * will animate to 1 if it was less than 1, or animate to previous progress\r\n\t * value if it was 1.\r\n\t *\r\n\t * @param dataItem  Data item to toggle progress pie for\r\n\t */\r\n\tpublic toggleProgressPie(dataItem?: DataItem<IGanttCategoryAxisDataItem>, value?: number): void {\r\n\t\tif (dataItem) {\r\n\t\t\tconst children = dataItem.get(\"children\");\r\n\t\t\tif (children && children.length > 0) {\r\n\r\n\t\t\t\tconst currentValue = dataItem.get(\"progress\", 0);\r\n\t\t\t\tlet toValue: number | undefined = undefined;\r\n\t\t\t\tif (currentValue !== 1) {\r\n\t\t\t\t\ttoValue = 1;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t$array.each(children, (child: DataItem<IGanttCategoryAxisDataItem>) => {\r\n\t\t\t\t\tthis.toggleProgressPie(child, toValue);\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tconst seriesDataItem = this.getSeriesDataItem(dataItem);\r\n\t\t\t\tif (seriesDataItem) {\r\n\t\t\t\t\tconst progress = seriesDataItem.get(\"progress\", 0);\r\n\t\t\t\t\tconst prevProgress = seriesDataItem.get(\"prevProgress\", 0);\r\n\r\n\t\t\t\t\tlet toProgress = 1;\r\n\t\t\t\t\tif (progress == 1 && prevProgress != undefined) {\r\n\t\t\t\t\t\ttoProgress = prevProgress\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (value !== undefined) {\r\n\t\t\t\t\t\ttoProgress = value;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tseriesDataItem.set(\"prevProgress\", progress);\r\n\t\t\t\t\tseriesDataItem.animate({\r\n\t\t\t\t\t\tkey: \"progress\",\r\n\t\t\t\t\t\tto: toProgress,\r\n\t\t\t\t\t\tduration: this.get(\"interpolationDuration\", 0), easing: this.get(\"interpolationEasing\")\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Sets a custom color for a data item.\r\n\t *\r\n\t * @param dataItem  Data item to set color for\r\n\t * @param c         Color to set\r\n\t */\r\n\tpublic setDataItemColor(dataItem?: DataItem<IGanttCategoryAxisDataItem>, c?: Color): void {\r\n\t\tif (dataItem) {\r\n\t\t\tconst cc = dataItem.get(\"color\");\r\n\t\t\tif (c && cc && c.hex === cc.hex) {\r\n\t\t\t\tc = undefined;\r\n\t\t\t}\r\n\r\n\t\t\tdataItem.set(\"customColor\", c);\r\n\r\n\t\t\t// children\r\n\t\t\tconst children = dataItem.get(\"children\");\r\n\t\t\tif (children && children.length > 0) {\r\n\t\t\t\t$array.each(children, (child: DataItem<IGanttCategoryAxisDataItem>) => {\r\n\t\t\t\t\tthis.setDataItemColor(child, c);\r\n\t\t\t\t})\r\n\t\t\t}\r\n\r\n\t\t\tthis.gantt?.series.markDirtyValues();\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Hides axis's data item.\r\n\t *\r\n\t * @param   dataItem  Data item\r\n\t * @param   duration  Animation duration in milliseconds\r\n\t * @return            Promise\r\n\t */\r\n\tpublic async hideDataItem(dataItem: DataItem<IGanttCategoryAxisDataItem>): Promise<void> {\r\n\t\tconst promise = super.hideDataItem(dataItem);\r\n\r\n\t\tconst container = dataItem.get(\"container\");\r\n\t\tif (container) {\r\n\t\t\tcontainer.hide();\r\n\t\t}\r\n\r\n\t\treturn promise;\r\n\t}\r\n\r\n\t/**\r\n\t * Shows axis's data item.\r\n\t *\r\n\t * @param   dataItem  Data item\r\n\t * @param   duration  Animation duration in milliseconds\r\n\t * @return            Promise\r\n\t */\r\n\tpublic async showDataItem(dataItem: DataItem<IGanttCategoryAxisDataItem>): Promise<void> {\r\n\t\tconst promise = super.showDataItem(dataItem);\r\n\t\tconst container = dataItem.get(\"container\");\r\n\t\tif (container) {\r\n\t\t\tcontainer.show();\r\n\t\t}\r\n\t\treturn promise;\r\n\t}\r\n\r\n\tpublic _toggleFHDataItem(dataItem: DataItem<IGanttCategoryAxisDataItem>, forceHidden: boolean) {\r\n\t\tconst fh = \"forceHidden\";\r\n\t\tconst container = dataItem.get(\"container\");\r\n\t\tif (container) {\r\n\t\t\tcontainer.set(fh, forceHidden);\r\n\t\t}\r\n\t}\r\n\r\n\r\n\tpublic _toggleDataItem(dataItem: DataItem<IGanttCategoryAxisDataItem>, visible: boolean) {\r\n\t\tsuper._toggleDataItem(dataItem, visible);\r\n\t\tconst container = dataItem.get(\"container\");\r\n\t\tif (container) {\r\n\t\t\tcontainer.set(\"visible\", visible);\r\n\t\t}\r\n\t}\r\n\r\n\r\n\t/**\r\n\t * Disposes a data item.\r\n\t *\r\n\t * @param dataItem  Data item to dispose\r\n\t */\r\n\tpublic disposeDataItem(dataItem: DataItem<this[\"_dataItemSettings\"]>) {\r\n\t\tsuper.disposeDataItem(dataItem);\r\n\r\n\t\t// remove all elements\r\n\t\tconst renderer = this.get(\"renderer\");\r\n\t\tconst container = dataItem.get(\"container\");\r\n\t\tif (container) {\r\n\t\t\trenderer.containers.removeValue(container);\r\n\t\t\tcontainer.dispose();\r\n\t\t}\r\n\r\n\t\t// progress pie\r\n\t\tconst progressPie = dataItem.get(\"progressPie\");\r\n\t\tif (progressPie) {\r\n\t\t\trenderer.progressPies.removeValue(progressPie);\r\n\t\t\tprogressPie.dispose();\r\n\t\t}\r\n\r\n\t\t// grips\r\n\t\tconst grip = dataItem.get(\"grip\");\r\n\t\tif (grip) {\r\n\t\t\trenderer.grips.removeValue(grip);\r\n\t\t\tgrip.dispose();\r\n\t\t}\r\n\t\t// duration stepper\r\n\t\tconst durationStepper = dataItem.get(\"durationStepper\");\r\n\t\tif (durationStepper) {\r\n\t\t\trenderer.durationSteppers.removeValue(durationStepper);\r\n\t\t\tdurationStepper.dispose();\r\n\t\t}\r\n\r\n\t\t// task bullet\r\n\t\tconst taskBullet = dataItem.get(\"taskBullet\");\r\n\t\tif (taskBullet) {\r\n\t\t\trenderer.taskBullets.removeValue(taskBullet);\r\n\t\t\ttaskBullet.dispose();\r\n\t\t}\r\n\r\n\t\tconst parent = dataItem.get(\"parent\");\r\n\r\n\t\tif (parent) {\r\n\t\t\tconst children = parent.get(\"children\");\r\n\r\n\t\t\tif (children) {\r\n\t\t\t\t$array.remove(children, dataItem);\r\n\t\t\t}\r\n\t\t\tthis._updateBullet(parent);\r\n\t\t}\r\n\r\n\t\tthis._updateCellSizes();\r\n\t}\r\n\r\n\t/**\r\n\t * Selects a data item and shows the delete button. If the data item is\r\n\t * already selected, it will unselect it.\r\n\t *\r\n\t * @param dataItem  Data item to select\r\n\t */\r\n\tpublic selectDataItem(dataItem?: DataItem<IGanttCategoryAxisDataItem>): void {\r\n\t\tif (!this.gantt?.get(\"editable\", true)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (dataItem === this.get(\"selectedDataItem\")) {\r\n\t\t\tthis.unselectDataItems();\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis.unselectDataItems();\r\n\r\n\t\tif (!dataItem) {\r\n\t\t\tthis.setRaw(\"selectedDataItem\", undefined);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst container = dataItem.get(\"container\");\r\n\t\tif (container) {\r\n\t\t\tconst bg = container.get(\"background\");\r\n\t\t\tif (bg) {\r\n\t\t\t\tbg.set(\"active\", true);\r\n\t\t\t}\r\n\r\n\t\t\tconst progressPie = dataItem.get(\"progressPie\");\r\n\t\t\tprogressPie?.children.push(this.xButton);\r\n\r\n\t\t\tthis.setRaw(\"selectedDataItem\", dataItem);\r\n\r\n\t\t\tif (this._xHideDP) {\r\n\t\t\t\tthis._xHideDP.dispose();\r\n\t\t\t}\r\n\r\n\t\t\tthis.gantt?.colorPickerButton.set(\"color\", dataItem.get(\"customColor\", dataItem.get(\"color\")));\r\n\r\n\t\t\tthis.setTimeout(() => {\r\n\t\t\t\tthis._xHideDP = this.events.once(\"globalpointerup\", () => {\r\n\t\t\t\t\tthis.unselectDataItems();\r\n\t\t\t\t})\r\n\t\t\t}, 200);\r\n\r\n\t\t\tif (this._delDp) {\r\n\t\t\t\tthis._delDp.dispose();\r\n\t\t\t}\r\n\r\n\t\t\tthis._delDp = this.xButton.events.once(\"click\", () => {\r\n\t\t\t\tconst parent = this.xButton.parent;\r\n\t\t\t\tif (parent) {\r\n\t\t\t\t\tparent.children.removeValue(this.xButton);\r\n\t\t\t\t}\r\n\t\t\t\tthis.deleteDataItem(dataItem);\r\n\t\t\t\tthis.unselectDataItems();\r\n\t\t\t})\r\n\r\n\t\t\tthis.xButton.show();\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.unselectDataItems();\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Unselects all data items.\r\n\t */\r\n\tpublic unselectDataItems(): void {\r\n\t\tthis.setRaw(\"selectedDataItem\", undefined);\r\n\t\tthis.xButton.hide(0);\r\n\t\t$array.each(this.dataItems, (dataItem: DataItem<IGanttCategoryAxisDataItem>) => {\r\n\t\t\tconst container = dataItem.get(\"container\");\r\n\t\t\tif (container) {\r\n\t\t\t\tconst bg = container.get(\"background\");\r\n\t\t\t\tif (bg) {\r\n\t\t\t\t\tbg.set(\"active\", false);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * @ignore\r\n\t */\r\n\tpublic _disposeXHideDP() {\r\n\t\tif (this._xHideDP) {\r\n\t\t\tthis._xHideDP.dispose();\r\n\t\t\tthis._xHideDP = undefined;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @ignore\r\n\t * @param dataItem \r\n\t * @returns depth of the data item in the hierarchy\r\n\t */\r\n\tpublic _getItemDepth(dataItem: DataItem<IGanttCategoryAxisDataItem>): number {\r\n\t\tlet depth = 0;\r\n\t\tlet parent = dataItem.get(\"parent\");\r\n\t\twhile (parent) {\r\n\t\t\tdepth++;\r\n\t\t\tparent = parent.get(\"parent\");\r\n\t\t}\r\n\t\treturn depth;\r\n\t}\r\n\r\n\t/**\r\n\t * @ignore\r\n\t * Overrides original method so that a ghost label is not created.\r\n\t */\r\n\tprotected _createGhostLabel() { }\r\n}","import type { GanttCategoryAxis, IGanttCategoryAxisDataItem } from \"./GanttCategoryAxis\";\r\nimport type { AxisLabel } from \"../xy/axes/AxisLabel\";\r\nimport type { AxisTick } from \"../xy/axes/AxisTick\";\r\n\r\nimport { AxisRendererY, IAxisRendererYSettings, IAxisRendererYPrivate } from \"../xy/axes/AxisRendererY\";\r\nimport { ListTemplate } from \"../../core/util/List\";\r\nimport { Template } from \"../../core/util/Template\";\r\nimport { EditableAxisLabel } from \"../xy/axes/EditableAxisLabel\";\r\nimport { Button, Container, DataItem, Graphics, p100, p50, Rectangle } from \"../../..\";\r\nimport { ProgressPie } from \"../../core/render/ProgressPie\";\r\nimport { NumericStepper } from \"../../core/render/NumericStepper\";\r\n\r\nimport * as $utils from \"../../core/util/Utils\";\r\nimport * as $type from \"../../core/util/Type\";\r\n\r\n\r\nexport interface IGanttCategoryAxisRendererSettings extends IAxisRendererYSettings {\r\n}\r\n\r\nexport interface IGanttCategoryAxisRendererPrivate extends IAxisRendererYPrivate {\r\n}\r\n\r\n/**\r\n * Renderer for [[GanttCategoryAxis]] axes.\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/gantt/#Category_vertical_axis} for more info\r\n * @since 5.14.0\r\n * @important\r\n */\r\nexport class GanttCategoryAxisRenderer extends AxisRendererY {\r\n\tpublic static className: string = \"GanttCategoryAxisRenderer\";\r\n\tpublic static classNames: Array<string> = AxisRendererY.classNames.concat([GanttCategoryAxisRenderer.className]);\r\n\r\n\tdeclare public _settings: IGanttCategoryAxisRendererSettings;\r\n\tdeclare public _privateSettings: IGanttCategoryAxisRendererPrivate;\r\n\r\n\tdeclare public axis: GanttCategoryAxis<this>;\r\n\r\n\r\n\t/**\r\n\t * A [[TemplateList]] with all the labels attached to the axis.\r\n\t *\r\n\t * `labels.template` can be used to configure appearance of the labels.\r\n\t *\r\n\t * @default new ListTemplate<AxisLabelRadial>\r\n\t */\r\n\tpublic readonly labels: ListTemplate<EditableAxisLabel> = this.addDisposer(new ListTemplate(\r\n\t\tTemplate.new({}),\r\n\t\t() => EditableAxisLabel._new(this._root, {\r\n\t\t\tthemeTagsSelf: [\"categorylabel\"]\r\n\t\t}, [this.labels.template])\r\n\t));\r\n\r\n\t/**\r\n\t * A [[TemplateList]] with all the containers attached to the axis.\r\n\t *\r\n\t * This container holds all the elements of axis item - label, grip, task bullet, controls, etc.\r\n\t *\r\n\t * @default new ListTemplate<Container>\r\n\t */\r\n\tpublic readonly containers: ListTemplate<Container> = this.addDisposer(new ListTemplate(\r\n\t\tTemplate.new({}),\r\n\t\t() => Container._new(this._root, {\r\n\t\t\tthemeTagsSelf: [\"axislabelcontainer\"]\r\n\t\t}, [this.containers.template])\r\n\t));\r\n\r\n\t/**\r\n\t * A [[TemplateList]] with all the controls containers attached to the axis.\r\n\t *\r\n\t * This container holds all the controls of axis item - duration stepper, progress pie, etc.\r\n\t *\r\n\t * @default new ListTemplate<Container>\r\n\t */\r\n\tpublic readonly controlsContainers: ListTemplate<Container> = this.addDisposer(new ListTemplate(\r\n\t\tTemplate.new({}),\r\n\t\t() => Container._new(this._root, {\r\n\t\t\tthemeTagsSelf: [\"axislabelcontrols\"]\r\n\t\t}, [this.controlsContainers.template])\r\n\t));\r\n\r\n\t/**\r\n\t * A [[TemplateList]] with all the grips attached to the axis.\r\n\t *\r\n\t * Dragging by the grips allows to rearrange the axis items.\r\n\t *\r\n\t * @default new ListTemplate<Rectangle>\r\n\t */\r\n\tpublic readonly grips: ListTemplate<Rectangle> = this.addDisposer(new ListTemplate(\r\n\t\tTemplate.new({}),\r\n\t\t() => Rectangle._new(this._root, {\r\n\t\t\tthemeTags: $utils.mergeTags(this.grips.template.get(\"themeTags\", [\"grip\", \"axislabel\"]), this.get(\"themeTags\", []))\r\n\t\t}, [this.grips.template])\r\n\t));\r\n\r\n\t/**\r\n\t * A [[TemplateList]] with all the progress pies attached to the axis.\r\n\t *\r\n\t * Progress pies are used to show progress of tasks.\r\n\t *\r\n\t * @default new ListTemplate<ProgressPie>\r\n\t */\r\n\tpublic readonly progressPies: ListTemplate<ProgressPie> = this.addDisposer(new ListTemplate(\r\n\t\tTemplate.new({}),\r\n\t\t() => ProgressPie._new(this._root, {\r\n\t\t\tthemeTags: $utils.mergeTags(this.progressPies.template.get(\"themeTags\", [\"progresspie\"]), this.get(\"themeTags\", []))\r\n\t\t}, [this.progressPies.template])\r\n\t));\r\n\r\n\t/**\r\n\t * A [[TemplateList]] with all the task bullets attached to the axis.\r\n\t *\r\n\t * Task bullets are shown to the left of the label. If a task doesn't have\r\n\t * children it will show circle. Otherwise it will show rectangle which is\r\n\t * clickable and can be used to toggle collapse/expand of the task.\r\n\t *\r\n\t * @default new ListTemplate<Button>\r\n\t */\r\n\tpublic readonly taskBullets: ListTemplate<Button> = this.addDisposer(new ListTemplate(\r\n\t\tTemplate.new({}),\r\n\t\t() => Button._new(this._root, {\r\n\t\t\ttoggleKey: \"active\",\r\n\t\t\ticon: Graphics.new(this._root, {\r\n\t\t\t\tthemeTags: [\"icon\"]\r\n\t\t\t}),\r\n\t\t\tthemeTags: $utils.mergeTags(this.taskBullets.template.get(\"themeTags\", [\"taskbullet\"]), this.get(\"themeTags\", []))\r\n\t\t}, [this.taskBullets.template])\r\n\t));\r\n\r\n\t/**\r\n\t * A [[TemplateList]] with all the duration steppers attached to the axis.\r\n\t *\r\n\t * Duration steppers are used to set and show duration of tasks.\r\n\t *\r\n\t * @default new ListTemplate<NumericStepper>\r\n\t */\r\n\tpublic readonly durationSteppers: ListTemplate<NumericStepper> = this.addDisposer(new ListTemplate(\r\n\t\tTemplate.new({}),\r\n\t\t() => NumericStepper._new(this._root, {\r\n\t\t\tthemeTags: $utils.mergeTags(this.durationSteppers.template.get(\"themeTags\", [\"durationstepper\"]), this.get(\"themeTags\", []))\r\n\t\t}, [this.durationSteppers.template])\r\n\t));\r\n\r\n\t/**\r\n\t * @ignore\r\n\t */\r\n\tpublic makeLabel(dataItem: DataItem<IGanttCategoryAxisDataItem>, themeTags: Array<string>): AxisLabel {\r\n\t\tconst axis = this.axis;\r\n\t\tconst container = this.containers.make();\r\n\t\tconst dataContext = dataItem.dataContext as any;\r\n\t\tcontainer.set(\"layout\", this._root.horizontalLayout);\r\n\t\tcontainer.set(\"width\", p100);\r\n\r\n\t\tcontainer._setDataItem(dataItem);\r\n\t\tthis.containers.push(container);\r\n\t\tdataItem.setRaw(\"container\", container);\r\n\r\n\t\tconst background = container.set(\"background\", Rectangle.new(this._root, {\r\n\t\t\tthemeTags: [\"background\", \"axislabelcontainer\"],\r\n\t\t\tinteractive: true\r\n\t\t}));\r\n\r\n\t\tbackground.events.on(\"click\", (ev) => {\r\n\t\t\taxis.selectDataItem(ev.target.dataItem);\r\n\t\t});\r\n\r\n\t\tconst grip = this.grips.make();\r\n\t\tcontainer.children.push(grip);\r\n\t\tthis.grips.push(grip);\r\n\t\tdataItem.setRaw(\"grip\", grip);\r\n\r\n\t\tconst taskBullet = this.taskBullets.make();\r\n\t\tcontainer.children.push(taskBullet);\r\n\t\tthis.taskBullets.push(taskBullet);\r\n\t\tdataItem.setRaw(\"taskBullet\", taskBullet);\r\n\r\n\t\ttaskBullet.events.on(\"click\", (ev) => {\r\n\t\t\tconst dataItem = ev.target.dataItem as DataItem<IGanttCategoryAxisDataItem>;\r\n\t\t\tif (dataItem) {\r\n\t\t\t\taxis.toggleCollapse(dataItem, !dataItem.get(\"collapsed\", false));\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tconst labelContainer = container.children.push(Container.new(this._root, {\r\n\t\t\twidth: p100,\r\n\t\t\tcenterY: p50,\r\n\t\t\ty: p50\r\n\t\t}));\r\n\r\n\t\tconst label = super.makeLabel(dataItem, themeTags);\r\n\t\tlabelContainer.children.push(label);\r\n\r\n\t\tlabel.events.on(\"pointerover\", () => {\r\n\t\t\tbackground.hover();\r\n\t\t});\r\n\r\n\t\tlabel.events.on(\"pointerout\", () => {\r\n\t\t\tbackground.unhover();\r\n\t\t});\r\n\r\n\t\tlabel.events.on(\"click\", () => {\r\n\t\t\tlabel.set(\"maxWidth\", undefined);\r\n\t\t});\r\n\r\n\t\tcontainer.events.on(\"boundschanged\", () => {\r\n\t\t\tlabel.set(\"maxWidth\", labelContainer.width());\r\n\t\t});\r\n\r\n\t\tlet tempText: string | undefined;\r\n\r\n\t\tlabel.on(\"active\", (active) => {\r\n\t\t\tif (active) {\r\n\t\t\t\ttempText = label.get(\"text\", \"\");\r\n\t\t\t\tlabel.set(\"text\", dataItem.get(\"name\"));\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\tlabel.on(\"text\", (text) => {\r\n\t\t\tif (tempText != undefined && text != tempText) {\r\n\t\t\t\tdataItem.set(\"name\", text);\r\n\t\t\t\tif (dataContext) {\r\n\t\t\t\t\tdataContext[this.axis.get(\"nameField\", \"name\")] = text;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tconst controlsContainer = this.controlsContainers.make();\r\n\t\tthis.controlsContainers.push(controlsContainer);\r\n\t\tdataItem.setRaw(\"controlsContainer\", controlsContainer);\r\n\t\tcontainer.children.push(controlsContainer);\r\n\r\n\t\tconst durationStepper = this.durationSteppers.make();\r\n\t\tcontrolsContainer.children.push(durationStepper);\r\n\t\tdataItem.setRaw(\"durationStepper\", durationStepper);\r\n\t\tthis.durationSteppers.push(durationStepper);\r\n\r\n\t\tdurationStepper.on(\"value\", (value) => {\r\n\t\t\tconst dataItem = durationStepper.dataItem as DataItem<IGanttCategoryAxisDataItem>;\r\n\t\t\tif (dataItem && $type.isNumber(value)) {\r\n\t\t\t\tdataItem.set(\"duration\", value);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tconst duration = dataItem.get(\"duration\");\r\n\t\tif ($type.isNumber(duration)) {\r\n\t\t\tdurationStepper.set(\"value\", duration);\r\n\t\t}\r\n\t\tdataItem.on(\"duration\", (value) => {\r\n\t\t\tdurationStepper.set(\"value\", value);\r\n\t\t});\r\n\r\n\t\tconst progressPie = this.progressPies.make();\r\n\t\tcontrolsContainer.children.push(progressPie);\r\n\t\tdataItem.setRaw(\"progressPie\", progressPie);\r\n\r\n\t\tprogressPie.events.on(\"click\", (ev) => {\r\n\t\t\tthis.axis.toggleProgressPie(ev.target.dataItem);\r\n\t\t})\r\n\r\n\t\tthis.progressPies.push(progressPie);\r\n\r\n\t\tthis.axis.labelsContainer.children.moveValue(container, 0);\r\n\r\n\t\taxis._updateBullet(dataItem);\r\n\r\n\t\tcontainer.appear();\r\n\r\n\t\treturn label;\r\n\t}\r\n\r\n\t/**\r\n\t * @ignore\r\n\t */\r\n\tpublic updateLabel(label?: AxisLabel, position?: number, endPosition?: number) {\r\n\t\tif (label) {\r\n\t\t\tconst dataItem = label.dataItem as DataItem<IGanttCategoryAxisDataItem>;\r\n\t\t\tif (dataItem) {\r\n\t\t\t\tconst container = dataItem.get(\"container\");\r\n\t\t\t\tif (container) {\r\n\t\t\t\t\tif (!$type.isNumber(position)) {\r\n\t\t\t\t\t\tposition = 0;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tlet location = 0;\r\n\r\n\t\t\t\t\tif ($type.isNumber(endPosition) && endPosition != position) {\r\n\t\t\t\t\t\tposition = position + (endPosition - position) * location;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tcontainer.set(\"y\", this.positionToCoordinate(position));\r\n\t\t\t\t\tthis.toggleVisibility(container, position, label.get(\"minPosition\", 0), label.get(\"maxPosition\", 1));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @ignore\r\n\t */\r\n\tpublic updateTick(tick?: AxisTick, position?: number, endPosition?: number, count?: number) {\r\n\t\tsuper.updateTick(tick, position, endPosition, count);\r\n\t\tif (tick) {\r\n\t\t\ttick.set(\"length\", -this.axis.labelsContainer.width());\r\n\t\t}\r\n\t}\r\n}","import { AxisRendererX, IAxisRendererXSettings, IAxisRendererXPrivate } from \"../xy/axes/AxisRendererX\";\r\n\r\nexport interface IGanttDateAxisRendererSettings extends IAxisRendererXSettings {\r\n}\r\n\r\nexport interface IGanttDateAxisRendererPrivate extends IAxisRendererXPrivate {\r\n}\r\n\r\n/**\r\n * Renderer for [[GanttDateAxis]] axes.\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/gantt/#Category_vertical_axis} for more info\r\n * @since 5.14.0\r\n * @important\r\n */\r\nexport class GanttDateAxisRenderer extends AxisRendererX {\r\n\tpublic static className: string = \"GanttDateAxisRenderer\";\r\n\tpublic static classNames: Array<string> = AxisRendererX.classNames.concat([GanttDateAxisRenderer.className]);\r\n\r\n\tdeclare public _settings: IGanttDateAxisRendererSettings;\r\n\tdeclare public _privateSettings: IGanttDateAxisRendererPrivate;\r\n}\r\n","import type { ITimeInterval } from \"../../core/util/Time\";\r\nimport type { Grid } from \"../xy/axes/Grid\";\r\n\r\nimport { Button } from \"../../core/render/Button\";\r\nimport { ConfirmButton } from \"../../core/render/ConfirmButton\";\r\nimport { Graphics } from \"../../core/render/Graphics\";\r\nimport { Percent, percent } from \"../../core/util/Percent\";\r\nimport { GanttDateAxis, IGanttDateAxisDataItem } from \"./GanttDateAxis\";\r\nimport { XYChart } from \"../xy/XYChart\";\r\nimport { GanttDefaultTheme } from \"./GanttDefaultTheme\";\r\nimport { GanttSeries } from \"./GanttSeries\";\r\nimport { color, Color, ColorSet, Container, DataItem, IContainerEvents, IContainerPrivate, IContainerSettings, Rectangle, Scrollbar, Tooltip } from \"../../..\";\r\nimport { GanttCategoryAxis, IGanttCategoryAxisDataItem } from \"./GanttCategoryAxis\";\r\nimport { GanttCategoryAxisRenderer } from \"./GanttCategoryAxisRenderer\";\r\nimport { GanttDateAxisRenderer } from \"./GanttDateAxisRenderer\";\r\nimport { XYCursor } from \"../xy/XYCursor\";\r\nimport { ColorPicker } from \"../../plugins/colorPicker/ColorPicker\";\r\nimport { ColorPickerButton } from \"../../plugins/colorPicker/ColorPickerButton\";\r\nimport { registry } from \"../../core/Registry\";\r\n\r\nimport * as $utils from \"../../core/util/Utils\";\r\nimport * as $array from \"../../core/util/Array\";\r\nimport * as $time from \"../../core/util/Time\";\r\n\r\nexport interface IGanttSettings extends IContainerSettings {\r\n\r\n\t/**\r\n\t * If set to `true`, the user will be able to edit the chart via UI.\r\n\t *\r\n\t * @default true\r\n\t */\r\n\teditable?: boolean;\r\n\r\n\t/**\r\n\t * A unit to be used for when calculating \"duration\" of Gantt items.\r\n\t *\r\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/gantt/#Duration_units} for more information\r\n\t * @default \"day\"\r\n\t */\r\n\tdurationUnit?: \"year\" | \"month\" | \"week\" | \"day\" | \"hour\" | \"minute\" | \"second\";\r\n\r\n\t/**\r\n\t * An array of weekend days, e.g. `[0, 6]` for Sunday and Saturday.\r\n\t *\r\n\t * @default [0, 6]\r\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/gantt/#Weekends_and_holidays} for more information\r\n\t */\r\n\tweekends?: Array<number>;\r\n\r\n\t/**\r\n\t * An array of dates to treat as a holiday.\r\n\t *\r\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/gantt/#Weekends_and_holidays} for more information\r\n\t */\r\n\tholidays?: Array<Date>;\r\n\r\n\t/**\r\n\t * If set to `true`, weekends will be excluded from the chart.\r\n\t *\r\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/gantt/#Weekends_and_holidays} for more information\r\n\t */\r\n\texcludeWeekends?: boolean;\r\n\r\n\t/**\r\n\t * An absolute or relative width of the left-side category column.\r\n\t * \r\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/gantt/#Category_axis_width} for more information\r\n\t * @default 30%\r\n\t */\r\n\tsidebarWidth?: number | Percent;\r\n\r\n\t/**\r\n\t * A relative vertical cell position to treat as the threshold for snapping\r\n\t * bars.\r\n\t *\r\n\t * Available range of values: `0` (left) to `1` (right).\r\n\t *\r\n\t * This will be used when resizing or dragging a bar. If the position is\r\n\t * bigger than `snapThreshold` the bar will snap to the right, if it is\r\n\t * smaller than `snapThreshold`, it will snap to the left.\r\n\t * \r\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/gantt/#Snapping_behavior} for more information\r\n\t * @default 0.5\r\n\t */\r\n\tsnapThreshold?: number;\r\n\r\n\t/**\r\n\t * A [[ColorSet]] to use when asigning colors for series.\r\n\t *\r\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/xy-chart/series/#Series_colors} for more info\r\n\t */\r\n\tcolors?: ColorSet;\r\n\r\n\t/**\r\n\t * Grid intervals.\r\n\t *\r\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/gantt/#Timeline_horizontal_axis} for more info\r\n\t */\r\n\tgridIntervals?: { [index: string]: Array<ITimeInterval> };\r\n\r\n\t/**\r\n\t * If this is set to `true`, when a new task is added, it will be automatically linked to the previous task.\r\n\t * \r\n\t * @default true\r\n\t */\r\n\tlinkNewTasks?: boolean;\r\n}\r\n\r\nexport interface IGanttPrivate extends IContainerPrivate { }\r\n\r\nexport interface IGanttEvents extends IContainerEvents {\r\n\tdatemarked: { date: number | undefined, dataItem: DataItem<IGanttDateAxisDataItem> };\r\n\tdateunmarked: { date: number | undefined, dataItem?: DataItem<IGanttDateAxisDataItem> };\r\n\tvalueschanged: {};\r\n}\r\n\r\n/**\r\n * Creates a [[Gantt]] chart.\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/gantt/} for more info\r\n * @important\r\n * @since 5.14.0\r\n */\r\nexport class Gantt extends Container {\r\n\tdeclare public _settings: IGanttSettings;\r\n\tdeclare public _privateSettings: IGanttPrivate;\r\n\tdeclare public _events: IGanttEvents;\r\n\tpublic static className: string = \"Gantt\";\r\n\tpublic static classNames: Array<string> = Container.classNames.concat([Gantt.className]);\r\n\r\n\t/**\r\n\t * A scrollbar for horizontal scrolling.\r\n\t */\r\n\tpublic scrollbarX: Scrollbar = Scrollbar.new(this._root, {\r\n\t\torientation: \"horizontal\"\r\n\t});\r\n\r\n\t/**\r\n\t * A scrollbar for vertical scrolling.\r\n\t */\r\n\tpublic scrollbarY: Scrollbar = Scrollbar.new(this._root, {\r\n\t\torientation: \"vertical\"\r\n\t});\r\n\r\n\t/**\r\n\t * A reference to the [[XYChart]] that holds the Gantt chart.\r\n\t */\r\n\tpublic xyChart!: XYChart;\r\n\r\n\t/**\r\n\t * A reference to the [[GanttSeries]] that shows the Gantt tasks bars.\r\n\t */\r\n\tpublic series!: GanttSeries;\r\n\r\n\t/**\r\n\t * A reference to the [[GanttDateAxis]] used as the main X-axis.\r\n\t */\r\n\tpublic xAxis!: GanttDateAxis<GanttDateAxisRenderer>;\r\n\r\n\t/**\r\n\t * A reference to the [[GanttDateAxis]] used as the secondary X-axis.\r\n\t */\r\n\tpublic xAxisMinor!: GanttDateAxis<GanttDateAxisRenderer>;\r\n\r\n\t/**\r\n\t * A reference to the [[GanttCategoryAxis]] used as the Y-axis.\r\n\t */\r\n\tpublic yAxis!: GanttCategoryAxis<GanttCategoryAxisRenderer>;\r\n\r\n\t/**\r\n\t * Controls (add, color picker, expand, collaps, clear buttons) container.\r\n\t */\r\n\tpublic controls: Container = Container.new(this._root, {\r\n\t\tthemeTags: [\"controls\"],\r\n\t\tlayout: this._root.horizontalLayout,\r\n\t})\r\n\r\n\tpublic zoomControls: Container = Container.new(this._root, {\r\n\t\tthemeTagsSelf: [\"zoomcontrols\"]\r\n\t});\r\n\r\n\t/**\r\n\t * The [[Button]] element to add new tasks.\r\n\t */\r\n\tpublic readonly addButton: Button = this.controls.children.push(Button.new(this._root, {\r\n\t\tthemeTags: [\"add\", \"plus\"],\r\n\t\ttooltip: this.root.systemTooltip,\r\n\t\ticon: Graphics.new(this._root, { themeTags: [\"icon\"] })\r\n\t}));\r\n\r\n\t/**\r\n\t * The [[ColorPickerButton]] element to select colors for tasks.\r\n\t */\r\n\tpublic readonly colorPickerButton: ColorPickerButton = this.controls.children.push(ColorPickerButton.new(this._root, {\r\n\t\tdisableOpacity: true,\r\n\t\ttooltip: this.root.systemTooltip\r\n\t}));\r\n\r\n\t/**\r\n\t * The [[Button]] elements to expand and collapse all tasks.\r\n\t */\r\n\tpublic readonly expandButton: Button = this.controls.children.push(Button.new(this._root, {\r\n\t\tthemeTags: [\"expand\", \"secondary\", \"fixedwidth\"],\r\n\t\ticon: Graphics.new(this._root, { themeTags: [\"icon\"] }),\r\n\t\ttooltip: this.root.systemTooltip\r\n\t}));\r\n\r\n\t/**\r\n\t * The [[Button]] elements to collapse all tasks.\r\n\t */\r\n\tpublic readonly collapseButton: Button = this.controls.children.push(Button.new(this._root, {\r\n\t\tthemeTags: [\"collapse\", \"secondary\", \"fixedwidth\"],\r\n\t\ticon: Graphics.new(this._root, { themeTags: [\"icon\"] }),\r\n\t\ttooltip: this.root.systemTooltip\r\n\t}));\r\n\r\n\t/**\r\n\t * The [[Button]] element to toggle `linkNewTasks` setting.\r\n\t */\r\n\tpublic readonly linkButton: Button = this.controls.children.push(Button.new(this._root, {\r\n\t\tthemeTags: [\"link\", \"secondary\", \"fixedwidth\"],\r\n\t\ticon: Graphics.new(this._root, { themeTags: [\"icon\"] }),\r\n\t\ttooltip: this.root.systemTooltip\r\n\t}));\r\n\r\n\t/**\r\n\t * The [[Button]] element to horizontally fit visible tasks into a view.\r\n\t */\r\n\tpublic readonly fitButton: Button = this.zoomControls.children.push(Button.new(this._root, {\r\n\t\tthemeTags: [\"fit\", \"secondary\", \"zoombutton\"],\r\n\t\ticon: Graphics.new(this._root, { themeTags: [\"icon\"] }),\r\n\t\ttooltip: this.root.systemTooltip\r\n\t}));\r\n\r\n\t/**\r\n\t * The [[Button]] element to zoom out the X axis.\r\n\t */\r\n\tpublic readonly zoomOutButton: Button = this.zoomControls.children.push(Button.new(this._root, {\r\n\t\tthemeTags: [\"zoomout\", \"secondary\", \"zoombutton\"],\r\n\t\ticon: Graphics.new(this._root, { themeTags: [\"icon\"] }),\r\n\t\ttooltip: this.root.systemTooltip\r\n\t}));\r\n\r\n\t/**\r\n\t * The [[Button]] element to toggle edit mode.\r\n\t *\r\n\t * @since 5.14.1\r\n\t */\r\n\tpublic readonly editButton: Button = this.controls.children.push(Button.new(this._root, {\r\n\t\tthemeTags: [\"edit\", \"secondary\", \"fixedwidth\"],\r\n\t\ticon: Graphics.new(this._root, { themeTags: [\"icon\"] }),\r\n\t\ttooltip: this.root.systemTooltip\r\n\t}));\r\n\r\n\t/**\r\n\t * The [[Button]] element to clear all tasks.\r\n\t */\r\n\tpublic readonly clearButton: ConfirmButton = this.controls.children.push(ConfirmButton.new(this._root, {\r\n\t\tthemeTags: [\"clear\", \"secondary\", \"confirm\"],\r\n\t\ticon: Graphics.new(this._root, { themeTags: [\"icon\"] }),\r\n\t\ttooltip: this.root.systemTooltip,\r\n\t\tactive: false\r\n\t}));\r\n\r\n\t/**\r\n\t * The [[ColorPicker]] element to select colors for tasks.\r\n\t */\r\n\tpublic readonly colorPicker: ColorPicker = this.children.push(ColorPicker.new(this._root, { visible: false }));\r\n\r\n\tprotected _customColor: Color | undefined;\r\n\r\n\r\n\r\n\tprotected _afterNew() {\r\n\t\tthis.addTag(\"gantt\");\r\n\t\tthis._defaultThemes.push(GanttDefaultTheme.new(this._root));\r\n\r\n\t\tsuper._afterNew();\r\n\r\n\t\tconst root = this._root;\r\n\r\n\t\tthis.colorPickerButton.events.on(\"click\", () => {\r\n\t\t\tthis.yAxis.xButton.hide(0);\r\n\t\t\tthis.colorPicker.setAll({\r\n\t\t\t\tcolorButton: this.colorPickerButton\r\n\t\t\t})\r\n\t\t\tthis.children.moveValue(this.colorPicker, this.children.length - 1);\r\n\t\t\tthis.yAxis._disposeXHideDP();\r\n\t\t})\r\n\r\n\t\tthis.colorPicker.events.on(\"colorchanged\", () => {\r\n\t\t\tthis._customColor = this.colorPicker.get(\"color\");\r\n\t\t\tthis.yAxis.unselectDataItems();\r\n\t\t});\r\n\r\n\t\tthis.addButton.events.on(\"click\", () => {\r\n\t\t\tthis.addNewTask();\r\n\t\t})\r\n\r\n\t\tconst chart = this.children.push(XYChart.new(root, {}));\r\n\r\n\t\tchart.plotContainer.children.push(this.zoomControls);\r\n\t\tchart.zoomOutButton.set(\"forceHidden\", true);\r\n\r\n\t\tchart.children.push(this.controls);\r\n\r\n\t\tchart.set(\"cursor\", XYCursor.new(root, {\r\n\t\t\txAxis: this.xAxis,\r\n\t\t\tyAxis: this.yAxis\r\n\t\t}));\r\n\r\n\t\tconst yRenderer = GanttCategoryAxisRenderer.new(root, {});\r\n\r\n\t\t// to prevent moving horizontally while dragging\r\n\t\tyRenderer.containers.template.adapters.add(\"x\", () => {\r\n\t\t\treturn 0;\r\n\t\t})\r\n\r\n\t\t// can't set fields in theme, as data is set before theme is applied\r\n\t\tconst yAxis = chart.yAxes.push(\r\n\t\t\tGanttCategoryAxis.new(root, {\r\n\t\t\t\tcategoryField: \"id\",\r\n\t\t\t\tcellSizeField: \"cellSize\",\r\n\t\t\t\tcollapsedField: \"collapsed\",\r\n\t\t\t\tparentIdField: \"parentId\",\r\n\t\t\t\tcolorField: \"color\",\r\n\t\t\t\tidField: \"id\",\r\n\t\t\t\tnameField: \"name\",\r\n\t\t\t\trenderer: yRenderer\r\n\t\t\t})\r\n\t\t);\r\n\r\n\t\tyAxis.gantt = this;\r\n\r\n\t\t// update widht of scrollbar and controls container\r\n\t\tyAxis.events.on(\"boundschanged\", () => {\r\n\t\t\tthis._updateScrollbar();\r\n\t\t});\r\n\r\n\t\tchart.plotContainer.events.on(\"boundschanged\", () => {\r\n\t\t\tthis._updateScrollbar();\r\n\t\t});\r\n\r\n\t\tthis.on(\"visible\", () => {\r\n\t\t\tthis.root.events.once(\"frameended\", () => {\r\n\t\t\t\tthis._updateScrollbar();\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\t// minor x axis\r\n\t\tconst ganttAxisRenderrerMinor = GanttDateAxisRenderer.new(root, { themeTags: [\"minor\"] });\r\n\r\n\t\t// so that grid would be hidden if axis range is added\r\n\t\tganttAxisRenderrerMinor.grid.template.adapters.add(\"forceHidden\", (forceHidden, target) => {\r\n\t\t\tconst dataItem = target.dataItem as DataItem<IGanttDateAxisDataItem>;\r\n\t\t\tif (dataItem && dataItem.get(\"active\")) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\treturn forceHidden;\r\n\t\t})\r\n\r\n\t\tconst xAxisMinor = chart.xAxes.push(\r\n\t\t\tGanttDateAxis.new(root, {\r\n\t\t\t\tthemeTags: [\"minor\"],\r\n\t\t\t\tbaseInterval: { timeUnit: \"day\", count: 1 },\r\n\t\t\t\trenderer: ganttAxisRenderrerMinor,\r\n\t\t\t\tbackground: Rectangle.new(root, {\r\n\t\t\t\t\tfill: color(0xfff),\r\n\t\t\t\t\tfillOpacity: 0\r\n\t\t\t\t})\r\n\t\t\t})\r\n\t\t);\r\n\r\n\t\txAxisMinor.gantt = this;\r\n\r\n\t\t// return default color for grid lines\r\n\t\txAxisMinor.events.on(\"pointerout\", () => {\r\n\t\t\tganttAxisRenderrerMinor.grid.each((grid) => {\r\n\t\t\t\tgrid.unhover();\r\n\t\t\t})\r\n\t\t})\r\n\r\n\t\t// add axis range on click\r\n\t\txAxisMinor.events.on(\"click\", () => {\r\n\t\t\tif (closestGrid) {\r\n\t\t\t\tconst dataItem = closestGrid.dataItem as DataItem<IGanttDateAxisDataItem>;\r\n\t\t\t\tif (dataItem) {\r\n\t\t\t\t\tconst value = dataItem.get(\"endValue\");\r\n\t\t\t\t\tif (value !== undefined) {\r\n\t\t\t\t\t\tlet found = false;\r\n\t\t\t\t\t\txAxisMinor.axisRanges.each((axisRange) => {\r\n\t\t\t\t\t\t\t// remove axis range if already exists\r\n\t\t\t\t\t\t\tif (axisRange.get(\"value\") === value) {\r\n\t\t\t\t\t\t\t\tthis.unmarkDate(value);\r\n\t\t\t\t\t\t\t\tfound = true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t// add axis range if not exists\r\n\t\t\t\t\t\tif (!found) {\r\n\t\t\t\t\t\t\tdataItem.set(\"active\", true);\r\n\t\t\t\t\t\t\tthis.markDate(value);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\t// find closest grid line on hover\r\n\t\tlet closestGrid: Grid | undefined;\r\n\t\txAxisMinor.events.on(\"globalpointermove\", (ev) => {\r\n\t\t\tif (xAxisMinor.isHover()) {\r\n\t\t\t\t// find most close grid line\r\n\t\t\t\tconst point = xAxisMinor.toLocal({ x: ev.point.x, y: ev.point.y });\r\n\t\t\t\tlet minX = Infinity;\r\n\t\t\t\tganttAxisRenderrerMinor.grid.each((grid) => {\r\n\t\t\t\t\tif (grid.isVisible()) {\r\n\t\t\t\t\t\tconst dataItem = grid.dataItem as DataItem<IGanttDateAxisDataItem>;\r\n\t\t\t\t\t\tif (dataItem) {\r\n\t\t\t\t\t\t\tif (!dataItem.get(\"isRange\")) {\r\n\t\t\t\t\t\t\t\tlet distance = Math.abs(grid.x() - point.x);\r\n\r\n\t\t\t\t\t\t\t\tif (!grid.get(\"active\")) {\r\n\t\t\t\t\t\t\t\t\tgrid.unhover();\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\tif (distance < minX) {\r\n\t\t\t\t\t\t\t\t\tminX = distance;\r\n\t\t\t\t\t\t\t\t\tclosestGrid = grid;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\r\n\t\t\t\tif (closestGrid) {\r\n\t\t\t\t\tclosestGrid.hover();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tconst ganttAxisRenderrer = GanttDateAxisRenderer.new(root, {});\r\n\t\tconst xAxis = chart.xAxes.push(\r\n\t\t\tGanttDateAxis.new(root, {\r\n\t\t\t\tbaseInterval: { timeUnit: \"day\", count: 1 },\r\n\t\t\t\trenderer: ganttAxisRenderrer,\r\n\t\t\t\ttooltip: Tooltip.new(root, {})\r\n\t\t\t})\r\n\t\t);\r\n\r\n\t\txAxis.gantt = this;\r\n\r\n\t\t// sync minor x axis with main x axis\r\n\t\txAxis.onPrivate(\"min\", (value) => {\r\n\t\t\txAxisMinor.setPrivate(\"min\", value);\r\n\t\t});\r\n\r\n\t\txAxis.onPrivate(\"max\", (value) => {\r\n\t\t\txAxisMinor.setPrivate(\"max\", value);\r\n\t\t});\r\n\r\n\t\t// sync minor x axis with main x axis\r\n\t\txAxis.on(\"start\", (value) => {\r\n\t\t\txAxisMinor.set(\"start\", value);\r\n\t\t});\r\n\r\n\t\txAxis.on(\"end\", (value) => {\r\n\t\t\txAxisMinor.set(\"end\", value);\r\n\t\t});\r\n\r\n\t\t// set min max if not set\r\n\t\tconst baseDuration = xAxis.baseDuration();\r\n\t\tif (xAxis.getPrivate(\"min\") === undefined) {\r\n\t\t\txAxis.setPrivate(\"min\", new Date().getTime());\r\n\t\t}\r\n\t\tif (xAxis.getPrivate(\"max\") === undefined) {\r\n\t\t\txAxis.setPrivate(\"max\", new Date().getTime() + baseDuration * 3);\r\n\t\t}\r\n\r\n\t\t// set grid interval\r\n\t\txAxis.onPrivate(\"gridInterval\", (value) => {\r\n\t\t\tconst gridIntervals = this.get(\"gridIntervals\");\r\n\t\t\tif (gridIntervals && gridIntervals[value.timeUnit]) {\r\n\t\t\t\txAxisMinor.set(\"gridIntervals\", gridIntervals[value.timeUnit]);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t// Add series\r\n\t\t// https://www.amcharts.com/docs/v5/charts/xy-chart/series/\r\n\t\tvar series = chart.series.push(GanttSeries.new(root, {\r\n\t\t\txAxis: xAxis,\r\n\t\t\tyAxis: yAxis,\r\n\t\t\tbaseAxis: yAxis,\r\n\t\t\topenValueXField: \"start\",\r\n\t\t\tvalueXField: \"end\",\r\n\t\t\tprogressField: \"progress\",\r\n\t\t\tdurationField: \"duration\",\r\n\t\t\tlinkToField: \"linkTo\",\r\n\t\t\tcategoryYField: \"id\",\r\n\t\t\tidField: \"id\"\r\n\t\t}));\r\n\r\n\t\tseries.gantt = this;\r\n\r\n\t\t// Add scrollbars\r\n\t\tthis.scrollbarX = chart.set(\"scrollbarX\", this.scrollbarX);\r\n\t\tthis.scrollbarY = chart.set(\"scrollbarY\", this.scrollbarY);\r\n\t\tthis.scrollbarY.startGrip.set(\"forceHidden\", true);\r\n\t\tthis.scrollbarY.endGrip.set(\"forceHidden\", true);\r\n\r\n\t\tthis.children.push(this.scrollbarX);\r\n\r\n\t\tthis.xyChart = chart;\r\n\t\tthis.series = series;\r\n\t\tthis.xAxis = xAxis;\r\n\t\tthis.yAxis = yAxis;\r\n\t\tthis.xAxisMinor = xAxisMinor;\r\n\r\n\t\tconst eventType = \"valueschanged\";\r\n\t\tthis.series.events.on(eventType, () => {\r\n\t\t\tif (this.get(\"editable\")) {\r\n\t\t\t\tif (this.events.isEnabled(eventType)) {\r\n\t\t\t\t\tthis.events.dispatch(eventType, { type: eventType, target: this });\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\t// ad dbehavior to buttons\r\n\t\tthis.expandButton.events.on(\"click\", () => {\r\n\t\t\tthis.yAxis.expandAll();\r\n\t\t})\r\n\r\n\t\tthis.collapseButton.events.on(\"click\", () => {\r\n\t\t\tthis.yAxis.collapseAll();\r\n\t\t})\r\n\r\n\t\tthis.clearButton.events.on(\"confirmed\", () => {\r\n\t\t\tthis.clearAll();\r\n\t\t})\r\n\r\n\t\tthis.linkButton.on(\"active\", (active) => {\r\n\t\t\tthis.set(\"linkNewTasks\", active);\r\n\t\t})\r\n\r\n\t\tthis.colorPicker.on(\"color\", (c) => {\r\n\t\t\tthis.yAxis.setDataItemColor(this.yAxis.get(\"selectedDataItem\"), c);\r\n\t\t});\r\n\r\n\t\tthis.editButton.on(\"active\", (active) => {\r\n\t\t\tthis.set(\"editable\", active);\r\n\t\t});\r\n\r\n\t\tthis.fitButton.events.on(\"click\", () => {\r\n\r\n\t\t\tlet min = series.getPrivate(\"selectionMinX\", 0);\r\n\t\t\tlet max = series.getPrivate(\"selectionMaxX\", 0);\r\n\t\t\tconst extraMin = xAxis.get(\"extraMin\", 0.1);\r\n\t\t\tconst extraMax = xAxis.get(\"extraMax\", 0.1);\r\n\r\n\t\t\txAxis.zoomToValues(min - (max - min) * extraMin, max + (max - min) * extraMax);\r\n\r\n\t\t\t/*\r\n\t\t\txAxis.setAll({\r\n\t\t\t\t\"strictMinMax\": false,\r\n\t\t\t\t\"strictMinMaxSelection\": false,\r\n\t\t\t\t\"autoZoom\": true,\r\n\t\t\t})\r\n\r\n\t\r\n\t\t\telse {\r\n\t\t\t\txAxis.setAll({\r\n\t\t\t\t\t\"strictMinMax\": true,\r\n\t\t\t\t\t\"strictMinMaxSelection\": true,\r\n\t\t\t\t\t\"autoZoom\": false\r\n\t\t\t\t})\r\n\r\n\t\t\t\txAxis.setPrivate(\"selectionMin\", undefined);\r\n\t\t\t\txAxis.setPrivate(\"selectionMax\", undefined);\r\n\t\t\t}*/\r\n\t\t});\r\n\r\n\t\tthis.zoomOutButton.events.on(\"click\", () => {\r\n\t\t\txAxis.zoom(0, 1);\r\n\t\t});\r\n\r\n\t\tlet license = false;\r\n\t\tfor (let i = 0; i < registry.licenses.length; i++) {\r\n\t\t\tif (registry.licenses[i].match(/^AM5G.{5,}/i)) {\r\n\t\t\t\tlicense = true;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (!license) {\r\n\t\t\tthis._root._showBranding();\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis._root._licenseApplied();\r\n\t\t}\r\n\t}\r\n\t// end _afterNew()\r\n\r\n\tpublic _prepareChildren(): void {\r\n\t\tsuper._prepareChildren();\r\n\t\tif (this.isDirty(\"editable\")) {\r\n\t\t\tthis._toggleEditable(this.get(\"editable\", true));\r\n\t\t}\r\n\t}\r\n\r\n\tpublic clearAll() {\r\n\t\tthis.yAxis.deleteAll();\r\n\t\tthis._customColor = undefined;\r\n\t\tthis.get(\"colors\")?.reset();\r\n\t\tthis.colorPickerButton.set(\"color\", undefined);\r\n\t\tthis._nextColor();\r\n\r\n\t\tconst today = new Date();\r\n\t\ttoday.setHours(0, 0, 0, 0);\r\n\r\n\t\tthis.xAxis.setPrivate(\"min\", today.getTime());\r\n\t\tthis.xAxis.setPrivate(\"max\", today.getTime() + this.xAxis.baseDuration() * 5);\r\n\r\n\t\tfor (let i = this.xAxisMinor.axisRanges.length - 1; i >= 0; i--) {\r\n\t\t\tconst axisRange = this.xAxisMinor.axisRanges.getIndex(i);\r\n\t\t\tif (axisRange) {\r\n\t\t\t\tthis.unmarkDate(axisRange.get(\"value\") as number);\r\n\t\t\t}\r\n\t\t};\r\n\t}\r\n\r\n\tpublic _updateChildren() {\r\n\t\tsuper._updateChildren();\r\n\r\n\t\tif (this.isDirty(\"linkNewTasks\")) {\r\n\t\t\tthis.linkButton.set(\"active\", this.get(\"linkNewTasks\", false));\r\n\t\t}\r\n\r\n\t\tif (this.isDirty(\"editable\")) {\r\n\t\t\tthis.editButton.set(\"active\", this.get(\"editable\", true));\r\n\t\t}\r\n\r\n\t\tif (this._sizeDirty || this.isDirty(\"sidebarWidth\")) {\r\n\t\t\tlet width = $utils.relativeToValue(this.get(\"sidebarWidth\", percent(20)), this.innerWidth());\r\n\t\t\twidth = Math.max(width, this.yAxis.get(\"minWidth\", 100));\r\n\t\t\tthis.yAxis.labelsContainer.set(\"width\", width);\r\n\t\t\tthis._updateScrollbar();\r\n\t\t}\r\n\r\n\t\tif (this.isDirty(\"durationUnit\")) {\r\n\t\t\tconst durationUnit = this.get(\"durationUnit\");\r\n\t\t\tif (durationUnit) {\r\n\t\t\t\tthis.xAxis.set(\"baseInterval\", { timeUnit: durationUnit, count: 1 });\r\n\t\t\t\tthis.xAxisMinor.set(\"baseInterval\", { timeUnit: durationUnit, count: 1 });\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (this.colorPickerButton.getPrivate(\"color\") === undefined) {\r\n\t\t\tthis._nextColor();\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _updateScrollbar() {\r\n\t\tconst point = this.xyChart.plotContainer.toGlobal({ x: 0, y: 0 });\r\n\t\tthis.scrollbarX.setAll({\r\n\t\t\tx: point.x,\r\n\t\t\twidth: this.xyChart.plotContainer.width()\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Adds a new task to the Gantt chart.\r\n\t * \r\n\t * @param category        The category name for the task. If not provided, will be auto-generated.\r\n\t * @param start           The start time of the task in milliseconds. If not provided, will be determined based on context.\r\n\t * @param duration        The duration of the task. If not provided, defaults to 1.\r\n\t * @param parentId        The parent category if this is a subtask.\r\n\t * @param progress        The initial progress of the task (0-1). Defaults to 0.\r\n\t * @param linkToPrevious  Should the task automatically link to the previous one?\r\n\t */\r\n\tpublic addNewTask(name?: string, start?: number, duration: number = 1, parentId?: string, progress: number = 0, linkToPrevious?: boolean) {\r\n\t\t// Generate a unique ID for the new task\r\n\t\tlet len = this.series.dataItems.length;\r\n\t\tlet c = this.yAxis.dataItems.length;\r\n\r\n\t\t$array.each(this.yAxis.dataItems, (dataItem) => {\r\n\t\t\tif (dataItem.get(\"id\") == \"gantt_\" + c) {\r\n\t\t\t\tc++;\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\tconst uid = \"gantt_\" + c;\r\n\r\n\t\tif (!name) {\r\n\t\t\tname = \"New Task\";\r\n\t\t}\r\n\r\n\t\tif (linkToPrevious === undefined) {\r\n\t\t\tlinkToPrevious = this.get(\"linkNewTasks\", false);\r\n\t\t}\r\n\r\n\t\tlet parentDataItem: DataItem<IGanttCategoryAxisDataItem> | undefined;\r\n\t\t// Find parent data item either by specified category or selected item\r\n\t\tif (parentId != undefined) {\r\n\t\t\tparentDataItem = this.yAxis.getDataItemById(parentId);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tparentDataItem = this.yAxis.get(\"selectedDataItem\");\r\n\t\t}\r\n\r\n\t\tlet childCount = 0;\r\n\t\t// Handle parent-child relationship if a parent exists\r\n\t\tif (parentDataItem) {\r\n\t\t\tparentId = parentDataItem.get(\"id\");\r\n\t\t\tif (parentId) {\r\n\t\t\t\t// If start time not specified, try to use parent's start time\r\n\t\t\t\tif (start === undefined) {\r\n\t\t\t\t\tconst seriesDataItem = this.series.getDataItemById(parentId);\r\n\t\t\t\t\tif (seriesDataItem) {\r\n\t\t\t\t\t\tstart = seriesDataItem.get(\"valueX\", new Date().getTime());\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t// Initialize or get the children array for the parent\r\n\t\t\tlet children = parentDataItem.get(\"children\");\r\n\t\t\tif (!children) {\r\n\t\t\t\tchildren = parentDataItem.set(\"children\", []);\r\n\t\t\t}\r\n\t\t\tchildCount = children.length;\r\n\t\t}\r\n\r\n\t\t// Determine start time if not specified\r\n\t\tif (start === undefined) {\r\n\t\t\tstart = $time.roun(this.xAxis.getPrivate(\"min\", 0), this.get(\"durationUnit\", \"day\"), 1, this.root);\r\n\r\n\t\t\tif (this.series.dataItems.length > 0) {\r\n\t\t\t\tstart = this.series.dataItems[len - 1].get(\"valueX\", new Date().getTime());\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tconst dataObject: any = {\r\n\t\t\tname: name,\r\n\t\t\tid: uid\r\n\t\t}\r\n\t\tif (parentId) {\r\n\t\t\tdataObject[\"parentId\"] = parentId;\r\n\t\t}\r\n\t\t// Add the category data\r\n\t\tlet index = 0;\r\n\t\tlet previousDataItem: DataItem<IGanttCategoryAxisDataItem> | undefined;\r\n\t\tif (parentDataItem) {\r\n\t\t\tindex = this.yAxis.dataItems.indexOf(parentDataItem) + 1 + childCount;\r\n\t\t\tconst children = parentDataItem.get(\"children\", []);\r\n\t\t\tlet len = this.yAxis.dataItems.length;\r\n\t\t\tif (index >= len) {\r\n\t\t\t\tif (children.length > 0) {\r\n\t\t\t\t\tpreviousDataItem = children[children.length - 1];\r\n\t\t\t\t}\r\n\t\t\t\tthis.yAxis.data.push(dataObject);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tif (children.length > 0) {\r\n\t\t\t\t\tpreviousDataItem = this.yAxis.dataItems[index - 1];\r\n\t\t\t\t}\r\n\t\t\t\tthis.yAxis.data.insertIndex(index, dataObject);\r\n\t\t\t}\r\n\t\t\tindex++;\r\n\t\t}\r\n\t\telse {\r\n\t\t\t// go backwards and find the first item that has no parent\r\n\t\t\tfor (let i = this.yAxis.dataItems.length - 1; i >= 0; i--) {\r\n\t\t\t\tconst dataItem = this.yAxis.dataItems[i];\r\n\t\t\t\tif (!dataItem.get(\"parentId\")) {\r\n\t\t\t\t\tpreviousDataItem = dataItem;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.yAxis.data.push(dataObject);\r\n\t\t\tindex = this.yAxis.dataItems.length;\r\n\t\t}\r\n\r\n\t\t// Add the task data with slightly offset start time to avoid overlapping\r\n\t\tconst baseDuration = this.xAxis.baseDuration();\r\n\r\n\t\tconst seriesDataObject: any = {\r\n\t\t\tstart: start,\r\n\t\t\tend: start + 1,\r\n\t\t\tduration: duration,\r\n\t\t\tprogress: progress,\r\n\t\t\tid: uid,\r\n\t\t\tname: name\r\n\t\t}\r\n\r\n\t\t// create link to previous task if needed\r\n\t\tif (linkToPrevious && previousDataItem) {\r\n\t\t\tconst seriesDataItem = this.series.getDataItemById(previousDataItem.get(\"id\")!);\r\n\r\n\t\t\tif (seriesDataItem) {\r\n\t\t\t\tconst linkTo: Array<string> = seriesDataItem.get(\"linkTo\", []);\r\n\r\n\t\t\t\tif (!linkTo.includes(uid)) {\r\n\t\t\t\t\tlinkTo.push(uid);\r\n\t\t\t\t\tseriesDataItem.set(\"linkTo\", linkTo);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.series.data.moveValue(seriesDataObject, index - 1);\r\n\r\n\t\tconst newSeriesDataItem = this.series.dataItems[index - 1];\r\n\t\tnewSeriesDataItem.animate({ key: \"valueX\", to: start + baseDuration * duration, duration: this.series.get(\"interpolationDuration\", 0), easing: this.series.get(\"interpolationEasing\") });\r\n\r\n\t\tthis.yAxis._disposeXHideDP();\r\n\t\tthis.yAxis.xButton.hide(0);\r\n\r\n\t\tconst maxZoomCount = this.yAxis.get(\"maxZoomCount\", 20);\r\n\t\tlet startIndex = Math.max(0, Math.round(index - maxZoomCount / 2));\r\n\t\tlet endIndex = startIndex + maxZoomCount;\r\n\r\n\t\tlen = this.yAxis.dataItems.length;\r\n\t\tif (endIndex > len) {\r\n\t\t\tendIndex = len;\r\n\t\t\tstartIndex = Math.max(0, endIndex - maxZoomCount);\r\n\t\t}\r\n\r\n\t\tthis.yAxis.zoomToIndexes(startIndex, endIndex);\r\n\t\tthis.yAxis.adjustZoom();\r\n\t}\r\n\r\n\r\n\t// Get next color from the color set\r\n\tpublic _nextColor(): Color | undefined {\r\n\t\tif (this._customColor) {\r\n\t\t\treturn this._customColor;\r\n\t\t}\r\n\t\tconst fill = this.get(\"colors\")?.next();\r\n\t\tthis.colorPickerButton.setPrivate(\"color\", fill);\r\n\r\n\t\treturn fill;\r\n\t}\r\n\r\n\t/**\r\n\t * Marks a date on the minor date axis.\r\n\t * \r\n\t * @param date  Date to be marked\r\n\t */\r\n\tpublic markDate(date: number) {\r\n\r\n\t\tconst xAxisMinor = this.xAxisMinor;\r\n\t\tconst dataItem = xAxisMinor.createAxisRange(xAxisMinor.makeDataItem({\r\n\t\t\tvalue: date\r\n\t\t}))\r\n\r\n\t\tconst eventType = \"datemarked\";\r\n\t\tif (this.events.isEnabled(eventType)) {\r\n\t\t\tthis.events.dispatch(eventType, { type: eventType, target: this, dataItem: dataItem, date: date });\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Unmarks a date on the minor date axis.\r\n\t * \r\n\t * @param date  Date to be unmarked\r\n\t */\r\n\tpublic unmarkDate(date: number) {\r\n\t\tconst xAxisMinor = this.xAxisMinor;\r\n\t\tlet dataItem = undefined;\r\n\t\txAxisMinor.axisRanges.each((axisRange) => {\r\n\t\t\t// remove axis range if already exists\r\n\t\t\tif (axisRange && axisRange.get(\"value\") === date) {\r\n\t\t\t\txAxisMinor.axisRanges.removeValue(axisRange);\r\n\t\t\t\tdataItem = axisRange;\r\n\t\t\t}\r\n\t\t})\r\n\t\tconst eventType = \"dateunmarked\";\r\n\t\tif (this.events.isEnabled(eventType)) {\r\n\t\t\tthis.events.dispatch(eventType, { type: eventType, target: this, dataItem: dataItem, date: date });\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _toggleEditable(value: boolean) {\r\n\t\tconst forceHidden = \"forceHidden\";\r\n\t\tconst forceInactive = \"forceInactive\";\r\n\t\tconst draggable = \"draggable\";\r\n\r\n\t\tthis.series.markDirtyValues();\r\n\r\n\t\tthis.addButton.set(forceHidden, !value);\r\n\t\tthis.colorPickerButton.set(forceHidden, !value);\r\n\t\tthis.clearButton.set(forceHidden, !value);\r\n\t\tthis.linkButton.set(forceHidden, !value);\r\n\r\n\t\tconst renderer = this.yAxis.get(\"renderer\");\r\n\t\trenderer.labels.template.set(forceInactive, !value);\r\n\r\n\t\trenderer.grips.template.set(forceHidden, !value);\r\n\t\trenderer.containers.template.set(draggable, value);\r\n\r\n\t\trenderer.controlsContainers.template.set(forceInactive, !value);\r\n\r\n\t\tthis.series.columns.template.set(draggable, value);\r\n\t\tthis.series.startGrips.template.set(forceHidden, !value);\r\n\t\tthis.series.endGrips.template.set(forceHidden, !value);\r\n\t\tthis.series.progressGrips.template.set(forceHidden, !value);\r\n\r\n\t\tthis.series.startBullets.template.set(forceHidden, !value);\r\n\t\tthis.series.endBullets.template.set(forceHidden, !value);\r\n\r\n\t\tthis.series.links.template.set(forceInactive, !value);\r\n\r\n\t\tthis.xAxisMinor.set(forceInactive, !value);\r\n\t}\r\n}","import * as m from \"./../../dist/es2015/gantt.js\";\nexport const am5gantt = m;"],"names":["GanttDateAxis","DateAxis","classNames","concat","className","GanttDefaultTheme","Theme","setupDefaultRules","super","l","this","_root","language","ic","interfaceColors","r","rule","bind","defaultDateFormat","translate","setAll","editable","layout","verticalLayout","colors","ColorSet","new","snapThreshold","linkNewTasks","durationUnit","sidebarWidth","weekends","width","height","gridIntervals","year","timeUnit","count","month","week","day","hour","x","centerX","y","panX","panY","paddingRight","wheelY","fillOpacity","fill","get","cursorOverStyle","interactive","states","create","paddingBottom","paddingTop","paddingLeft","maxDeviation","zoomOut","childShift","childCellSize","minCellHeight","inversed","minGridDistance","maxZoomFactor","extraMax","extraMin","autoZoom","markUnitChange","weekLabelLocation","dateFormats","millisecond","second","minute","fillRule","dataItem","axisFill","axis","component","value","endValue","baseInterval","getPrivate","gridInterval","gantt","set","weekDay","Date","getDay","duration","dayDuration","indexOf","opposite","forceHidden","stroke","strokeOpacity","strokeWidth","strokeDasharray","multiLocation","populateText","text","centerY","oversizedBehavior","marginRight","visible","location","length","minWidth","draggable","multiLine","horizontalLayout","fillPattern","LinePattern","color","colorOpacity","rotation","gap","marginLeft","linkHorizontalOffset","snapCount","exactLocationX","maxHeight","cornerRadiusBL","cornerRadiusTL","cornerRadiusBR","cornerRadiusTR","tooltipY","tooltipText","opacity","forceInactive","position","radius","role","scale","angle","toggleKey","tooltipX","undefined","marginBottom","stateAnimationDuration","draw","display","moveTo","arc","lineTo","closePath","translateAny","svgPath","dy","isMeasured","Math","PI","GanttSeries","ColumnSeries","children","push","Container","Line","themeTags","Triangle","addDisposer","List","Template","Link","_new","containers","template","links","themeTagsSelf","maskedContainers","Circle","C","startBullets","endBullets","Rectangle","startGrips","endGrips","RoundedRectangle","zeroRectangles","progressRectangles","progressGrips","_afterNew","fields","valueFields","_disposers","events","on","event","connectorLine","isVisible","point","toLocal","_updateConnector","_event","_endConnector","columns","e","_columnDragStartX","target","_columnDragStartY","_handleColumnDragged","xAxis","openValueX","newOpenValueX","positionToValue","coordinateToPosition","valueX","diff","_fixValues","_moveChildValues","roundValue","invertThreshold","threshold","getUnitDuration","makeColumn","listTemplate","column","yAxis","selectDataItem","container","mainContainer","make","_setDataItem","zeroRectangle","unshift","hide","zy","dragStart","dragStop","_handleColumnHover","adapters","add","progressRectangle","maskedContainer","setRaw","mask","progressGrip","startGrip","endGrip","startX","show","applyAnimate","minStart","_findMinStart","max","min","markDirtyValues","endX","startBullet","endBullet","bulletPointerDown","bullet","_startConnector","_hoveredDataItem","syncProp","prop","val","isCollapsed","appear","dragOffset","_dragChildValues","_updateLinks","sourceDataItem","_startBullet","getDepth","categoryAxisDataItem","parent","_updateChildren","_valuesDirty","setPrivateRaw","yRenderer","dataItems","dataContext","category","categoryDataContext","categoryField","_adjustParentValues","setPrivate","index","durationStepper","y0","indexToPosition","y1","positionToCoordinate","columnHeight","Percent","Infinity","minHeight","isHidden","isHiding","isDragging","_adjustLinkValues","eventType","isEnabled","dispatch","type","_columnsUpdated","_getParentOpen","linkTo","id","linkDataItem","getDataItemById","linkOpenValueX","_adjustChildValues","child","childOpenValueX","dx","maxValue","item","itemValueX","progress","childProgress","getOpenValue","getEndValue","parentOpenValueX","parentValueX","getDataItemDuration","connectorArrow","_xPan","chart","_yPan","depth","itemsToDisable","checkIfConnected","startPoint","toGlobal","segments","startDataItem","each","keep","animationDuration","animationEasing","startIndex","endIndex","animate","key","to","easing","_toggleColumn","_afterDataChange","find","markDirtyTree","endRadius","getIndex","cos","categoryDataItem","dataItemId","link","linksContainer","removeValue","dispose","isHover","points","positionX","valueToPosition","positionY","categoryToPosition","getPoint","firstPoint","h","targetDataItem","lastPoint","targetCategoryDataItem","categoryToIndex","position0","position1","sign","_updateSeriesGraphics","graphics","t","b","_fitW","fitH","name","progressWidth","markDirtyKey","hideDataItem","promises","_key","includes","Promise","all","showDataItem","disposeDataItem","disposeLinks","round","getHolidayCount","openValue","adjustedDuration","unitDuration","i","isHoliday","start","end","holiday","holidays","date","getTime","GanttCategoryAxis","CategoryAxis","Button","icon","Graphics","handleWheel","xButton","renderer","_firstDataItem","makeDataItem","cellSize","makeTick","makeGrid","labelsContainer","maskContent","resizer","_downX","_downW","newWidth","containersTemplate","deltaPosition","startY","plotContainer","updateDeltaPositionRecursively","tick","grid","ceil","allContainers","_makeChildOf","unhover","otherContainer","otherDataItem","otherChildren","background","otherY","abs","hover","_previousTick","closestDataItem","closestDistance","ticks","isChild","distance","_insertAfter","_draggedItem","_sortCategoryAxis","toggleCollapse","_updateCellSizes","_changed","isDirty","_processBullet","_dataChanged","_nextColor","parentId","pow","_getItemDepth","_treeDirty","_updateTree","firstDataItem","updateTick","updateGrid","progressPie","toString","slice","backgroundSlice","label","p0","p1","_clearDirty","getSeriesDataItem","di","series","zoom","_updateFinals","sAnimation","_sAnimation","eAnimation","_eAnimation","playing","root","once","stop","availableHeight","maxZoomCount","floor","zoomToIndexes","_dataChangeDp","adjustZoom","markDirty","insertAfter","draggedItem","currentParent","currentDepth","parentColor","parentSeriesDataItem","childrenOfInsertAfter","parentOfInsertAfter","childrenOfParentOfInsertAfter","nextParent","_setNewColor","newParent","newParentChildren","currentChildren","insertAfterIndex","currentIndex","updateChildrenIndexes","seriesDataItem","axisItem","currentPosition","data","values","_updateBullet","taskBullet","collapsed","hasChildren","collapse","_updDP","expandAll","collapseAll","deleteAll","clear","deleteDataItem","then","toggleProgressPie","toValue","prevProgress","toProgress","setDataItemColor","c","cc","hex","promise","_toggleFHDataItem","_toggleDataItem","progressPies","grip","grips","durationSteppers","taskBullets","unselectDataItems","bg","_xHideDP","colorPickerButton","setTimeout","_delDp","_disposeXHideDP","_createGhostLabel","GanttCategoryAxisRenderer","AxisRendererY","EditableAxisLabel","labels","controlsContainers","ProgressPie","NumericStepper","makeLabel","ev","labelContainer","tempText","active","controlsContainer","moveValue","updateLabel","endPosition","toggleVisibility","GanttDateAxisRenderer","AxisRendererX","Gantt","Scrollbar","orientation","controls","tooltip","systemTooltip","ColorPickerButton","disableOpacity","zoomControls","ConfirmButton","ColorPicker","addTag","_defaultThemes","colorPicker","colorButton","_customColor","addButton","addNewTask","XYChart","zoomOutButton","XYCursor","yAxes","cellSizeField","collapsedField","parentIdField","colorField","idField","nameField","_updateScrollbar","ganttAxisRenderrerMinor","xAxisMinor","xAxes","closestGrid","found","axisRanges","axisRange","unmarkDate","markDate","minX","ganttAxisRenderrer","Tooltip","onPrivate","baseDuration","baseAxis","openValueXField","valueXField","progressField","durationField","linkToField","categoryYField","scrollbarX","scrollbarY","xyChart","expandButton","collapseButton","clearButton","clearAll","linkButton","editButton","fitButton","zoomToValues","license","licenses","match","_licenseApplied","_showBranding","_prepareChildren","_toggleEditable","reset","today","setHours","_sizeDirty","innerWidth","linkToPrevious","len","uid","parentDataItem","childCount","dataObject","previousDataItem","insertIndex","seriesDataObject","next","createAxisRange","am5gantt"],"sourceRoot":""}